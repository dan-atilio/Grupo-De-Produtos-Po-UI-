import { Input, Directive, Output, EventEmitter } from '@angular/core';
import { PoStepperOrientation } from '@po-ui/ng-components';
import { PoPageJobSchedulerInternal } from './po-page-job-scheduler-internal';
import { Subscription } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "./po-page-job-scheduler.service";
/**
 * @description
 *
 * O `po-page-job-scheduler` é uma página para criação e atualização de agendamentos da execução de processos (Job Scheduler),
 * como por exemplo: a geração da folha de pagamento dos funcionários.
 *
 * Para utilizar esta página, basta informar o serviço (endpoint) para consumo,
 * sem a necessidade de criar componentes e tratamentos dos dados.
 *
 * Veja mais sobre os padrões utilizados nas requisições no [Guia de implementação de APIs](guides/api).
 */
export class PoPageJobSchedulerBaseComponent {
    poPageJobSchedulerService;
    /** Objeto com as propriedades do breadcrumb. */
    breadcrumb = { items: [] };
    /**
     * Endpoint usado pelo componente para busca dos processos e parâmetros que serão utilizados para criação e edição dos agendamentos.
     *
     * #### Processos
     *
     * Os processos são as tarefas que estarão disponíveis para o usuário poder fazer os agendamentos.
     * Ao inicializar o componente, será feito uma requisição `GET` para o endpoint `{service-api}/processes`, para buscar
     * essa lista de processos.
     *
     * Este endpoint `{service-api}/processes` deve retornar uma lista de objetos que seguem a definição de dados abaixo:
     *
     * ```
     * GET {service-api}/processes
     * ```
     *
     * ```
     * {
     *   items: [
     *     { "processID": "ac4f", "description": "Gerar folha de pagamento" },
     *     { "processID": "df6l", "description": "Relatório de imposto a recolher" },
     *     { "processID": "dk3p", "description": "Títulos em aberto" },
     *   ]
     * }
     * ```
     *
     * Desta forma será renderizado um componente para selecionar o processo e/ou filtrá-los.
     *
     * Para realizar o filtro de busca do processo, será feita uma requisição enviando o conteúdo digitado na busca através do
     * parâmetro `search`. Da seguinte forma:
     *
     * ```
     * GET {service-api}/processes?search=relatorio
     * ```
     *
     * > Veja mais sobre paginação e filtros no [Guia de implementação de APIs](guides/api).
     * Caso seja informada a propriedade `p-parameters` não serão realizadas as requisições de processos e nem de parametros automaticamente.
     *
     * Também é possível fazer um agendamento de um processo específico, sem que seja necessário um endpoint para busca desses
     * processos. Então, caso o endpoint `{service-api}/processes` não seja válido, será apresentado um campo de entrada de
     * texto para o usuário informar diretamente
     * o **identificador do processo - `processID`** e ao salvar será enviado um `POST` para o endpoint difinido `serviceApi` conforme abaixo:
     *
     * ```
     * POST {service-api}
     * ```
     *
     * *Request payload* - estrutura de dados enviada no corpo da requisição conforme interface `PoJobScheduler`:
     *
     * ```
     * {
     *   "daily": { "hour": 10, "minute": 12 },
     *   "firstExecution": "2018-12-07T00:00:01-00:00",
     *   "recurrent": true,
     *   "processID": "ac0405"
     *   ...
     * }
     * ```
     *
     * Caso seja necessário informar parâmetros e adicionar configurações no processo selecionado, será realizado um `GET`
     * como exemplificado abaixo. Os parâmetros devem retornar uma lista de objetos que seguem a interface
     * [PoDynamicFormField](/documentation/po-dynamic-form). Porém, caso utilizar a propriedade `p-parameters` o componente não
     * realizará a busca automática e o campo de processos não será exibido.
     *
     * ```
     * GET {service-api}/processes/:id/parameters
     * ...
     * {
     *   items: [
     *     { "property": "vencimento", type: "date" },
     *     { "property": "imposto-retido", "label": "Imposto Retido", type: "boolean" }
     *   ]
     * }
     * ```
     *
     * #### Salvar e Atualizar
     *
     * Para salvar o agendamento, será feita uma requisição de criação, passando os valores preenchidos pelo usuário via *payload*.
     * Abaixo uma requisição `POST` disparada, onde as propriedades do *Job Scheduler* foram preenchidas:
     *
     * ```
     *  POST {service-api}
     * ```
     *
     * *Request payload* - estrutura de dados enviada no corpo da requisição conforme interface `PoJobScheduler`:
     *
     * ```
     * {
     *   "firstExecution": "2018-12-07T00:00:01-00:00",
     *   "recurrent": true,
     *   "monthly": { "day": 1, "hour": 10, "minute": 0 },
     *   "processID": "ac0405",
     *   "rangeExecutions: { "frequency": { "type": "hour", "value": 2 }, "rangeLimit": { "hour": 18, "minute": 0, "day": 20 } }
     * }
     * ```
     *
     * Caso queira que o componente carregue um agendamento já existente, deve ser incluído um parâmetro na rota chamado `id`.
     *
     * Exemplo de configuração de rota:
     *
     * ```
     *  RouterModule.forRoot([
     *    ...
     *    { path: 'edit/:id', component: ExampleJobSchedulerComponent },
     *    ...
     *  ],
     * ```
     *
     * Baseado nisso, na inicialização do template será disparado uma requisição para buscar o recurso que será editado.
     *
     * ```
     * GET {service-api}/{id}
     * ```
     *
     * Ao atualizar o agendamento, será disparado um `PUT` com os dados preenchidos.
     * Veja abaixo uma requisição `PUT` disparada, onde a propriedade *recurrent* e *daily* foram atualizadas:
     *
     * ```
     *  PUT {service-api}/{id}
     * ```
     *
     * *Request payload* - estrutura de dados enviada no corpo da requisição conforme interface `PoJobScheduler`:
     *
     * ```
     * {
     *   "firstExecution": "2018-12-07T00:00:01-00:00",
     *   "recurrent": true,
     *   "processID": "ac0405",
     *   "monthly": { "day": 1, "hour": 10, "minute": 0 },
     *   "processID": "ac0405",
     *   "rangeExecutions: { "frequency": { "type": "hour", "value": 2 }, "rangeLimit": { "hour": 18, "minute": 0, "day": 20 } }
     * }
     * ```
     */
    serviceApi;
    /** Título da página. */
    title;
    /**
     * Parâmetros que serão utilizados para criação e edição dos agendamentos.
     *
     * Ao utilizar esta propriedade, o componente não buscará automaticamente os parâmetros da API e o campo para preenchimento do processo não será exibido.
     *
     */
    parameters = [];
    set value(value) {
        this.model = this.poPageJobSchedulerService.convertToJobSchedulerInternal(value);
    }
    /**
     * @optional
     *
     * @description
     *
     * Define a orientação de exibição do `po-stepper`.
     *
     * > Quando não utilizada, segue o comportamento com base nas dimensões da tela.
     *
     * > Veja os valores válidos no *enum* [PoStepperOrientation](documentation/po-stepper#stepperOrientation).
     *
     */
    set stepperDefaultOrientation(value) {
        this._orientation = Object.values(PoStepperOrientation).includes(value) ? value : undefined;
    }
    get stepperDefaultOrientation() {
        return this._orientation;
    }
    /**
     * @optional
     *
     * @description
     *
     * Função chamada após realizar a confirmação da execução no PoPageJobScheduler.
     * Permite alterar os valores do model do PoPageJobScheduler antes de realizar o envio para a Api.
     *
     * > Deve retornar um objeto do tipo `PoPageJobScheduler` para ser adicionado ao model do PoPageJobScheduler.
     *
     * > Ao ser disparada, a mesma receberá por parâmetro o model do PoPageJobScheduler de interface `PoJobSchedulerInternal`.
     *
     * O contexto da função que será chamada, será o mesmo que o do `PoPageJobScheduler`, então para poder alterar
     * para o contexto do componente que o está utilizando, pode ser utilizado a propriedade `bind` do Javascript.
     * Por exemplo, para a função `beforeSend`:
     *
     * ```
     * <po-page-job-scheduler [p-service-api]="serviceApi" [p-parameters]="params" [p-before-send]="beforeSend.bind(this)">
     * ...
     * </po-page-job-scheduler>
     * ```
     */
    beforeSendAction;
    /**
     * @optional
     *
     * @description
     *
     * Define se o step `Agendamento` deve ser exibido como o último na sequência de steps
     *
     * > Aplicável apenas quando utilizado `PoJobSchedulerParametersTemplateDirective`
     */
    stepExecutionLast;
    /**
     * @optional
     *
     * @description
     *
     * Evento disparado ao concluir o processo de agendamento com sucesso.
     */
    success = new EventEmitter();
    /**
     * @optional
     *
     * @description
     *
     * Evento disparado ao ocorrer um erro impossibilitando a conclusão do agendamento.
     * Para este evento será passado como parâmetro os detalhes do erro.
     */
    error = new EventEmitter();
    model = new PoPageJobSchedulerInternal();
    _subscription = new Subscription();
    _orientation;
    constructor(poPageJobSchedulerService) {
        this.poPageJobSchedulerService = poPageJobSchedulerService;
    }
    ngOnDestroy() {
        this._subscription.unsubscribe();
    }
    loadData(id) {
        if (!id) {
            this.model = this.model || new PoPageJobSchedulerInternal();
            return;
        }
        this._subscription.add(this.poPageJobSchedulerService.getResource(id).subscribe((response) => {
            this.model = response;
        }, () => {
            this.model = new PoPageJobSchedulerInternal();
        }));
    }
    markAsDirtyInvalidControls(controls) {
        for (const key in controls) {
            if (controls.hasOwnProperty(key)) {
                const control = controls[key];
                if (control.invalid) {
                    control.markAsDirty();
                }
            }
        }
    }
    static ɵfac = function PoPageJobSchedulerBaseComponent_Factory(t) { return new (t || PoPageJobSchedulerBaseComponent)(i0.ɵɵdirectiveInject(i1.PoPageJobSchedulerService)); };
    static ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: PoPageJobSchedulerBaseComponent, inputs: { breadcrumb: [i0.ɵɵInputFlags.None, "p-breadcrumb", "breadcrumb"], serviceApi: [i0.ɵɵInputFlags.None, "p-service-api", "serviceApi"], title: [i0.ɵɵInputFlags.None, "p-title", "title"], parameters: [i0.ɵɵInputFlags.None, "p-parameters", "parameters"], value: [i0.ɵɵInputFlags.None, "p-value", "value"], stepperDefaultOrientation: [i0.ɵɵInputFlags.None, "p-orientation", "stepperDefaultOrientation"], beforeSendAction: [i0.ɵɵInputFlags.None, "p-before-send", "beforeSendAction"], stepExecutionLast: [i0.ɵɵInputFlags.None, "p-step-execution-last", "stepExecutionLast"] }, outputs: { success: "p-success", error: "p-error" } });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoPageJobSchedulerBaseComponent, [{
        type: Directive
    }], () => [{ type: i1.PoPageJobSchedulerService }], { breadcrumb: [{
            type: Input,
            args: ['p-breadcrumb']
        }], serviceApi: [{
            type: Input,
            args: ['p-service-api']
        }], title: [{
            type: Input,
            args: ['p-title']
        }], parameters: [{
            type: Input,
            args: ['p-parameters']
        }], value: [{
            type: Input,
            args: ['p-value']
        }], stepperDefaultOrientation: [{
            type: Input,
            args: ['p-orientation']
        }], beforeSendAction: [{
            type: Input,
            args: ['p-before-send']
        }], stepExecutionLast: [{
            type: Input,
            args: ['p-step-execution-last']
        }], success: [{
            type: Output,
            args: ['p-success']
        }], error: [{
            type: Output,
            args: ['p-error']
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tcGFnZS1qb2Itc2NoZWR1bGVyLWJhc2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdGVtcGxhdGVzL3NyYy9saWIvY29tcG9uZW50cy9wby1wYWdlLWpvYi1zY2hlZHVsZXIvcG8tcGFnZS1qb2Itc2NoZWR1bGVyLWJhc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFhLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFbEYsT0FBTyxFQUFvQyxvQkFBb0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRzlGLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBRTlFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxNQUFNLENBQUM7OztBQUVwQzs7Ozs7Ozs7OztHQVVHO0FBRUgsTUFBTSxPQUFPLCtCQUErQjtJQTBPcEI7SUF6T3RCLGdEQUFnRDtJQUN6QixVQUFVLEdBQWtCLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBRWpFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0FvSUc7SUFDcUIsVUFBVSxDQUFTO0lBRTNDLHdCQUF3QjtJQUNOLEtBQUssQ0FBUztJQUVoQzs7Ozs7T0FLRztJQUNvQixVQUFVLEdBQThCLEVBQUUsQ0FBQztJQUVsRSxJQUFzQixLQUFLLENBQUMsS0FBVTtRQUNwQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyw2QkFBNkIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuRixDQUFDO0lBRUQ7Ozs7Ozs7Ozs7O09BV0c7SUFFSCxJQUE0Qix5QkFBeUIsQ0FBQyxLQUEyQjtRQUMvRSxJQUFJLENBQUMsWUFBWSxHQUFTLE1BQU8sQ0FBQyxNQUFNLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBQ3JHLENBQUM7SUFFRCxJQUFJLHlCQUF5QjtRQUMzQixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDM0IsQ0FBQztJQUVEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0FxQkc7SUFDcUIsZ0JBQWdCLENBQTREO0lBRXBHOzs7Ozs7OztPQVFHO0lBQzZCLGlCQUFpQixDQUFVO0lBRTNEOzs7Ozs7T0FNRztJQUNrQixPQUFPLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztJQUV2RDs7Ozs7OztPQU9HO0lBQ2dCLEtBQUssR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO0lBRW5ELEtBQUssR0FBMkIsSUFBSSwwQkFBMEIsRUFBRSxDQUFDO0lBRXpELGFBQWEsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBQ25DLFlBQVksQ0FBQztJQUVyQixZQUFzQix5QkFBb0Q7UUFBcEQsOEJBQXlCLEdBQXpCLHlCQUF5QixDQUEyQjtJQUFHLENBQUM7SUFFOUUsV0FBVztRQUNULElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDbkMsQ0FBQztJQUVTLFFBQVEsQ0FBQyxFQUFtQjtRQUNwQyxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ1AsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxJQUFJLElBQUksMEJBQTBCLEVBQUUsQ0FBQztZQUM1RCxPQUFPO1NBQ1I7UUFFRCxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FDcEIsSUFBSSxDQUFDLHlCQUF5QixDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQ3RELENBQUMsUUFBZ0MsRUFBRSxFQUFFO1lBQ25DLElBQUksQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDO1FBQ3hCLENBQUMsRUFDRCxHQUFHLEVBQUU7WUFDSCxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksMEJBQTBCLEVBQUUsQ0FBQztRQUNoRCxDQUFDLENBQ0YsQ0FDRixDQUFDO0lBQ0osQ0FBQztJQUVTLDBCQUEwQixDQUFDLFFBQTRDO1FBQy9FLEtBQUssTUFBTSxHQUFHLElBQUksUUFBUSxFQUFFO1lBQzFCLElBQUksUUFBUSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDaEMsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUU5QixJQUFJLE9BQU8sQ0FBQyxPQUFPLEVBQUU7b0JBQ25CLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQztpQkFDdkI7YUFDRjtTQUNGO0lBQ0gsQ0FBQzt5RkE1UVUsK0JBQStCOzZEQUEvQiwrQkFBK0I7O2lGQUEvQiwrQkFBK0I7Y0FEM0MsU0FBUzswREFHZSxVQUFVO2tCQUFoQyxLQUFLO21CQUFDLGNBQWM7WUF1SUcsVUFBVTtrQkFBakMsS0FBSzttQkFBQyxlQUFlO1lBR0osS0FBSztrQkFBdEIsS0FBSzttQkFBQyxTQUFTO1lBUU8sVUFBVTtrQkFBaEMsS0FBSzttQkFBQyxjQUFjO1lBRUMsS0FBSztrQkFBMUIsS0FBSzttQkFBQyxTQUFTO1lBaUJZLHlCQUF5QjtrQkFBcEQsS0FBSzttQkFBQyxlQUFlO1lBOEJFLGdCQUFnQjtrQkFBdkMsS0FBSzttQkFBQyxlQUFlO1lBV1UsaUJBQWlCO2tCQUFoRCxLQUFLO21CQUFDLHVCQUF1QjtZQVNULE9BQU87a0JBQTNCLE1BQU07bUJBQUMsV0FBVztZQVVBLEtBQUs7a0JBQXZCLE1BQU07bUJBQUMsU0FBUyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFic3RyYWN0Q29udHJvbCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IElucHV0LCBEaXJlY3RpdmUsIE9uRGVzdHJveSwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgUG9CcmVhZGNydW1iLCBQb0R5bmFtaWNGb3JtRmllbGQsIFBvU3RlcHBlck9yaWVudGF0aW9uIH0gZnJvbSAnQHBvLXVpL25nLWNvbXBvbmVudHMnO1xuXG5pbXBvcnQgeyBQb0pvYlNjaGVkdWxlckludGVybmFsIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3BvLWpvYi1zY2hlZHVsZXItaW50ZXJuYWwuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvUGFnZUpvYlNjaGVkdWxlckludGVybmFsIH0gZnJvbSAnLi9wby1wYWdlLWpvYi1zY2hlZHVsZXItaW50ZXJuYWwnO1xuaW1wb3J0IHsgUG9QYWdlSm9iU2NoZWR1bGVyU2VydmljZSB9IGZyb20gJy4vcG8tcGFnZS1qb2Itc2NoZWR1bGVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogTyBgcG8tcGFnZS1qb2Itc2NoZWR1bGVyYCDDqSB1bWEgcMOhZ2luYSBwYXJhIGNyaWHDp8OjbyBlIGF0dWFsaXphw6fDo28gZGUgYWdlbmRhbWVudG9zIGRhIGV4ZWN1w6fDo28gZGUgcHJvY2Vzc29zIChKb2IgU2NoZWR1bGVyKSxcbiAqIGNvbW8gcG9yIGV4ZW1wbG86IGEgZ2VyYcOnw6NvIGRhIGZvbGhhIGRlIHBhZ2FtZW50byBkb3MgZnVuY2lvbsOhcmlvcy5cbiAqXG4gKiBQYXJhIHV0aWxpemFyIGVzdGEgcMOhZ2luYSwgYmFzdGEgaW5mb3JtYXIgbyBzZXJ2acOnbyAoZW5kcG9pbnQpIHBhcmEgY29uc3VtbyxcbiAqIHNlbSBhIG5lY2Vzc2lkYWRlIGRlIGNyaWFyIGNvbXBvbmVudGVzIGUgdHJhdGFtZW50b3MgZG9zIGRhZG9zLlxuICpcbiAqIFZlamEgbWFpcyBzb2JyZSBvcyBwYWRyw7VlcyB1dGlsaXphZG9zIG5hcyByZXF1aXNpw6fDtWVzIG5vIFtHdWlhIGRlIGltcGxlbWVudGHDp8OjbyBkZSBBUElzXShndWlkZXMvYXBpKS5cbiAqL1xuQERpcmVjdGl2ZSgpXG5leHBvcnQgY2xhc3MgUG9QYWdlSm9iU2NoZWR1bGVyQmFzZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSB7XG4gIC8qKiBPYmpldG8gY29tIGFzIHByb3ByaWVkYWRlcyBkbyBicmVhZGNydW1iLiAqL1xuICBASW5wdXQoJ3AtYnJlYWRjcnVtYicpIGJyZWFkY3J1bWI/OiBQb0JyZWFkY3J1bWIgPSB7IGl0ZW1zOiBbXSB9O1xuXG4gIC8qKlxuICAgKiBFbmRwb2ludCB1c2FkbyBwZWxvIGNvbXBvbmVudGUgcGFyYSBidXNjYSBkb3MgcHJvY2Vzc29zIGUgcGFyw6JtZXRyb3MgcXVlIHNlcsOjbyB1dGlsaXphZG9zIHBhcmEgY3JpYcOnw6NvIGUgZWRpw6fDo28gZG9zIGFnZW5kYW1lbnRvcy5cbiAgICpcbiAgICogIyMjIyBQcm9jZXNzb3NcbiAgICpcbiAgICogT3MgcHJvY2Vzc29zIHPDo28gYXMgdGFyZWZhcyBxdWUgZXN0YXLDo28gZGlzcG9uw612ZWlzIHBhcmEgbyB1c3XDoXJpbyBwb2RlciBmYXplciBvcyBhZ2VuZGFtZW50b3MuXG4gICAqIEFvIGluaWNpYWxpemFyIG8gY29tcG9uZW50ZSwgc2Vyw6EgZmVpdG8gdW1hIHJlcXVpc2nDp8OjbyBgR0VUYCBwYXJhIG8gZW5kcG9pbnQgYHtzZXJ2aWNlLWFwaX0vcHJvY2Vzc2VzYCwgcGFyYSBidXNjYXJcbiAgICogZXNzYSBsaXN0YSBkZSBwcm9jZXNzb3MuXG4gICAqXG4gICAqIEVzdGUgZW5kcG9pbnQgYHtzZXJ2aWNlLWFwaX0vcHJvY2Vzc2VzYCBkZXZlIHJldG9ybmFyIHVtYSBsaXN0YSBkZSBvYmpldG9zIHF1ZSBzZWd1ZW0gYSBkZWZpbmnDp8OjbyBkZSBkYWRvcyBhYmFpeG86XG4gICAqXG4gICAqIGBgYFxuICAgKiBHRVQge3NlcnZpY2UtYXBpfS9wcm9jZXNzZXNcbiAgICogYGBgXG4gICAqXG4gICAqIGBgYFxuICAgKiB7XG4gICAqICAgaXRlbXM6IFtcbiAgICogICAgIHsgXCJwcm9jZXNzSURcIjogXCJhYzRmXCIsIFwiZGVzY3JpcHRpb25cIjogXCJHZXJhciBmb2xoYSBkZSBwYWdhbWVudG9cIiB9LFxuICAgKiAgICAgeyBcInByb2Nlc3NJRFwiOiBcImRmNmxcIiwgXCJkZXNjcmlwdGlvblwiOiBcIlJlbGF0w7NyaW8gZGUgaW1wb3N0byBhIHJlY29saGVyXCIgfSxcbiAgICogICAgIHsgXCJwcm9jZXNzSURcIjogXCJkazNwXCIsIFwiZGVzY3JpcHRpb25cIjogXCJUw610dWxvcyBlbSBhYmVydG9cIiB9LFxuICAgKiAgIF1cbiAgICogfVxuICAgKiBgYGBcbiAgICpcbiAgICogRGVzdGEgZm9ybWEgc2Vyw6EgcmVuZGVyaXphZG8gdW0gY29tcG9uZW50ZSBwYXJhIHNlbGVjaW9uYXIgbyBwcm9jZXNzbyBlL291IGZpbHRyw6EtbG9zLlxuICAgKlxuICAgKiBQYXJhIHJlYWxpemFyIG8gZmlsdHJvIGRlIGJ1c2NhIGRvIHByb2Nlc3NvLCBzZXLDoSBmZWl0YSB1bWEgcmVxdWlzacOnw6NvIGVudmlhbmRvIG8gY29udGXDumRvIGRpZ2l0YWRvIG5hIGJ1c2NhIGF0cmF2w6lzIGRvXG4gICAqIHBhcsOibWV0cm8gYHNlYXJjaGAuIERhIHNlZ3VpbnRlIGZvcm1hOlxuICAgKlxuICAgKiBgYGBcbiAgICogR0VUIHtzZXJ2aWNlLWFwaX0vcHJvY2Vzc2VzP3NlYXJjaD1yZWxhdG9yaW9cbiAgICogYGBgXG4gICAqXG4gICAqID4gVmVqYSBtYWlzIHNvYnJlIHBhZ2luYcOnw6NvIGUgZmlsdHJvcyBubyBbR3VpYSBkZSBpbXBsZW1lbnRhw6fDo28gZGUgQVBJc10oZ3VpZGVzL2FwaSkuXG4gICAqIENhc28gc2VqYSBpbmZvcm1hZGEgYSBwcm9wcmllZGFkZSBgcC1wYXJhbWV0ZXJzYCBuw6NvIHNlcsOjbyByZWFsaXphZGFzIGFzIHJlcXVpc2nDp8O1ZXMgZGUgcHJvY2Vzc29zIGUgbmVtIGRlIHBhcmFtZXRyb3MgYXV0b21hdGljYW1lbnRlLlxuICAgKlxuICAgKiBUYW1iw6ltIMOpIHBvc3PDrXZlbCBmYXplciB1bSBhZ2VuZGFtZW50byBkZSB1bSBwcm9jZXNzbyBlc3BlY8OtZmljbywgc2VtIHF1ZSBzZWphIG5lY2Vzc8OhcmlvIHVtIGVuZHBvaW50IHBhcmEgYnVzY2EgZGVzc2VzXG4gICAqIHByb2Nlc3Nvcy4gRW50w6NvLCBjYXNvIG8gZW5kcG9pbnQgYHtzZXJ2aWNlLWFwaX0vcHJvY2Vzc2VzYCBuw6NvIHNlamEgdsOhbGlkbywgc2Vyw6EgYXByZXNlbnRhZG8gdW0gY2FtcG8gZGUgZW50cmFkYSBkZVxuICAgKiB0ZXh0byBwYXJhIG8gdXN1w6FyaW8gaW5mb3JtYXIgZGlyZXRhbWVudGVcbiAgICogbyAqKmlkZW50aWZpY2Fkb3IgZG8gcHJvY2Vzc28gLSBgcHJvY2Vzc0lEYCoqIGUgYW8gc2FsdmFyIHNlcsOhIGVudmlhZG8gdW0gYFBPU1RgIHBhcmEgbyBlbmRwb2ludCBkaWZpbmlkbyBgc2VydmljZUFwaWAgY29uZm9ybWUgYWJhaXhvOlxuICAgKlxuICAgKiBgYGBcbiAgICogUE9TVCB7c2VydmljZS1hcGl9XG4gICAqIGBgYFxuICAgKlxuICAgKiAqUmVxdWVzdCBwYXlsb2FkKiAtIGVzdHJ1dHVyYSBkZSBkYWRvcyBlbnZpYWRhIG5vIGNvcnBvIGRhIHJlcXVpc2nDp8OjbyBjb25mb3JtZSBpbnRlcmZhY2UgYFBvSm9iU2NoZWR1bGVyYDpcbiAgICpcbiAgICogYGBgXG4gICAqIHtcbiAgICogICBcImRhaWx5XCI6IHsgXCJob3VyXCI6IDEwLCBcIm1pbnV0ZVwiOiAxMiB9LFxuICAgKiAgIFwiZmlyc3RFeGVjdXRpb25cIjogXCIyMDE4LTEyLTA3VDAwOjAwOjAxLTAwOjAwXCIsXG4gICAqICAgXCJyZWN1cnJlbnRcIjogdHJ1ZSxcbiAgICogICBcInByb2Nlc3NJRFwiOiBcImFjMDQwNVwiXG4gICAqICAgLi4uXG4gICAqIH1cbiAgICogYGBgXG4gICAqXG4gICAqIENhc28gc2VqYSBuZWNlc3PDoXJpbyBpbmZvcm1hciBwYXLDom1ldHJvcyBlIGFkaWNpb25hciBjb25maWd1cmHDp8O1ZXMgbm8gcHJvY2Vzc28gc2VsZWNpb25hZG8sIHNlcsOhIHJlYWxpemFkbyB1bSBgR0VUYFxuICAgKiBjb21vIGV4ZW1wbGlmaWNhZG8gYWJhaXhvLiBPcyBwYXLDom1ldHJvcyBkZXZlbSByZXRvcm5hciB1bWEgbGlzdGEgZGUgb2JqZXRvcyBxdWUgc2VndWVtIGEgaW50ZXJmYWNlXG4gICAqIFtQb0R5bmFtaWNGb3JtRmllbGRdKC9kb2N1bWVudGF0aW9uL3BvLWR5bmFtaWMtZm9ybSkuIFBvcsOpbSwgY2FzbyB1dGlsaXphciBhIHByb3ByaWVkYWRlIGBwLXBhcmFtZXRlcnNgIG8gY29tcG9uZW50ZSBuw6NvXG4gICAqIHJlYWxpemFyw6EgYSBidXNjYSBhdXRvbcOhdGljYSBlIG8gY2FtcG8gZGUgcHJvY2Vzc29zIG7Do28gc2Vyw6EgZXhpYmlkby5cbiAgICpcbiAgICogYGBgXG4gICAqIEdFVCB7c2VydmljZS1hcGl9L3Byb2Nlc3Nlcy86aWQvcGFyYW1ldGVyc1xuICAgKiAuLi5cbiAgICoge1xuICAgKiAgIGl0ZW1zOiBbXG4gICAqICAgICB7IFwicHJvcGVydHlcIjogXCJ2ZW5jaW1lbnRvXCIsIHR5cGU6IFwiZGF0ZVwiIH0sXG4gICAqICAgICB7IFwicHJvcGVydHlcIjogXCJpbXBvc3RvLXJldGlkb1wiLCBcImxhYmVsXCI6IFwiSW1wb3N0byBSZXRpZG9cIiwgdHlwZTogXCJib29sZWFuXCIgfVxuICAgKiAgIF1cbiAgICogfVxuICAgKiBgYGBcbiAgICpcbiAgICogIyMjIyBTYWx2YXIgZSBBdHVhbGl6YXJcbiAgICpcbiAgICogUGFyYSBzYWx2YXIgbyBhZ2VuZGFtZW50bywgc2Vyw6EgZmVpdGEgdW1hIHJlcXVpc2nDp8OjbyBkZSBjcmlhw6fDo28sIHBhc3NhbmRvIG9zIHZhbG9yZXMgcHJlZW5jaGlkb3MgcGVsbyB1c3XDoXJpbyB2aWEgKnBheWxvYWQqLlxuICAgKiBBYmFpeG8gdW1hIHJlcXVpc2nDp8OjbyBgUE9TVGAgZGlzcGFyYWRhLCBvbmRlIGFzIHByb3ByaWVkYWRlcyBkbyAqSm9iIFNjaGVkdWxlciogZm9yYW0gcHJlZW5jaGlkYXM6XG4gICAqXG4gICAqIGBgYFxuICAgKiAgUE9TVCB7c2VydmljZS1hcGl9XG4gICAqIGBgYFxuICAgKlxuICAgKiAqUmVxdWVzdCBwYXlsb2FkKiAtIGVzdHJ1dHVyYSBkZSBkYWRvcyBlbnZpYWRhIG5vIGNvcnBvIGRhIHJlcXVpc2nDp8OjbyBjb25mb3JtZSBpbnRlcmZhY2UgYFBvSm9iU2NoZWR1bGVyYDpcbiAgICpcbiAgICogYGBgXG4gICAqIHtcbiAgICogICBcImZpcnN0RXhlY3V0aW9uXCI6IFwiMjAxOC0xMi0wN1QwMDowMDowMS0wMDowMFwiLFxuICAgKiAgIFwicmVjdXJyZW50XCI6IHRydWUsXG4gICAqICAgXCJtb250aGx5XCI6IHsgXCJkYXlcIjogMSwgXCJob3VyXCI6IDEwLCBcIm1pbnV0ZVwiOiAwIH0sXG4gICAqICAgXCJwcm9jZXNzSURcIjogXCJhYzA0MDVcIixcbiAgICogICBcInJhbmdlRXhlY3V0aW9uczogeyBcImZyZXF1ZW5jeVwiOiB7IFwidHlwZVwiOiBcImhvdXJcIiwgXCJ2YWx1ZVwiOiAyIH0sIFwicmFuZ2VMaW1pdFwiOiB7IFwiaG91clwiOiAxOCwgXCJtaW51dGVcIjogMCwgXCJkYXlcIjogMjAgfSB9XG4gICAqIH1cbiAgICogYGBgXG4gICAqXG4gICAqIENhc28gcXVlaXJhIHF1ZSBvIGNvbXBvbmVudGUgY2FycmVndWUgdW0gYWdlbmRhbWVudG8gasOhIGV4aXN0ZW50ZSwgZGV2ZSBzZXIgaW5jbHXDrWRvIHVtIHBhcsOibWV0cm8gbmEgcm90YSBjaGFtYWRvIGBpZGAuXG4gICAqXG4gICAqIEV4ZW1wbG8gZGUgY29uZmlndXJhw6fDo28gZGUgcm90YTpcbiAgICpcbiAgICogYGBgXG4gICAqICBSb3V0ZXJNb2R1bGUuZm9yUm9vdChbXG4gICAqICAgIC4uLlxuICAgKiAgICB7IHBhdGg6ICdlZGl0LzppZCcsIGNvbXBvbmVudDogRXhhbXBsZUpvYlNjaGVkdWxlckNvbXBvbmVudCB9LFxuICAgKiAgICAuLi5cbiAgICogIF0sXG4gICAqIGBgYFxuICAgKlxuICAgKiBCYXNlYWRvIG5pc3NvLCBuYSBpbmljaWFsaXphw6fDo28gZG8gdGVtcGxhdGUgc2Vyw6EgZGlzcGFyYWRvIHVtYSByZXF1aXNpw6fDo28gcGFyYSBidXNjYXIgbyByZWN1cnNvIHF1ZSBzZXLDoSBlZGl0YWRvLlxuICAgKlxuICAgKiBgYGBcbiAgICogR0VUIHtzZXJ2aWNlLWFwaX0ve2lkfVxuICAgKiBgYGBcbiAgICpcbiAgICogQW8gYXR1YWxpemFyIG8gYWdlbmRhbWVudG8sIHNlcsOhIGRpc3BhcmFkbyB1bSBgUFVUYCBjb20gb3MgZGFkb3MgcHJlZW5jaGlkb3MuXG4gICAqIFZlamEgYWJhaXhvIHVtYSByZXF1aXNpw6fDo28gYFBVVGAgZGlzcGFyYWRhLCBvbmRlIGEgcHJvcHJpZWRhZGUgKnJlY3VycmVudCogZSAqZGFpbHkqIGZvcmFtIGF0dWFsaXphZGFzOlxuICAgKlxuICAgKiBgYGBcbiAgICogIFBVVCB7c2VydmljZS1hcGl9L3tpZH1cbiAgICogYGBgXG4gICAqXG4gICAqICpSZXF1ZXN0IHBheWxvYWQqIC0gZXN0cnV0dXJhIGRlIGRhZG9zIGVudmlhZGEgbm8gY29ycG8gZGEgcmVxdWlzacOnw6NvIGNvbmZvcm1lIGludGVyZmFjZSBgUG9Kb2JTY2hlZHVsZXJgOlxuICAgKlxuICAgKiBgYGBcbiAgICoge1xuICAgKiAgIFwiZmlyc3RFeGVjdXRpb25cIjogXCIyMDE4LTEyLTA3VDAwOjAwOjAxLTAwOjAwXCIsXG4gICAqICAgXCJyZWN1cnJlbnRcIjogdHJ1ZSxcbiAgICogICBcInByb2Nlc3NJRFwiOiBcImFjMDQwNVwiLFxuICAgKiAgIFwibW9udGhseVwiOiB7IFwiZGF5XCI6IDEsIFwiaG91clwiOiAxMCwgXCJtaW51dGVcIjogMCB9LFxuICAgKiAgIFwicHJvY2Vzc0lEXCI6IFwiYWMwNDA1XCIsXG4gICAqICAgXCJyYW5nZUV4ZWN1dGlvbnM6IHsgXCJmcmVxdWVuY3lcIjogeyBcInR5cGVcIjogXCJob3VyXCIsIFwidmFsdWVcIjogMiB9LCBcInJhbmdlTGltaXRcIjogeyBcImhvdXJcIjogMTgsIFwibWludXRlXCI6IDAsIFwiZGF5XCI6IDIwIH0gfVxuICAgKiB9XG4gICAqIGBgYFxuICAgKi9cbiAgQElucHV0KCdwLXNlcnZpY2UtYXBpJykgc2VydmljZUFwaTogc3RyaW5nO1xuXG4gIC8qKiBUw610dWxvIGRhIHDDoWdpbmEuICovXG4gIEBJbnB1dCgncC10aXRsZScpIHRpdGxlOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFBhcsOibWV0cm9zIHF1ZSBzZXLDo28gdXRpbGl6YWRvcyBwYXJhIGNyaWHDp8OjbyBlIGVkacOnw6NvIGRvcyBhZ2VuZGFtZW50b3MuXG4gICAqXG4gICAqIEFvIHV0aWxpemFyIGVzdGEgcHJvcHJpZWRhZGUsIG8gY29tcG9uZW50ZSBuw6NvIGJ1c2NhcsOhIGF1dG9tYXRpY2FtZW50ZSBvcyBwYXLDom1ldHJvcyBkYSBBUEkgZSBvIGNhbXBvIHBhcmEgcHJlZW5jaGltZW50byBkbyBwcm9jZXNzbyBuw6NvIHNlcsOhIGV4aWJpZG8uXG4gICAqXG4gICAqL1xuICBASW5wdXQoJ3AtcGFyYW1ldGVycycpIHBhcmFtZXRlcnM6IEFycmF5PFBvRHluYW1pY0Zvcm1GaWVsZD4gPSBbXTtcblxuICBASW5wdXQoJ3AtdmFsdWUnKSBzZXQgdmFsdWUodmFsdWU6IGFueSkge1xuICAgIHRoaXMubW9kZWwgPSB0aGlzLnBvUGFnZUpvYlNjaGVkdWxlclNlcnZpY2UuY29udmVydFRvSm9iU2NoZWR1bGVySW50ZXJuYWwodmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRGVmaW5lIGEgb3JpZW50YcOnw6NvIGRlIGV4aWJpw6fDo28gZG8gYHBvLXN0ZXBwZXJgLlxuICAgKlxuICAgKiA+IFF1YW5kbyBuw6NvIHV0aWxpemFkYSwgc2VndWUgbyBjb21wb3J0YW1lbnRvIGNvbSBiYXNlIG5hcyBkaW1lbnPDtWVzIGRhIHRlbGEuXG4gICAqXG4gICAqID4gVmVqYSBvcyB2YWxvcmVzIHbDoWxpZG9zIG5vICplbnVtKiBbUG9TdGVwcGVyT3JpZW50YXRpb25dKGRvY3VtZW50YXRpb24vcG8tc3RlcHBlciNzdGVwcGVyT3JpZW50YXRpb24pLlxuICAgKlxuICAgKi9cblxuICBASW5wdXQoJ3Atb3JpZW50YXRpb24nKSBzZXQgc3RlcHBlckRlZmF1bHRPcmllbnRhdGlvbih2YWx1ZTogUG9TdGVwcGVyT3JpZW50YXRpb24pIHtcbiAgICB0aGlzLl9vcmllbnRhdGlvbiA9ICg8YW55Pk9iamVjdCkudmFsdWVzKFBvU3RlcHBlck9yaWVudGF0aW9uKS5pbmNsdWRlcyh2YWx1ZSkgPyB2YWx1ZSA6IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGdldCBzdGVwcGVyRGVmYXVsdE9yaWVudGF0aW9uKCk6IFBvU3RlcHBlck9yaWVudGF0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb247XG4gIH1cblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBGdW7Dp8OjbyBjaGFtYWRhIGFww7NzIHJlYWxpemFyIGEgY29uZmlybWHDp8OjbyBkYSBleGVjdcOnw6NvIG5vIFBvUGFnZUpvYlNjaGVkdWxlci5cbiAgICogUGVybWl0ZSBhbHRlcmFyIG9zIHZhbG9yZXMgZG8gbW9kZWwgZG8gUG9QYWdlSm9iU2NoZWR1bGVyIGFudGVzIGRlIHJlYWxpemFyIG8gZW52aW8gcGFyYSBhIEFwaS5cbiAgICpcbiAgICogPiBEZXZlIHJldG9ybmFyIHVtIG9iamV0byBkbyB0aXBvIGBQb1BhZ2VKb2JTY2hlZHVsZXJgIHBhcmEgc2VyIGFkaWNpb25hZG8gYW8gbW9kZWwgZG8gUG9QYWdlSm9iU2NoZWR1bGVyLlxuICAgKlxuICAgKiA+IEFvIHNlciBkaXNwYXJhZGEsIGEgbWVzbWEgcmVjZWJlcsOhIHBvciBwYXLDom1ldHJvIG8gbW9kZWwgZG8gUG9QYWdlSm9iU2NoZWR1bGVyIGRlIGludGVyZmFjZSBgUG9Kb2JTY2hlZHVsZXJJbnRlcm5hbGAuXG4gICAqXG4gICAqIE8gY29udGV4dG8gZGEgZnVuw6fDo28gcXVlIHNlcsOhIGNoYW1hZGEsIHNlcsOhIG8gbWVzbW8gcXVlIG8gZG8gYFBvUGFnZUpvYlNjaGVkdWxlcmAsIGVudMOjbyBwYXJhIHBvZGVyIGFsdGVyYXJcbiAgICogcGFyYSBvIGNvbnRleHRvIGRvIGNvbXBvbmVudGUgcXVlIG8gZXN0w6EgdXRpbGl6YW5kbywgcG9kZSBzZXIgdXRpbGl6YWRvIGEgcHJvcHJpZWRhZGUgYGJpbmRgIGRvIEphdmFzY3JpcHQuXG4gICAqIFBvciBleGVtcGxvLCBwYXJhIGEgZnVuw6fDo28gYGJlZm9yZVNlbmRgOlxuICAgKlxuICAgKiBgYGBcbiAgICogPHBvLXBhZ2Utam9iLXNjaGVkdWxlciBbcC1zZXJ2aWNlLWFwaV09XCJzZXJ2aWNlQXBpXCIgW3AtcGFyYW1ldGVyc109XCJwYXJhbXNcIiBbcC1iZWZvcmUtc2VuZF09XCJiZWZvcmVTZW5kLmJpbmQodGhpcylcIj5cbiAgICogLi4uXG4gICAqIDwvcG8tcGFnZS1qb2Itc2NoZWR1bGVyPlxuICAgKiBgYGBcbiAgICovXG4gIEBJbnB1dCgncC1iZWZvcmUtc2VuZCcpIGJlZm9yZVNlbmRBY3Rpb246IChtb2RlbDogUG9Kb2JTY2hlZHVsZXJJbnRlcm5hbCkgPT4gUG9Kb2JTY2hlZHVsZXJJbnRlcm5hbDtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBEZWZpbmUgc2UgbyBzdGVwIGBBZ2VuZGFtZW50b2AgZGV2ZSBzZXIgZXhpYmlkbyBjb21vIG8gw7psdGltbyBuYSBzZXF1w6puY2lhIGRlIHN0ZXBzXG4gICAqXG4gICAqID4gQXBsaWPDoXZlbCBhcGVuYXMgcXVhbmRvIHV0aWxpemFkbyBgUG9Kb2JTY2hlZHVsZXJQYXJhbWV0ZXJzVGVtcGxhdGVEaXJlY3RpdmVgXG4gICAqL1xuICBASW5wdXQoJ3Atc3RlcC1leGVjdXRpb24tbGFzdCcpIHN0ZXBFeGVjdXRpb25MYXN0OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIEV2ZW50byBkaXNwYXJhZG8gYW8gY29uY2x1aXIgbyBwcm9jZXNzbyBkZSBhZ2VuZGFtZW50byBjb20gc3VjZXNzby5cbiAgICovXG4gIEBPdXRwdXQoJ3Atc3VjY2VzcycpIHN1Y2Nlc3MgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBFdmVudG8gZGlzcGFyYWRvIGFvIG9jb3JyZXIgdW0gZXJybyBpbXBvc3NpYmlsaXRhbmRvIGEgY29uY2x1c8OjbyBkbyBhZ2VuZGFtZW50by5cbiAgICogUGFyYSBlc3RlIGV2ZW50byBzZXLDoSBwYXNzYWRvIGNvbW8gcGFyw6JtZXRybyBvcyBkZXRhbGhlcyBkbyBlcnJvLlxuICAgKi9cbiAgQE91dHB1dCgncC1lcnJvcicpIGVycm9yID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgbW9kZWw6IFBvSm9iU2NoZWR1bGVySW50ZXJuYWwgPSBuZXcgUG9QYWdlSm9iU2NoZWR1bGVySW50ZXJuYWwoKTtcblxuICBwcml2YXRlIF9zdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gIHByaXZhdGUgX29yaWVudGF0aW9uO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBwb1BhZ2VKb2JTY2hlZHVsZXJTZXJ2aWNlOiBQb1BhZ2VKb2JTY2hlZHVsZXJTZXJ2aWNlKSB7fVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuX3N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGxvYWREYXRhKGlkOiBzdHJpbmcgfCBudW1iZXIpIHtcbiAgICBpZiAoIWlkKSB7XG4gICAgICB0aGlzLm1vZGVsID0gdGhpcy5tb2RlbCB8fCBuZXcgUG9QYWdlSm9iU2NoZWR1bGVySW50ZXJuYWwoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9zdWJzY3JpcHRpb24uYWRkKFxuICAgICAgdGhpcy5wb1BhZ2VKb2JTY2hlZHVsZXJTZXJ2aWNlLmdldFJlc291cmNlKGlkKS5zdWJzY3JpYmUoXG4gICAgICAgIChyZXNwb25zZTogUG9Kb2JTY2hlZHVsZXJJbnRlcm5hbCkgPT4ge1xuICAgICAgICAgIHRoaXMubW9kZWwgPSByZXNwb25zZTtcbiAgICAgICAgfSxcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIHRoaXMubW9kZWwgPSBuZXcgUG9QYWdlSm9iU2NoZWR1bGVySW50ZXJuYWwoKTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgbWFya0FzRGlydHlJbnZhbGlkQ29udHJvbHMoY29udHJvbHM6IHsgW2tleTogc3RyaW5nXTogQWJzdHJhY3RDb250cm9sIH0pIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBjb250cm9scykge1xuICAgICAgaWYgKGNvbnRyb2xzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgY29uc3QgY29udHJvbCA9IGNvbnRyb2xzW2tleV07XG5cbiAgICAgICAgaWYgKGNvbnRyb2wuaW52YWxpZCkge1xuICAgICAgICAgIGNvbnRyb2wubWFya0FzRGlydHkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19