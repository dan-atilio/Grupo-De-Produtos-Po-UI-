import { Input, Directive, Output, EventEmitter } from '@angular/core';
import { convertToBoolean } from '../../utils/util';
import * as i0 from "@angular/core";
export class PoPageDynamicListBaseComponent {
    /** Objeto com propriedades do breadcrumb. */
    breadcrumb = { items: [] };
    /** Endpoint da API dos recursos que serão exibidos. */
    /**
     * @description
     *
     * Endpoint usado pelo template para requisição dos recursos que serão exibidos.
     *
     * Ao realizar requisições de busca, podem ser enviados os parâmetros (caso possuam valor): `page`, `pageSize`, `search` e `order`.
     *
     * Caso a coluna estiver ordenada descendentemente será enviada da seguinte forma: `-name`, se for ordenada
     * ascendentemente será enviada apenas com o nome da coluna, por exemplo: `name`.
     *
     * Exemplo de uma requisição de busca:
     *
     * > `GET {end-point}/{resource}?page=1&pageSize=10&search=components&order=-name`
     *
     * Caso a ação `remove` estiver configurada, será feito uma requisição de exclusão nesse mesmo endpoint passando os campos
     * setados como `key: true`.
     *
     * > `DELETE {end-point}/{keys}`
     *
     * ```
     *  <po-page-dynamic-table
     *    [p-actions]="{ remove: true }"
     *    [p-fields]="[ { property: 'id', key: true } ]"
     *    p-service="/api/po-samples/v1/people"
     *    ...>
     *  </po-page-dynamic-table>
     * ```
     *
     * Resquisição disparada, onde a propriedade `id` é igual a 2:
     *
     * ```
     *  DELETE /api/po-samples/v1/people/2 HTTP/1.1
     *  Host: localhost:4000
     *  Connection: keep-alive
     *  Accept: application/json, text/plain
     *  ...
     * ```
     *
     * Para a ação `removeAll`, será feito uma requisição de exclusão em lote para esse mesmo endpoint passando, uma lista
     * de objetos com os campos setados como `key: true` via `payload`.
     *
     * > `DELETE {end-point}`
     *
     * > `Payload: [ {key}, {key} ... {key} ]`
     *
     * ```
     *  <po-page-dynamic-table
     *    [p-actions]="{ removeAll: true }"
     *    [p-fields]="[ { property: 'id', key: true } ]"
     *    p-service="/api/po-samples/v1/people"
     *    ...>
     *  </po-page-dynamic-table>
     * ```
     *
     * Resquisição disparada, onde foram selecionados 3 itens para serem removidos:
     *
     * ```
     *  DELETE /api/po-samples/v1/people HTTP/1.1
     *  Host: localhost:4000
     *  Connection: keep-alive
     *  Accept: application/json, text/plain
     *  ...
     * ```
     *
     * Request payload:
     *
     * ```
     * [{"id":2},{"id":4},{"id":5}]
     * ```
     *
     * > Caso esteja usando metadados com o template, será disparado uma requisição na inicialização do template para buscar
     * > os metadados da página passando o tipo do metadado esperado e a versão cacheada pelo browser.
     * >
     * > `GET {end-point}/metadata?type=list&version={version}`
     */
    serviceApi;
    /** Título da página. */
    title;
    /**
     * @optional
     *
     * @description
     * Evento disparado ao fechar o popover do gerenciador de colunas após alterar as colunas visíveis.
     *
     * O componente envia como parâmetro um array de string com as colunas visíveis atualizadas.
     * Por exemplo: ["idCard", "name", "hireStatus", "age"].
     */
    changeVisibleColumns = new EventEmitter();
    /**
     * @optional
     *
     * @description
     * Evento disparado ao clicar no botão de restaurar padrão no gerenciador de colunas.
     *
     * O componente envia como parâmetro um array de string com as colunas configuradas inicialmente.
     * Por exemplo: ["idCard", "name", "hireStatus", "age"].
     */
    columnRestoreManager = new EventEmitter();
    /**
     * @optional
     *
     * @description
     *
     * Evento executado ao ordenar colunas da tabela.
     *
     * Recebe um objeto `{ column, type }` onde:
     *
     * - column (`PoTableColumn`): objeto da coluna que foi clicada/ordenada.
     * - type (`PoTableColumnSortType`): tipo da ordenação.
     */
    sortBy = new EventEmitter();
    _autoRouter = false;
    _columns = [];
    _duplicates = [];
    _fields = [];
    _filters = [];
    _keys = [];
    /**
     * @optional
     *
     * @description
     *
     * Cria automaticamente as rotas de edição (novo/duplicate) e detalhes caso sejam definidas ações na propriedade `p-actions`
     *
     * As rotas criadas serão baseadas na propriedade `p-actions`.
     *
     * > Para o correto funcionamento não pode haver nenhuma rota coringa (`**`) especificada.
     *
     * @default false
     */
    set autoRouter(value) {
        this._autoRouter = convertToBoolean(value);
    }
    get autoRouter() {
        return this._autoRouter;
    }
    /**
     * @optional
     *
     * @description
     *
     * Lista dos campos usados na tabela e busca avançada.
     *
     *
     * > Caso não seja definido fields a tabela assumirá o comportamento padrão.
     */
    set fields(fields) {
        this._fields = Array.isArray(fields) ? [...fields] : [];
        this.setFieldsProperties(this.fields);
    }
    get fields() {
        return this._fields;
    }
    set columns(value) {
        this._columns = [...(this._columns = this.sortColumnsByOrder(value))];
    }
    get columns() {
        return this._columns;
    }
    set duplicates(value) {
        this._duplicates = [...value];
    }
    get duplicates() {
        return this._duplicates;
    }
    set filters(value) {
        this._filters = [...value];
    }
    get filters() {
        return this._filters;
    }
    set keys(value) {
        this._keys = [...value];
    }
    get keys() {
        return this._keys;
    }
    setFieldsProperties(fields) {
        let visibleFilter;
        this.filters = fields
            .filter(field => field.filter === true)
            .map(filterField => {
            visibleFilter = !(filterField.initValue && filterField.fixed);
            return { ...filterField, visible: visibleFilter };
        });
        this.columns = fields.filter(field => field.visible === undefined || field.visible === true || field.allowColumnsManager === true);
        this.keys = fields.filter(field => field.key === true).map(field => field.property);
        this.duplicates = fields.filter(field => field.duplicate === true).map(field => field.property);
    }
    /**
     * Ordena um array de colunas com base na propriedade `order` de cada coluna.
     *
     * Este método é utilizado para organizar as colunas de uma tabela ou qualquer coleção similar
     * que necessite de ordenação baseada em um critério numérico definido pela propriedade `order`.
     * A ordenação segue as seguintes regras:
     *
     * 1. Colunas que possuem a propriedade `order` com um valor numérico válido e maior que zero
     *    são ordenadas em ordem crescente de acordo com este valor.
     *
     * 2. Colunas que não possuem a propriedade `order` ou que possuem um valor inválido ou não numérico
     *    para esta propriedade são consideradas iguais em termos de ordenação e mantêm a ordem original
     *    em que apareceram no array fornecido.
     *
     * 3. No caso de duas colunas com valores de `order` válidos e idênticos, a ordem entre essas duas colunas
     *    é determinada pela sua ordem original no array fornecido.
     *
     * @param columns Array de colunas a ser ordenado. Cada coluna é um objeto que pode conter uma propriedade `order`.
     *                O tipo `Array<any>` é utilizado aqui para permitir flexibilidade nos objetos de coluna que podem ser passados,
     *                mas espera-se que cada objeto tenha pelo menos uma propriedade `order` para a ordenação adequada.
     *
     * @returns Um novo array de colunas ordenado com base na propriedade `order`.
     */
    sortColumnsByOrder(columns) {
        return columns.sort((a, b) => {
            // Checa se 'order' existe e é um número válido em ambos os objetos
            const hasValidOrderA = 'order' in a && typeof a.order === 'number' && a.order > 0;
            const hasValidOrderB = 'order' in b && typeof b.order === 'number' && b.order > 0;
            // Se ambos têm 'order' válido, compara diretamente
            if (hasValidOrderA && hasValidOrderB) {
                return a.order - b.order;
            }
            // Se apenas A tem 'order' válido, A vem antes de B
            if (hasValidOrderA) {
                return -1;
            }
            // Se apenas B tem 'order' válido, B vem antes de A
            if (hasValidOrderB) {
                return 1;
            }
            // Se nenhum dos dois tem 'order' válido, mantém a ordem original (considerando como iguais neste contexto)
            return 0;
        });
    }
    static ɵfac = function PoPageDynamicListBaseComponent_Factory(t) { return new (t || PoPageDynamicListBaseComponent)(); };
    static ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: PoPageDynamicListBaseComponent, inputs: { breadcrumb: [i0.ɵɵInputFlags.None, "p-breadcrumb", "breadcrumb"], serviceApi: [i0.ɵɵInputFlags.None, "p-service-api", "serviceApi"], title: [i0.ɵɵInputFlags.None, "p-title", "title"], autoRouter: [i0.ɵɵInputFlags.None, "p-auto-router", "autoRouter"], fields: [i0.ɵɵInputFlags.None, "p-fields", "fields"] }, outputs: { changeVisibleColumns: "p-change-visible-columns", columnRestoreManager: "p-restore-column-manager", sortBy: "p-sort-by" } });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoPageDynamicListBaseComponent, [{
        type: Directive
    }], null, { breadcrumb: [{
            type: Input,
            args: ['p-breadcrumb']
        }], serviceApi: [{
            type: Input,
            args: ['p-service-api']
        }], title: [{
            type: Input,
            args: ['p-title']
        }], changeVisibleColumns: [{
            type: Output,
            args: ['p-change-visible-columns']
        }], columnRestoreManager: [{
            type: Output,
            args: ['p-restore-column-manager']
        }], sortBy: [{
            type: Output,
            args: ['p-sort-by']
        }], autoRouter: [{
            type: Input,
            args: ['p-auto-router']
        }], fields: [{
            type: Input,
            args: ['p-fields']
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tcGFnZS1keW5hbWljLWxpc3QtYmFzZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy90ZW1wbGF0ZXMvc3JjL2xpYi9jb21wb25lbnRzL3BvLXBhZ2UtZHluYW1pYy10YWJsZS9wby1wYWdlLWR5bmFtaWMtbGlzdC1iYXNlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSXZFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGtCQUFrQixDQUFDOztBQUtwRCxNQUFNLE9BQU8sOEJBQThCO0lBQ3pDLDZDQUE2QztJQUN0QixVQUFVLEdBQWtCLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBRWpFLHVEQUF1RDtJQUN2RDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0EwRUc7SUFDcUIsVUFBVSxDQUFTO0lBRTNDLHdCQUF3QjtJQUNOLEtBQUssQ0FBUztJQUVoQzs7Ozs7Ozs7T0FRRztJQUNpQyxvQkFBb0IsR0FBRyxJQUFJLFlBQVksRUFBaUIsQ0FBQztJQUU3Rjs7Ozs7Ozs7T0FRRztJQUNpQyxvQkFBb0IsR0FBRyxJQUFJLFlBQVksRUFBaUIsQ0FBQztJQUU3Rjs7Ozs7Ozs7Ozs7T0FXRztJQUNrQixNQUFNLEdBQW9DLElBQUksWUFBWSxFQUFxQixDQUFDO0lBRTdGLFdBQVcsR0FBWSxLQUFLLENBQUM7SUFDN0IsUUFBUSxHQUFlLEVBQUUsQ0FBQztJQUMxQixXQUFXLEdBQWtCLEVBQUUsQ0FBQztJQUNoQyxPQUFPLEdBQWUsRUFBRSxDQUFDO0lBQ3pCLFFBQVEsR0FBZSxFQUFFLENBQUM7SUFDMUIsS0FBSyxHQUFrQixFQUFFLENB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O21CQUFDLDBCQUEwQjtZQVdFLG9CQUFvQjtrQkFBdkQsTUFBTTttQkFBQywwQkFBMEI7WUFjYixNQUFNO2tCQUExQixNQUFNO21CQUFDLFdBQVc7WUFzQlMsVUFBVTtrQkFBckMsS0FBSzttQkFBQyxlQUFlO1lBa0JDLE1BQU07a0JBQTVCLEtBQUs7bUJBQUMsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElucHV0LCBEaXJlY3RpdmUsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IElucHV0Qm9vbGVhbiwgUG9CcmVhZGNydW1iLCBQb1RhYmxlQ29sdW1uU29ydCB9IGZyb20gJ0Bwby11aS9uZy1jb21wb25lbnRzJztcblxuaW1wb3J0IHsgY29udmVydFRvQm9vbGVhbiB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWwnO1xuXG5pbXBvcnQgeyBQb1BhZ2VEeW5hbWljVGFibGVGaWx0ZXJzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3BvLXBhZ2UtZHluYW1pYy10YWJsZS1maWx0ZXJzLmludGVyZmFjZSc7XG5cbkBEaXJlY3RpdmUoKVxuZXhwb3J0IGNsYXNzIFBvUGFnZUR5bmFtaWNMaXN0QmFzZUNvbXBvbmVudCB7XG4gIC8qKiBPYmpldG8gY29tIHByb3ByaWVkYWRlcyBkbyBicmVhZGNydW1iLiAqL1xuICBASW5wdXQoJ3AtYnJlYWRjcnVtYicpIGJyZWFkY3J1bWI/OiBQb0JyZWFkY3J1bWIgPSB7IGl0ZW1zOiBbXSB9O1xuXG4gIC8qKiBFbmRwb2ludCBkYSBBUEkgZG9zIHJlY3Vyc29zIHF1ZSBzZXLDo28gZXhpYmlkb3MuICovXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRW5kcG9pbnQgdXNhZG8gcGVsbyB0ZW1wbGF0ZSBwYXJhIHJlcXVpc2nDp8OjbyBkb3MgcmVjdXJzb3MgcXVlIHNlcsOjbyBleGliaWRvcy5cbiAgICpcbiAgICogQW8gcmVhbGl6YXIgcmVxdWlzacOnw7VlcyBkZSBidXNjYSwgcG9kZW0gc2VyIGVudmlhZG9zIG9zIHBhcsOibWV0cm9zIChjYXNvIHBvc3N1YW0gdmFsb3IpOiBgcGFnZWAsIGBwYWdlU2l6ZWAsIGBzZWFyY2hgIGUgYG9yZGVyYC5cbiAgICpcbiAgICogQ2FzbyBhIGNvbHVuYSBlc3RpdmVyIG9yZGVuYWRhIGRlc2NlbmRlbnRlbWVudGUgc2Vyw6EgZW52aWFkYSBkYSBzZWd1aW50ZSBmb3JtYTogYC1uYW1lYCwgc2UgZm9yIG9yZGVuYWRhXG4gICAqIGFzY2VuZGVudGVtZW50ZSBzZXLDoSBlbnZpYWRhIGFwZW5hcyBjb20gbyBub21lIGRhIGNvbHVuYSwgcG9yIGV4ZW1wbG86IGBuYW1lYC5cbiAgICpcbiAgICogRXhlbXBsbyBkZSB1bWEgcmVxdWlzacOnw6NvIGRlIGJ1c2NhOlxuICAgKlxuICAgKiA+IGBHRVQge2VuZC1wb2ludH0ve3Jlc291cmNlfT9wYWdlPTEmcGFnZVNpemU9MTAmc2VhcmNoPWNvbXBvbmVudHMmb3JkZXI9LW5hbWVgXG4gICAqXG4gICAqIENhc28gYSBhw6fDo28gYHJlbW92ZWAgZXN0aXZlciBjb25maWd1cmFkYSwgc2Vyw6EgZmVpdG8gdW1hIHJlcXVpc2nDp8OjbyBkZSBleGNsdXPDo28gbmVzc2UgbWVzbW8gZW5kcG9pbnQgcGFzc2FuZG8gb3MgY2FtcG9zXG4gICAqIHNldGFkb3MgY29tbyBga2V5OiB0cnVlYC5cbiAgICpcbiAgICogPiBgREVMRVRFIHtlbmQtcG9pbnR9L3trZXlzfWBcbiAgICpcbiAgICogYGBgXG4gICAqICA8cG8tcGFnZS1keW5hbWljLXRhYmxlXG4gICAqICAgIFtwLWFjdGlvbnNdPVwieyByZW1vdmU6IHRydWUgfVwiXG4gICAqICAgIFtwLWZpZWxkc109XCJbIHsgcHJvcGVydHk6ICdpZCcsIGtleTogdHJ1ZSB9IF1cIlxuICAgKiAgICBwLXNlcnZpY2U9XCIvYXBpL3BvLXNhbXBsZXMvdjEvcGVvcGxlXCJcbiAgICogICAgLi4uPlxuICAgKiAgPC9wby1wYWdlLWR5bmFtaWMtdGFibGU+XG4gICAqIGBgYFxuICAgKlxuICAgKiBSZXNxdWlzacOnw6NvIGRpc3BhcmFkYSwgb25kZSBhIHByb3ByaWVkYWRlIGBpZGAgw6kgaWd1YWwgYSAyOlxuICAgKlxuICAgKiBgYGBcbiAgICogIERFTEVURSAvYXBpL3BvLXNhbXBsZXMvdjEvcGVvcGxlLzIgSFRUUC8xLjFcbiAgICogIEhvc3Q6IGxvY2FsaG9zdDo0MDAwXG4gICAqICBDb25uZWN0aW9uOiBrZWVwLWFsaXZlXG4gICAqICBBY2NlcHQ6IGFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW5cbiAgICogIC4uLlxuICAgKiBgYGBcbiAgICpcbiAgICogUGFyYSBhIGHDp8OjbyBgcmVtb3ZlQWxsYCwgc2Vyw6EgZmVpdG8gdW1hIHJlcXVpc2nDp8OjbyBkZSBleGNsdXPDo28gZW0gbG90ZSBwYXJhIGVzc2UgbWVzbW8gZW5kcG9pbnQgcGFzc2FuZG8sIHVtYSBsaXN0YVxuICAgKiBkZSBvYmpldG9zIGNvbSBvcyBjYW1wb3Mgc2V0YWRvcyBjb21vIGBrZXk6IHRydWVgIHZpYSBgcGF5bG9hZGAuXG4gICAqXG4gICAqID4gYERFTEVURSB7ZW5kLXBvaW50fWBcbiAgICpcbiAgICogPiBgUGF5bG9hZDogWyB7a2V5fSwge2tleX0gLi4uIHtrZXl9IF1gXG4gICAqXG4gICAqIGBgYFxuICAgKiAgPHBvLXBhZ2UtZHluYW1pYy10YWJsZVxuICAgKiAgICBbcC1hY3Rpb25zXT1cInsgcmVtb3ZlQWxsOiB0cnVlIH1cIlxuICAgKiAgICBbcC1maWVsZHNdPVwiWyB7IHByb3BlcnR5OiAnaWQnLCBrZXk6IHRydWUgfSBdXCJcbiAgICogICAgcC1zZXJ2aWNlPVwiL2FwaS9wby1zYW1wbGVzL3YxL3Blb3BsZVwiXG4gICAqICAgIC4uLj5cbiAgICogIDwvcG8tcGFnZS1keW5hbWljLXRhYmxlPlxuICAgKiBgYGBcbiAgICpcbiAgICogUmVzcXVpc2nDp8OjbyBkaXNwYXJhZGEsIG9uZGUgZm9yYW0gc2VsZWNpb25hZG9zIDMgaXRlbnMgcGFyYSBzZXJlbSByZW1vdmlkb3M6XG4gICAqXG4gICAqIGBgYFxuICAgKiAgREVMRVRFIC9hcGkvcG8tc2FtcGxlcy92MS9wZW9wbGUgSFRUUC8xLjFcbiAgICogIEhvc3Q6IGxvY2FsaG9zdDo0MDAwXG4gICAqICBDb25uZWN0aW9uOiBrZWVwLWFsaXZlXG4gICAqICBBY2NlcHQ6IGFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW5cbiAgICogIC4uLlxuICAgKiBgYGBcbiAgICpcbiAgICogUmVxdWVzdCBwYXlsb2FkOlxuICAgKlxuICAgKiBgYGBcbiAgICogW3tcImlkXCI6Mn0se1wiaWRcIjo0fSx7XCJpZFwiOjV9XVxuICAgKiBgYGBcbiAgICpcbiAgICogPiBDYXNvIGVzdGVqYSB1c2FuZG8gbWV0YWRhZG9zIGNvbSBvIHRlbXBsYXRlLCBzZXLDoSBkaXNwYXJhZG8gdW1hIHJlcXVpc2nDp8OjbyBuYSBpbmljaWFsaXphw6fDo28gZG8gdGVtcGxhdGUgcGFyYSBidXNjYXJcbiAgICogPiBvcyBtZXRhZGFkb3MgZGEgcMOhZ2luYSBwYXNzYW5kbyBvIHRpcG8gZG8gbWV0YWRhZG8gZXNwZXJhZG8gZSBhIHZlcnPDo28gY2FjaGVhZGEgcGVsbyBicm93c2VyLlxuICAgKiA+XG4gICAqID4gYEdFVCB7ZW5kLXBvaW50fS9tZXRhZGF0YT90eXBlPWxpc3QmdmVyc2lvbj17dmVyc2lvbn1gXG4gICAqL1xuICBASW5wdXQoJ3Atc2VydmljZS1hcGknKSBzZXJ2aWNlQXBpOiBzdHJpbmc7XG5cbiAgLyoqIFTDrXR1bG8gZGEgcMOhZ2luYS4gKi9cbiAgQElucHV0KCdwLXRpdGxlJykgdGl0bGU6IHN0cmluZztcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiBFdmVudG8gZGlzcGFyYWRvIGFvIGZlY2hhciBvIHBvcG92ZXIgZG8gZ2VyZW5jaWFkb3IgZGUgY29sdW5hcyBhcMOzcyBhbHRlcmFyIGFzIGNvbHVuYXMgdmlzw612ZWlzLlxuICAgKlxuICAgKiBPIGNvbXBvbmVudGUgZW52aWEgY29tbyBwYXLDom1ldHJvIHVtIGFycmF5IGRlIHN0cmluZyBjb20gYXMgY29sdW5hcyB2aXPDrXZlaXMgYXR1YWxpemFkYXMuXG4gICAqIFBvciBleGVtcGxvOiBbXCJpZENhcmRcIiwgXCJuYW1lXCIsIFwiaGlyZVN0YXR1c1wiLCBcImFnZVwiXS5cbiAgICovXG4gIEBPdXRwdXQoJ3AtY2hhbmdlLXZpc2libGUtY29sdW1ucycpIGNoYW5nZVZpc2libGVDb2x1bW5zID0gbmV3IEV2ZW50RW1pdHRlcjxBcnJheTxzdHJpbmc+PigpO1xuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIEV2ZW50byBkaXNwYXJhZG8gYW8gY2xpY2FyIG5vIGJvdMOjbyBkZSByZXN0YXVyYXIgcGFkcsOjbyBubyBnZXJlbmNpYWRvciBkZSBjb2x1bmFzLlxuICAgKlxuICAgKiBPIGNvbXBvbmVudGUgZW52aWEgY29tbyBwYXLDom1ldHJvIHVtIGFycmF5IGRlIHN0cmluZyBjb20gYXMgY29sdW5hcyBjb25maWd1cmFkYXMgaW5pY2lhbG1lbnRlLlxuICAgKiBQb3IgZXhlbXBsbzogW1wiaWRDYXJkXCIsIFwibmFtZVwiLCBcImhpcmVTdGF0dXNcIiwgXCJhZ2VcIl0uXG4gICAqL1xuICBAT3V0cHV0KCdwLXJlc3RvcmUtY29sdW1uLW1hbmFnZXInKSBjb2x1bW5SZXN0b3JlTWFuYWdlciA9IG5ldyBFdmVudEVtaXR0ZXI8QXJyYXk8U3RyaW5nPj4oKTtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBFdmVudG8gZXhlY3V0YWRvIGFvIG9yZGVuYXIgY29sdW5hcyBkYSB0YWJlbGEuXG4gICAqXG4gICAqIFJlY2ViZSB1bSBvYmpldG8gYHsgY29sdW1uLCB0eXBlIH1gIG9uZGU6XG4gICAqXG4gICAqIC0gY29sdW1uIChgUG9UYWJsZUNvbHVtbmApOiBvYmpldG8gZGEgY29sdW5hIHF1ZSBmb2kgY2xpY2FkYS9vcmRlbmFkYS5cbiAgICogLSB0eXBlIChgUG9UYWJsZUNvbHVtblNvcnRUeXBlYCk6IHRpcG8gZGEgb3JkZW5hw6fDo28uXG4gICAqL1xuICBAT3V0cHV0KCdwLXNvcnQtYnknKSBzb3J0Qnk6IEV2ZW50RW1pdHRlcjxQb1RhYmxlQ29sdW1uU29ydD4gPSBuZXcgRXZlbnRFbWl0dGVyPFBvVGFibGVDb2x1bW5Tb3J0PigpO1xuXG4gIHByaXZhdGUgX2F1dG9Sb3V0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfY29sdW1uczogQXJyYXk8YW55PiA9IFtdO1xuICBwcml2YXRlIF9kdXBsaWNhdGVzOiBBcnJheTxzdHJpbmc+ID0gW107XG4gIHByaXZhdGUgX2ZpZWxkczogQXJyYXk8YW55PiA9IFtdO1xuICBwcml2YXRlIF9maWx0ZXJzOiBBcnJheTxhbnk+ID0gW107XG4gIHByaXZhdGUgX2tleXM6IEFycmF5PHN0cmluZz4gPSBbXTtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBDcmlhIGF1dG9tYXRpY2FtZW50ZSBhcyByb3RhcyBkZSBlZGnDp8OjbyAobm92by9kdXBsaWNhdGUpIGUgZGV0YWxoZXMgY2FzbyBzZWphbSBkZWZpbmlkYXMgYcOnw7VlcyBuYSBwcm9wcmllZGFkZSBgcC1hY3Rpb25zYFxuICAgKlxuICAgKiBBcyByb3RhcyBjcmlhZGFzIHNlcsOjbyBiYXNlYWRhcyBuYSBwcm9wcmllZGFkZSBgcC1hY3Rpb25zYC5cbiAgICpcbiAgICogPiBQYXJhIG8gY29ycmV0byBmdW5jaW9uYW1lbnRvIG7Do28gcG9kZSBoYXZlciBuZW5odW1hIHJvdGEgY29yaW5nYSAoYCoqYCkgZXNwZWNpZmljYWRhLlxuICAgKlxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgQElucHV0KCdwLWF1dG8tcm91dGVyJykgc2V0IGF1dG9Sb3V0ZXIodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9hdXRvUm91dGVyID0gY29udmVydFRvQm9vbGVhbih2YWx1ZSk7XG4gIH1cblxuICBnZXQgYXV0b1JvdXRlcigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fYXV0b1JvdXRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIExpc3RhIGRvcyBjYW1wb3MgdXNhZG9zIG5hIHRhYmVsYSBlIGJ1c2NhIGF2YW7Dp2FkYS5cbiAgICpcbiAgICpcbiAgICogPiBDYXNvIG7Do28gc2VqYSBkZWZpbmlkbyBmaWVsZHMgYSB0YWJlbGEgYXNzdW1pcsOhIG8gY29tcG9ydGFtZW50byBwYWRyw6NvLlxuICAgKi9cbiAgQElucHV0KCdwLWZpZWxkcycpIHNldCBmaWVsZHMoZmllbGRzOiBBcnJheTxQb1BhZ2VEeW5hbWljVGFibGVGaWx0ZXJzPikge1xuICAgIHRoaXMuX2ZpZWxkcyA9IEFycmF5LmlzQXJyYXkoZmllbGRzKSA/IFsuLi5maWVsZHNdIDogW107XG5cbiAgICB0aGlzLnNldEZpZWxkc1Byb3BlcnRpZXModGhpcy5maWVsZHMpO1xuICB9XG5cbiAgZ2V0IGZpZWxkcygpOiBBcnJheTxQb1BhZ2VEeW5hbWljVGFibGVGaWx0ZXJzPiB7XG4gICAgcmV0dXJuIHRoaXMuX2ZpZWxkcztcbiAgfVxuXG4gIHNldCBjb2x1bW5zKHZhbHVlKSB7XG4gICAgdGhpcy5fY29sdW1ucyA9IFsuLi4odGhpcy5fY29sdW1ucyA9IHRoaXMuc29ydENvbHVtbnNCeU9yZGVyKHZhbHVlKSldO1xuICB9XG5cbiAgZ2V0IGNvbHVtbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbHVtbnM7XG4gIH1cblxuICBzZXQgZHVwbGljYXRlcyh2YWx1ZTogQXJyYXk8c3RyaW5nPikge1xuICAgIHRoaXMuX2R1cGxpY2F0ZXMgPSBbLi4udmFsdWVdO1xuICB9XG5cbiAgZ2V0IGR1cGxpY2F0ZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2R1cGxpY2F0ZXM7XG4gIH1cblxuICBzZXQgZmlsdGVycyh2YWx1ZTogQXJyYXk8UG9QYWdlRHluYW1pY1RhYmxlRmlsdGVycz4pIHtcbiAgICB0aGlzLl9maWx0ZXJzID0gWy4uLnZhbHVlXTtcbiAgfVxuXG4gIGdldCBmaWx0ZXJzKCkge1xuICAgIHJldHVybiB0aGlzLl9maWx0ZXJzO1xuICB9XG5cbiAgc2V0IGtleXModmFsdWU6IEFycmF5PHN0cmluZz4pIHtcbiAgICB0aGlzLl9rZXlzID0gWy4uLnZhbHVlXTtcbiAgfVxuXG4gIGdldCBrZXlzKCkge1xuICAgIHJldHVybiB0aGlzLl9rZXlzO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRGaWVsZHNQcm9wZXJ0aWVzKGZpZWxkczogQXJyYXk8YW55Pikge1xuICAgIGxldCB2aXNpYmxlRmlsdGVyOiBib29sZWFuO1xuICAgIHRoaXMuZmlsdGVycyA9IGZpZWxkc1xuICAgICAgLmZpbHRlcihmaWVsZCA9PiBmaWVsZC5maWx0ZXIgPT09IHRydWUpXG4gICAgICAubWFwKGZpbHRlckZpZWxkID0+IHtcbiAgICAgICAgdmlzaWJsZUZpbHRlciA9ICEoZmlsdGVyRmllbGQuaW5pdFZhbHVlICYmIGZpbHRlckZpZWxkLmZpeGVkKTtcbiAgICAgICAgcmV0dXJuIHsgLi4uZmlsdGVyRmllbGQsIHZpc2libGU6IHZpc2libGVGaWx0ZXIgfTtcbiAgICAgIH0pO1xuICAgIHRoaXMuY29sdW1ucyA9IGZpZWxkcy5maWx0ZXIoXG4gICAgICBmaWVsZCA9PiBmaWVsZC52aXNpYmxlID09PSB1bmRlZmluZWQgfHwgZmllbGQudmlzaWJsZSA9PT0gdHJ1ZSB8fCBmaWVsZC5hbGxvd0NvbHVtbnNNYW5hZ2VyID09PSB0cnVlXG4gICAgKTtcbiAgICB0aGlzLmtleXMgPSBmaWVsZHMuZmlsdGVyKGZpZWxkID0+IGZpZWxkLmtleSA9PT0gdHJ1ZSkubWFwKGZpZWxkID0+IGZpZWxkLnByb3BlcnR5KTtcbiAgICB0aGlzLmR1cGxpY2F0ZXMgPSBmaWVsZHMuZmlsdGVyKGZpZWxkID0+IGZpZWxkLmR1cGxpY2F0ZSA9PT0gdHJ1ZSkubWFwKGZpZWxkID0+IGZpZWxkLnByb3BlcnR5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcmRlbmEgdW0gYXJyYXkgZGUgY29sdW5hcyBjb20gYmFzZSBuYSBwcm9wcmllZGFkZSBgb3JkZXJgIGRlIGNhZGEgY29sdW5hLlxuICAgKlxuICAgKiBFc3RlIG3DqXRvZG8gw6kgdXRpbGl6YWRvIHBhcmEgb3JnYW5pemFyIGFzIGNvbHVuYXMgZGUgdW1hIHRhYmVsYSBvdSBxdWFscXVlciBjb2xlw6fDo28gc2ltaWxhclxuICAgKiBxdWUgbmVjZXNzaXRlIGRlIG9yZGVuYcOnw6NvIGJhc2VhZGEgZW0gdW0gY3JpdMOpcmlvIG51bcOpcmljbyBkZWZpbmlkbyBwZWxhIHByb3ByaWVkYWRlIGBvcmRlcmAuXG4gICAqIEEgb3JkZW5hw6fDo28gc2VndWUgYXMgc2VndWludGVzIHJlZ3JhczpcbiAgICpcbiAgICogMS4gQ29sdW5hcyBxdWUgcG9zc3VlbSBhIHByb3ByaWVkYWRlIGBvcmRlcmAgY29tIHVtIHZhbG9yIG51bcOpcmljbyB2w6FsaWRvIGUgbWFpb3IgcXVlIHplcm9cbiAgICogICAgc8OjbyBvcmRlbmFkYXMgZW0gb3JkZW0gY3Jlc2NlbnRlIGRlIGFjb3JkbyBjb20gZXN0ZSB2YWxvci5cbiAgICpcbiAgICogMi4gQ29sdW5hcyBxdWUgbsOjbyBwb3NzdWVtIGEgcHJvcHJpZWRhZGUgYG9yZGVyYCBvdSBxdWUgcG9zc3VlbSB1bSB2YWxvciBpbnbDoWxpZG8gb3UgbsOjbyBudW3DqXJpY29cbiAgICogICAgcGFyYSBlc3RhIHByb3ByaWVkYWRlIHPDo28gY29uc2lkZXJhZGFzIGlndWFpcyBlbSB0ZXJtb3MgZGUgb3JkZW5hw6fDo28gZSBtYW50w6ptIGEgb3JkZW0gb3JpZ2luYWxcbiAgICogICAgZW0gcXVlIGFwYXJlY2VyYW0gbm8gYXJyYXkgZm9ybmVjaWRvLlxuICAgKlxuICAgKiAzLiBObyBjYXNvIGRlIGR1YXMgY29sdW5hcyBjb20gdmFsb3JlcyBkZSBgb3JkZXJgIHbDoWxpZG9zIGUgaWTDqm50aWNvcywgYSBvcmRlbSBlbnRyZSBlc3NhcyBkdWFzIGNvbHVuYXNcbiAgICogICAgw6kgZGV0ZXJtaW5hZGEgcGVsYSBzdWEgb3JkZW0gb3JpZ2luYWwgbm8gYXJyYXkgZm9ybmVjaWRvLlxuICAgKlxuICAgKiBAcGFyYW0gY29sdW1ucyBBcnJheSBkZSBjb2x1bmFzIGEgc2VyIG9yZGVuYWRvLiBDYWRhIGNvbHVuYSDDqSB1bSBvYmpldG8gcXVlIHBvZGUgY29udGVyIHVtYSBwcm9wcmllZGFkZSBgb3JkZXJgLlxuICAgKiAgICAgICAgICAgICAgICBPIHRpcG8gYEFycmF5PGFueT5gIMOpIHV0aWxpemFkbyBhcXVpIHBhcmEgcGVybWl0aXIgZmxleGliaWxpZGFkZSBub3Mgb2JqZXRvcyBkZSBjb2x1bmEgcXVlIHBvZGVtIHNlciBwYXNzYWRvcyxcbiAgICogICAgICAgICAgICAgICAgbWFzIGVzcGVyYS1zZSBxdWUgY2FkYSBvYmpldG8gdGVuaGEgcGVsbyBtZW5vcyB1bWEgcHJvcHJpZWRhZGUgYG9yZGVyYCBwYXJhIGEgb3JkZW5hw6fDo28gYWRlcXVhZGEuXG4gICAqXG4gICAqIEByZXR1cm5zIFVtIG5vdm8gYXJyYXkgZGUgY29sdW5hcyBvcmRlbmFkbyBjb20gYmFzZSBuYSBwcm9wcmllZGFkZSBgb3JkZXJgLlxuICAgKi9cbiAgcHJpdmF0ZSBzb3J0Q29sdW1uc0J5T3JkZXIoY29sdW1uczogQXJyYXk8YW55Pik6IEFycmF5PGFueT4ge1xuICAgIHJldHVybiBjb2x1bW5zLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIC8vIENoZWNhIHNlICdvcmRlcicgZXhpc3RlIGUgw6kgdW0gbsO6bWVybyB2w6FsaWRvIGVtIGFtYm9zIG9zIG9iamV0b3NcbiAgICAgIGNvbnN0IGhhc1ZhbGlkT3JkZXJBID0gJ29yZGVyJyBpbiBhICYmIHR5cGVvZiBhLm9yZGVyID09PSAnbnVtYmVyJyAmJiBhLm9yZGVyID4gMDtcbiAgICAgIGNvbnN0IGhhc1ZhbGlkT3JkZXJCID0gJ29yZGVyJyBpbiBiICYmIHR5cGVvZiBiLm9yZGVyID09PSAnbnVtYmVyJyAmJiBiLm9yZGVyID4gMDtcblxuICAgICAgLy8gU2UgYW1ib3MgdMOqbSAnb3JkZXInIHbDoWxpZG8sIGNvbXBhcmEgZGlyZXRhbWVudGVcbiAgICAgIGlmIChoYXNWYWxpZE9yZGVyQSAmJiBoYXNWYWxpZE9yZGVyQikge1xuICAgICAgICByZXR1cm4gYS5vcmRlciAtIGIub3JkZXI7XG4gICAgICB9XG5cbiAgICAgIC8vIFNlIGFwZW5hcyBBIHRlbSAnb3JkZXInIHbDoWxpZG8sIEEgdmVtIGFudGVzIGRlIEJcbiAgICAgIGlmIChoYXNWYWxpZE9yZGVyQSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9XG5cbiAgICAgIC8vIFNlIGFwZW5hcyBCIHRlbSAnb3JkZXInIHbDoWxpZG8sIEIgdmVtIGFudGVzIGRlIEFcbiAgICAgIGlmIChoYXNWYWxpZE9yZGVyQikge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cblxuICAgICAgLy8gU2UgbmVuaHVtIGRvcyBkb2lzIHRlbSAnb3JkZXInIHbDoWxpZG8sIG1hbnTDqW0gYSBvcmRlbSBvcmlnaW5hbCAoY29uc2lkZXJhbmRvIGNvbW8gaWd1YWlzIG5lc3RlIGNvbnRleHRvKVxuICAgICAgcmV0dXJuIDA7XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==