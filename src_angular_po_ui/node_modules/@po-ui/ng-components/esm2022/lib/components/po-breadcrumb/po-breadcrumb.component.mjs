import { Component, ElementRef, ViewChild } from '@angular/core';
import { PoBreadcrumbBaseComponent } from './po-breadcrumb-base.component';
import * as i0 from "@angular/core";
import * as i1 from "../../services/po-language/po-language.service";
import * as i2 from "@angular/common";
import * as i3 from "../po-link/po-link.component";
import * as i4 from "../po-popup/po-popup.component";
import * as i5 from "../po-icon/po-icon.component";
import * as i6 from "./po-breadcrumb-favorite/po-breadcrumb-favorite.component";
const _c0 = ["breadcrumb"];
const _c1 = ["dropdownIcon"];
const _c2 = ["target"];
const _c3 = ["popup"];
function PoBreadcrumbComponent_ul_3_Template(rf, ctx) { if (rf & 1) {
    const _r8 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "ul", 6, 7)(2, "li")(3, "po-link", 8);
    i0.ɵɵlistener("p-action", function PoBreadcrumbComponent_ul_3_Template_po_link_p_action_3_listener() { i0.ɵɵrestoreView(_r8); const ctx_r7 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r7.emitAction(ctx_r7.itemsView[0])); });
    i0.ɵɵelementEnd()();
    i0.ɵɵelement(4, "po-icon", 9);
    i0.ɵɵelementStart(5, "li", 10, 11);
    i0.ɵɵlistener("click", function PoBreadcrumbComponent_ul_3_Template_li_click_5_listener() { i0.ɵɵrestoreView(_r8); const _r6 = i0.ɵɵreference(16); return i0.ɵɵresetView(_r6.toggle()); })("keyup", function PoBreadcrumbComponent_ul_3_Template_li_keyup_5_listener($event) { i0.ɵɵrestoreView(_r8); const ctx_r10 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r10.openPopup($event)); });
    i0.ɵɵelement(7, "po-icon", 12);
    i0.ɵɵelementEnd();
    i0.ɵɵelement(8, "po-icon", 9);
    i0.ɵɵelementStart(9, "li")(10, "po-link", 8);
    i0.ɵɵlistener("p-action", function PoBreadcrumbComponent_ul_3_Template_po_link_p_action_10_listener() { i0.ɵɵrestoreView(_r8); const ctx_r11 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r11.emitAction(ctx_r11.itemsView[ctx_r11.itemsView.length - 2])); });
    i0.ɵɵelementEnd()();
    i0.ɵɵelement(11, "po-icon", 9);
    i0.ɵɵelementStart(12, "li")(13, "span", 13);
    i0.ɵɵtext(14);
    i0.ɵɵelementEnd()();
    i0.ɵɵelementStart(15, "po-popup", 14, 15);
    i0.ɵɵlistener("p-close", function PoBreadcrumbComponent_ul_3_Template_po_popup_p_close_15_listener() { i0.ɵɵrestoreView(_r8); const ctx_r12 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r12.closePopUp()); });
    i0.ɵɵelementEnd()();
} if (rf & 2) {
    const _r5 = i0.ɵɵreference(6);
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(3);
    i0.ɵɵproperty("p-label", ctx_r1.itemsView[0].label)("p-url", ctx_r1.itemsView[0].link);
    i0.ɵɵadvance(2);
    i0.ɵɵattribute("aria-label", ctx_r1.literals.literalButtonPopup);
    i0.ɵɵadvance(5);
    i0.ɵɵproperty("p-label", ctx_r1.itemsView[ctx_r1.itemsView.length - 2].label)("p-url", ctx_r1.itemsView[ctx_r1.itemsView.length - 2].link);
    i0.ɵɵadvance(3);
    i0.ɵɵattribute("aria-current", ctx_r1.itemsView[ctx_r1.itemsView.length - 1].label);
    i0.ɵɵadvance();
    i0.ɵɵtextInterpolate(ctx_r1.itemsView[ctx_r1.itemsView.length - 1].label);
    i0.ɵɵadvance();
    i0.ɵɵproperty("p-hide-arrow", true)("p-actions", ctx_r1.itemsViewPopup)("p-target", _r5);
} }
function PoBreadcrumbComponent_ul_4_li_1_po_link_1_Template(rf, ctx) { if (rf & 1) {
    const _r21 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "po-link", 8);
    i0.ɵɵlistener("p-action", function PoBreadcrumbComponent_ul_4_li_1_po_link_1_Template_po_link_p_action_0_listener() { i0.ɵɵrestoreView(_r21); const item_r14 = i0.ɵɵnextContext().$implicit; const ctx_r19 = i0.ɵɵnextContext(2); return i0.ɵɵresetView(ctx_r19.emitAction(item_r14)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r14 = i0.ɵɵnextContext().$implicit;
    i0.ɵɵproperty("p-label", item_r14.label)("p-url", item_r14.link);
} }
function PoBreadcrumbComponent_ul_4_li_1_span_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 13);
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r14 = i0.ɵɵnextContext().$implicit;
    i0.ɵɵattribute("aria-current", item_r14.label);
    i0.ɵɵadvance();
    i0.ɵɵtextInterpolate(item_r14.label);
} }
function PoBreadcrumbComponent_ul_4_li_1_po_icon_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "po-icon", 9);
} }
function PoBreadcrumbComponent_ul_4_li_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "li", 18);
    i0.ɵɵtemplate(1, PoBreadcrumbComponent_ul_4_li_1_po_link_1_Template, 1, 2, "po-link", 19)(2, PoBreadcrumbComponent_ul_4_li_1_span_2_Template, 2, 2, "span", 20)(3, PoBreadcrumbComponent_ul_4_li_1_po_icon_3_Template, 1, 0, "po-icon", 21);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const itemIndex_r15 = ctx.index;
    const ctx_r13 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngIf", !(itemIndex_r15 === ctx_r13.itemsView.length - 1));
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngIf", itemIndex_r15 === ctx_r13.itemsView.length - 1);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngIf", !(itemIndex_r15 === ctx_r13.itemsView.length - 1));
} }
function PoBreadcrumbComponent_ul_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "ul", 16);
    i0.ɵɵtemplate(1, PoBreadcrumbComponent_ul_4_li_1_Template, 4, 3, "li", 17);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngForOf", ctx_r2.itemsView);
} }
function PoBreadcrumbComponent_po_breadcrumb_favorite_5_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "po-breadcrumb-favorite", 22);
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-favorite-service", ctx_r3.favoriteService)("p-item-active", ctx_r3.items[ctx_r3.items.length - 1])("p-params-service", ctx_r3.paramsService)("p-hidden-literal", ctx_r3.hiddenLiteralFavorite);
} }
export const poBreadcrumbLiterals = {
    en: {
        literalButtonPopup: 'Menu pop up collapsed'
    },
    es: {
        literalButtonPopup: 'Menú pop up colapsado'
    },
    pt: {
        literalButtonPopup: 'Menu pop up colapsado'
    },
    ru: {
        literalButtonPopup: 'меню свернуто'
    }
};
/**
 * @docsExtends PoBreadcrumbBaseComponent
 *
 * @example
 *
 * <example name="po-breadcrumb-basic" title="PO Breadcrumb Basic">
 *  <file name="sample-po-breadcrumb-basic/sample-po-breadcrumb-basic.component.html"> </file>
 *  <file name="sample-po-breadcrumb-basic/sample-po-breadcrumb-basic.component.ts"> </file>
 * </example>
 *
 * <example name="po-breadcrumb-labs" title="PO Breadcrumb Labs">
 *  <file name="sample-po-breadcrumb-labs/sample-po-breadcrumb-labs.component.html"> </file>
 *  <file name="sample-po-breadcrumb-labs/sample-po-breadcrumb-labs.component.ts"> </file>
 * </example>
 */
export class PoBreadcrumbComponent extends PoBreadcrumbBaseComponent {
    element;
    renderer;
    languageService;
    breadcrumbElement;
    dropdownIcon;
    svgTarget;
    popupContainer;
    showDropdown = false;
    showDropdownToggle = false;
    dropdownItems;
    literals;
    hiddenLiteralFavorite = false;
    _breadcrumbItemsLenght = 0;
    calculatedElement = false;
    differ;
    hiddenWithoutResize = false;
    initialized = false;
    timeoutResize;
    constructor(differs, element, renderer, languageService) {
        super();
        this.element = element;
        this.renderer = renderer;
        this.languageService = languageService;
        this.differ = differs.find([]).create(null);
        const language = languageService.getShortLanguage();
        this.literals = {
            ...poBreadcrumbLiterals[language]
        };
    }
    ngAfterViewInit() {
        this.initialized = true;
        this.initializeResizeListener();
    }
    ngDoCheck() {
        const breadcrumbWidth = this.breadcrumbElement.nativeElement.offsetWidth;
        // Permite que os disclaimers sejam calculados na primeira vez que o componente torna-se visível,
        // evitando com isso, problemas com Tabs ou Divs que iniciem escondidas.
        if (breadcrumbWidth && !this.calculatedElement && this.initialized) {
            this.initBreadcrumbSize();
        }
        if (this.hiddenWithoutResize) {
            this.debounceResize();
            this.hiddenWithoutResize = false;
        }
        this.checkChangeOnItems();
    }
    ngOnDestroy() {
        this.removeResizeListener();
    }
    emitAction(item) {
        if (item.action) {
            item.action();
        }
    }
    openPopup(event) {
        if (event.code === 'Enter' || event.code === 'Space') {
            this.popupContainer.open();
        }
    }
    closePopUp() {
        this.svgTarget.nativeElement.focus();
    }
    checkChangeOnItems() {
        if (this.differ) {
            const changes = this.differ.diff(this.items);
            if (changes) {
                this.calcBreadcrumbItemsWidth();
                this.calculatedElement = false;
            }
        }
    }
    calcBreadcrumb() {
        const breadcrumbFavorite = this.getBreadcrumbFavoriteWidth();
        const existLabel = this.existsFavoritelabel();
        const breadcrumb = this.getBreadcrumbWidth(breadcrumbFavorite, existLabel);
        const breadcrumbTooltip = this.getBreadcrumbTooltipWidth();
        if (breadcrumb <= this._breadcrumbItemsLenght) {
            this.enableBreadcrumbResponsive();
        }
        else {
            this.disableBreadcrumbResponsive();
        }
        if (breadcrumbTooltip && breadcrumb <= breadcrumbTooltip) {
            this.hiddenLiteralFavorite = true;
        }
        else {
            this.hiddenLiteralFavorite = false;
        }
    }
    getBreadcrumbFavoriteWidth() {
        return this.favoriteService
            ? this.element.nativeElement.querySelector('.po-breadcrumb-favorite').offsetWidth + 20
            : 0;
    }
    getBreadcrumbTooltipWidth() {
        return this.favoriteService ? this.element.nativeElement.querySelector('.po-breadcrumb-tooltip')?.offsetWidth : 0;
    }
    existsFavoritelabel() {
        return !!this.element.nativeElement.querySelector('.po-breadcrumb-favorite-label');
    }
    getBreadcrumbWidth(breadcrumbFavorite, existLabel) {
        const widthSpan = !existLabel ? 95 : 0;
        return this.element.nativeElement.querySelector('.po-breadcrumb').offsetWidth - (breadcrumbFavorite + widthSpan);
    }
    calcBreadcrumbItemsWidth() {
        const breadcrumbItem = this.element.nativeElement.querySelectorAll('.po-breadcrumb-item');
        this._breadcrumbItemsLenght = Array.from(breadcrumbItem)
            .map(breadcrumb => breadcrumb['offsetWidth'])
            .reduce((a, b) => a + b, 16);
    }
    enableBreadcrumbResponsive() {
        this.showDropdownToggle = true;
    }
    disableBreadcrumbResponsive() {
        this.showDropdownToggle = false;
        this.itemsView = [].concat(this.items);
        this.showDropdown = false;
    }
    debounceResize() {
        clearTimeout(this.timeoutResize);
        this.timeoutResize = setTimeout(() => {
            if (this.calculatedElement &&
                !this.hiddenWithoutResize &&
                this.breadcrumbElement.nativeElement.offsetWidth === 0) {
                this.hiddenWithoutResize = true;
            }
            else {
                this.calcBreadcrumb();
            }
        }, 50);
    }
    initBreadcrumbSize() {
        this.calcBreadcrumbItemsWidth();
        this.calcBreadcrumb();
        this.calculatedElement = true;
    }
    initializeResizeListener() {
        this.resizeListener = this.renderer.listen('window', 'resize', (event) => {
            this.debounceResize();
        });
    }
    removeResizeListener() {
        this.resizeListener();
    }
    static ɵfac = function PoBreadcrumbComponent_Factory(t) { return new (t || PoBreadcrumbComponent)(i0.ɵɵdirectiveInject(i0.IterableDiffers), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i1.PoLanguageService)); };
    static ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PoBreadcrumbComponent, selectors: [["po-breadcrumb"]], viewQuery: function PoBreadcrumbComponent_Query(rf, ctx) { if (rf & 1) {
            i0.ɵɵviewQuery(_c0, 7, ElementRef);
            i0.ɵɵviewQuery(_c1, 5, ElementRef);
            i0.ɵɵviewQuery(_c2, 5, ElementRef);
            i0.ɵɵviewQuery(_c3, 5);
        } if (rf & 2) {
            let _t;
            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.breadcrumbElement = _t.first);
            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dropdownIcon = _t.first);
            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.svgTarget = _t.first);
            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.popupContainer = _t.first);
        } }, features: [i0.ɵɵInheritDefinitionFeature], decls: 6, vars: 3, consts: [[1, "po-breadcrumb"], ["breadcrumb", ""], [1, "po-breadcrumb-items"], ["class", "po-breadcrumb-item po-clickable po-breadcrumb-tooltip", 4, "ngIf"], ["class", "po-breadcrumb-item-container", 4, "ngIf"], [3, "p-favorite-service", "p-item-active", "p-params-service", "p-hidden-literal", 4, "ngIf"], [1, "po-breadcrumb-item", "po-clickable", "po-breadcrumb-tooltip"], ["dropdownIcon", ""], [3, "p-label", "p-url", "p-action"], ["p-icon", "ICON_ARROW_RIGHT po-breadcrumb-icon-arrow"], ["role", "button", "tabindex", "0", 1, "po-breadcrumb-icon-more", 3, "click", "keyup"], ["target", ""], ["p-icon", "ICON_MORE_VERT"], ["role", "link", "tabindex", "0", 1, "po-breadcrumb-item-activate"], ["p-position", "bottom-right", 3, "p-hide-arrow", "p-actions", "p-target", "p-close"], ["popup", ""], [1, "po-breadcrumb-item-container"], ["class", "po-breadcrumb-item", 4, "ngFor", "ngForOf"], [1, "po-breadcrumb-item"], [3, "p-label", "p-url", "p-action", 4, "ngIf"], ["class", "po-breadcrumb-item-activate", "role", "link", "tabindex", "0", 4, "ngIf"], ["p-icon", "ICON_ARROW_RIGHT po-breadcrumb-icon-arrow", 4, "ngIf"], [3, "p-favorite-service", "p-item-active", "p-params-service", "p-hidden-literal"]], template: function PoBreadcrumbComponent_Template(rf, ctx) { if (rf & 1) {
            i0.ɵɵelementStart(0, "nav", 0, 1)(2, "div", 2);
            i0.ɵɵtemplate(3, PoBreadcrumbComponent_ul_3_Template, 17, 10, "ul", 3)(4, PoBreadcrumbComponent_ul_4_Template, 2, 1, "ul", 4);
            i0.ɵɵelementEnd();
            i0.ɵɵtemplate(5, PoBreadcrumbComponent_po_breadcrumb_favorite_5_Template, 1, 4, "po-breadcrumb-favorite", 5);
            i0.ɵɵelementEnd();
        } if (rf & 2) {
            i0.ɵɵadvance(3);
            i0.ɵɵproperty("ngIf", ctx.showDropdownToggle && ctx.itemsView.length >= 4);
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", !ctx.showDropdownToggle || ctx.itemsView.length < 4);
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.favoriteService);
        } }, dependencies: [i2.NgForOf, i2.NgIf, i3.PoLinkComponent, i4.PoPopupComponent, i5.PoIconComponent, i6.PoBreadcrumbFavoriteComponent], encapsulation: 2 });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoBreadcrumbComponent, [{
        type: Component,
        args: [{ selector: 'po-breadcrumb', template: "<nav class=\"po-breadcrumb\" #breadcrumb>\n  <div class=\"po-breadcrumb-items\">\n    <ul\n      #dropdownIcon\n      *ngIf=\"showDropdownToggle && itemsView.length >= 4\"\n      class=\"po-breadcrumb-item po-clickable po-breadcrumb-tooltip\"\n    >\n      <li>\n        <po-link\n          [p-label]=\"itemsView[0].label\"\n          [p-url]=\"itemsView[0].link\"\n          (p-action)=\"emitAction(itemsView[0])\"\n        ></po-link>\n      </li>\n\n      <po-icon p-icon=\"ICON_ARROW_RIGHT po-breadcrumb-icon-arrow\"></po-icon>\n\n      <li\n        #target\n        class=\"po-breadcrumb-icon-more\"\n        [attr.aria-label]=\"literals.literalButtonPopup\"\n        role=\"button\"\n        tabindex=\"0\"\n        (click)=\"popup.toggle()\"\n        (keyup)=\"openPopup($event)\"\n      >\n        <po-icon p-icon=\"ICON_MORE_VERT\"></po-icon>\n      </li>\n      <po-icon p-icon=\"ICON_ARROW_RIGHT po-breadcrumb-icon-arrow\"></po-icon>\n\n      <li>\n        <po-link\n          [p-label]=\"itemsView[itemsView.length - 2].label\"\n          [p-url]=\"itemsView[itemsView.length - 2].link\"\n          (p-action)=\"emitAction(itemsView[itemsView.length - 2])\"\n        ></po-link>\n      </li>\n      <po-icon p-icon=\"ICON_ARROW_RIGHT po-breadcrumb-icon-arrow\"></po-icon>\n\n      <li>\n        <span\n          class=\"po-breadcrumb-item-activate\"\n          role=\"link\"\n          tabindex=\"0\"\n          [attr.aria-current]=\"itemsView[itemsView.length - 1].label\"\n          >{{ itemsView[itemsView.length - 1].label }}</span\n        >\n      </li>\n      <po-popup\n        #popup\n        p-position=\"bottom-right\"\n        (p-close)=\"closePopUp()\"\n        [p-hide-arrow]=\"true\"\n        [p-actions]=\"itemsViewPopup\"\n        [p-target]=\"target\"\n      >\n      </po-popup>\n    </ul>\n\n    <ul *ngIf=\"!showDropdownToggle || itemsView.length < 4\" class=\"po-breadcrumb-item-container\">\n      <li *ngFor=\"let item of itemsView; let itemIndex = index\" class=\"po-breadcrumb-item\">\n        <po-link\n          *ngIf=\"!(itemIndex === itemsView.length - 1)\"\n          [p-label]=\"item.label\"\n          [p-url]=\"item.link\"\n          (p-action)=\"emitAction(item)\"\n        ></po-link>\n        <span\n          class=\"po-breadcrumb-item-activate\"\n          role=\"link\"\n          tabindex=\"0\"\n          *ngIf=\"itemIndex === itemsView.length - 1\"\n          [attr.aria-current]=\"item.label\"\n          >{{ item.label }}</span\n        >\n        <po-icon\n          *ngIf=\"!(itemIndex === itemsView.length - 1)\"\n          p-icon=\"ICON_ARROW_RIGHT po-breadcrumb-icon-arrow\"\n        ></po-icon>\n      </li>\n    </ul>\n  </div>\n\n  <po-breadcrumb-favorite\n    *ngIf=\"favoriteService\"\n    [p-favorite-service]=\"favoriteService\"\n    [p-item-active]=\"items[items.length - 1]\"\n    [p-params-service]=\"paramsService\"\n    [p-hidden-literal]=\"hiddenLiteralFavorite\"\n  >\n  </po-breadcrumb-favorite>\n</nav>\n" }]
    }], () => [{ type: i0.IterableDiffers }, { type: i0.ElementRef }, { type: i0.Renderer2 }, { type: i1.PoLanguageService }], { breadcrumbElement: [{
            type: ViewChild,
            args: ['breadcrumb', { read: ElementRef, static: true }]
        }], dropdownIcon: [{
            type: ViewChild,
            args: ['dropdownIcon', { read: ElementRef }]
        }], svgTarget: [{
            type: ViewChild,
            args: ['target', { read: ElementRef }]
        }], popupContainer: [{
            type: ViewChild,
            args: ['popup']
        }] }); })();
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassDebugInfo(PoBreadcrumbComponent, { className: "PoBreadcrumbComponent", filePath: "lib/components/po-breadcrumb/po-breadcrumb.component.ts", lineNumber: 51 }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tYnJlYWRjcnVtYi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy91aS9zcmMvbGliL2NvbXBvbmVudHMvcG8tYnJlYWRjcnVtYi9wby1icmVhZGNydW1iLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpL3NyYy9saWIvY29tcG9uZW50cy9wby1icmVhZGNydW1iL3BvLWJyZWFkY3J1bWIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLFNBQVMsRUFFVCxVQUFVLEVBSVYsU0FBUyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDOzs7Ozs7Ozs7Ozs7OztJQ1R2RSxnQ0FJQyxTQUFBLGlCQUFBO0lBS0ssd0tBQVksZUFBQSxtQ0FBcUIsQ0FBQyxFQUFFLENBQUEsSUFBQztJQUN0QyxpQkFBVSxFQUFBO0lBR2IsNkJBQXNFO0lBRXRFLGtDQVFDO0lBRkMsMEpBQVMsZUFBQSxZQUFjLENBQUEsSUFBQyx1SkFDZixlQUFBLHlCQUFpQixDQUFBLElBREY7SUFHeEIsOEJBQTJDO0lBQzdDLGlCQUFLO0lBQ0wsNkJBQXNFO0lBRXRFLDBCQUFJLGtCQUFBO0lBSUEsMEtBQVksZUFBQSxnRUFBd0MsQ0FBQyxFQUFFLENBQUEsSUFBQztJQUN6RCxpQkFBVSxFQUFBO0lBRWIsOEJBQXNFO0lBRXRFLDJCQUFJLGdCQUFBO0lBTUMsYUFBMkM7SUFBQSxpQkFDN0MsRUFBQTtJQUVILHlDQU9DO0lBSkMseUtBQVcsZUFBQSxvQkFBWSxDQUFBLElBQUM7SUFLMUIsaUJBQVcsRUFBQTs7OztJQS9DUCxlQUE4QjtJQUE5QixtREFBOEIsbUNBQUE7SUFXaEMsZUFBK0M7SUFBL0MsZ0VBQStDO0lBWTdDLGVBQWlEO0lBQWpELDZFQUFpRCw2REFBQTtJQVlqRCxl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Tzs7a0ZBSlAscUJBQXFCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ29tcG9uZW50LFxuICBEb0NoZWNrLFxuICBFbGVtZW50UmVmLFxuICBJdGVyYWJsZURpZmZlcnMsXG4gIE9uRGVzdHJveSxcbiAgUmVuZGVyZXIyLFxuICBWaWV3Q2hpbGRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IFBvQnJlYWRjcnVtYkJhc2VDb21wb25lbnQgfSBmcm9tICcuL3BvLWJyZWFkY3J1bWItYmFzZS5jb21wb25lbnQnO1xuaW1wb3J0IHsgUG9CcmVhZGNydW1iSXRlbSB9IGZyb20gJy4vcG8tYnJlYWRjcnVtYi1pdGVtLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb1BvcHVwQ29tcG9uZW50IH0gZnJvbSAnLi4vcG8tcG9wdXAvcG8tcG9wdXAuY29tcG9uZW50JztcbmltcG9ydCB7IFBvTGFuZ3VhZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcG8tbGFuZ3VhZ2UvcG8tbGFuZ3VhZ2Uuc2VydmljZSc7XG5cbmV4cG9ydCBjb25zdCBwb0JyZWFkY3J1bWJMaXRlcmFsczogT2JqZWN0ID0ge1xuICBlbjogPGFueT57XG4gICAgbGl0ZXJhbEJ1dHRvblBvcHVwOiAnTWVudSBwb3AgdXAgY29sbGFwc2VkJ1xuICB9LFxuICBlczogPGFueT57XG4gICAgbGl0ZXJhbEJ1dHRvblBvcHVwOiAnTWVuw7ogcG9wIHVwIGNvbGFwc2FkbydcbiAgfSxcbiAgcHQ6IDxhbnk+e1xuICAgIGxpdGVyYWxCdXR0b25Qb3B1cDogJ01lbnUgcG9wIHVwIGNvbGFwc2FkbydcbiAgfSxcbiAgcnU6IDxhbnk+e1xuICAgIGxpdGVyYWxCdXR0b25Qb3B1cDogJ9C80LXQvdGOINGB0LLQtdGA0L3Rg9GC0L4nXG4gIH1cbn07XG5cbi8qKlxuICogQGRvY3NFeHRlbmRzIFBvQnJlYWRjcnVtYkJhc2VDb21wb25lbnRcbiAqXG4gKiBAZXhhbXBsZVxuICpcbiAqIDxleGFtcGxlIG5hbWU9XCJwby1icmVhZGNydW1iLWJhc2ljXCIgdGl0bGU9XCJQTyBCcmVhZGNydW1iIEJhc2ljXCI+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS1wby1icmVhZGNydW1iLWJhc2ljL3NhbXBsZS1wby1icmVhZGNydW1iLWJhc2ljLmNvbXBvbmVudC5odG1sXCI+IDwvZmlsZT5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLWJyZWFkY3J1bWItYmFzaWMvc2FtcGxlLXBvLWJyZWFkY3J1bWItYmFzaWMuY29tcG9uZW50LnRzXCI+IDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwicG8tYnJlYWRjcnVtYi1sYWJzXCIgdGl0bGU9XCJQTyBCcmVhZGNydW1iIExhYnNcIj5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLWJyZWFkY3J1bWItbGFicy9zYW1wbGUtcG8tYnJlYWRjcnVtYi1sYWJzLmNvbXBvbmVudC5odG1sXCI+IDwvZmlsZT5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLWJyZWFkY3J1bWItbGFicy9zYW1wbGUtcG8tYnJlYWRjcnVtYi1sYWJzLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3BvLWJyZWFkY3J1bWInLFxuICB0ZW1wbGF0ZVVybDogJy4vcG8tYnJlYWRjcnVtYi5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgUG9CcmVhZGNydW1iQ29tcG9uZW50IGV4dGVuZHMgUG9CcmVhZGNydW1iQmFzZUNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIERvQ2hlY2ssIE9uRGVzdHJveSB7XG4gIEBWaWV3Q2hpbGQoJ2JyZWFkY3J1bWInLCB7IHJlYWQ6IEVsZW1lbnRSZWYsIHN0YXRpYzogdHJ1ZSB9KSBicmVhZGNydW1iRWxlbWVudDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnZHJvcGRvd25JY29uJywgeyByZWFkOiBFbGVtZW50UmVmIH0pIGRyb3Bkb3duSWNvbjogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgndGFyZ2V0JywgeyByZWFkOiBFbGVtZW50UmVmIH0pIHN2Z1RhcmdldDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgncG9wdXAnKSBwb3B1cENvbnRhaW5lcjogUG9Qb3B1cENvbXBvbmVudDtcblxuICBzaG93RHJvcGRvd246IGJvb2xlYW4gPSBmYWxzZTtcbiAgc2hvd0Ryb3Bkb3duVG9nZ2xlOiBib29sZWFuID0gZmFsc2U7XG4gIGRyb3Bkb3duSXRlbXM6IEFycmF5PFBvQnJlYWRjcnVtYkl0ZW0+O1xuICBsaXRlcmFscztcbiAgaGlkZGVuTGl0ZXJhbEZhdm9yaXRlID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfYnJlYWRjcnVtYkl0ZW1zTGVuZ2h0OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGNhbGN1bGF0ZWRFbGVtZW50ID0gZmFsc2U7XG4gIHByaXZhdGUgZGlmZmVyO1xuICBwcml2YXRlIGhpZGRlbldpdGhvdXRSZXNpemUgPSBmYWxzZTtcbiAgcHJpdmF0ZSBpbml0aWFsaXplZCA9IGZhbHNlO1xuICBwcml2YXRlIHRpbWVvdXRSZXNpemU7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgZGlmZmVyczogSXRlcmFibGVEaWZmZXJzLFxuICAgIHByaXZhdGUgZWxlbWVudDogRWxlbWVudFJlZixcbiAgICBwdWJsaWMgcmVuZGVyZXI6IFJlbmRlcmVyMixcbiAgICBwdWJsaWMgbGFuZ3VhZ2VTZXJ2aWNlOiBQb0xhbmd1YWdlU2VydmljZVxuICApIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuZGlmZmVyID0gZGlmZmVycy5maW5kKFtdKS5jcmVhdGUobnVsbCk7XG4gICAgY29uc3QgbGFuZ3VhZ2UgPSBsYW5ndWFnZVNlcnZpY2UuZ2V0U2hvcnRMYW5ndWFnZSgpO1xuXG4gICAgdGhpcy5saXRlcmFscyA9IHtcbiAgICAgIC4uLnBvQnJlYWRjcnVtYkxpdGVyYWxzW2xhbmd1YWdlXVxuICAgIH07XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG5cbiAgICB0aGlzLmluaXRpYWxpemVSZXNpemVMaXN0ZW5lcigpO1xuICB9XG5cbiAgbmdEb0NoZWNrKCkge1xuICAgIGNvbnN0IGJyZWFkY3J1bWJXaWR0aCA9IHRoaXMuYnJlYWRjcnVtYkVsZW1lbnQubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcblxuICAgIC8vIFBlcm1pdGUgcXVlIG9zIGRpc2NsYWltZXJzIHNlamFtIGNhbGN1bGFkb3MgbmEgcHJpbWVpcmEgdmV6IHF1ZSBvIGNvbXBvbmVudGUgdG9ybmEtc2Ugdmlzw612ZWwsXG4gICAgLy8gZXZpdGFuZG8gY29tIGlzc28sIHByb2JsZW1hcyBjb20gVGFicyBvdSBEaXZzIHF1ZSBpbmljaWVtIGVzY29uZGlkYXMuXG4gICAgaWYgKGJyZWFkY3J1bWJXaWR0aCAmJiAhdGhpcy5jYWxjdWxhdGVkRWxlbWVudCAmJiB0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICB0aGlzLmluaXRCcmVhZGNydW1iU2l6ZSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmhpZGRlbldpdGhvdXRSZXNpemUpIHtcbiAgICAgIHRoaXMuZGVib3VuY2VSZXNpemUoKTtcbiAgICAgIHRoaXMuaGlkZGVuV2l0aG91dFJlc2l6ZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHRoaXMuY2hlY2tDaGFuZ2VPbkl0ZW1zKCk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLnJlbW92ZVJlc2l6ZUxpc3RlbmVyKCk7XG4gIH1cblxuICBlbWl0QWN0aW9uKGl0ZW06IFBvQnJlYWRjcnVtYkl0ZW0pIHtcbiAgICBpZiAoaXRlbS5hY3Rpb24pIHtcbiAgICAgIGl0ZW0uYWN0aW9uKCk7XG4gICAgfVxuICB9XG5cbiAgb3BlblBvcHVwKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmNvZGUgPT09ICdFbnRlcicgfHwgZXZlbnQuY29kZSA9PT0gJ1NwYWNlJykge1xuICAgICAgdGhpcy5wb3B1cENvbnRhaW5lci5vcGVuKCk7XG4gICAgfVxuICB9XG5cbiAgY2xvc2VQb3BVcCgpIHtcbiAgICB0aGlzLnN2Z1RhcmdldC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gIH1cblxuICBwcml2YXRlIGNoZWNrQ2hhbmdlT25JdGVtcygpIHtcbiAgICBpZiAodGhpcy5kaWZmZXIpIHtcbiAgICAgIGNvbnN0IGNoYW5nZXMgPSB0aGlzLmRpZmZlci5kaWZmKHRoaXMuaXRlbXMpO1xuICAgICAgaWYgKGNoYW5nZXMpIHtcbiAgICAgICAgdGhpcy5jYWxjQnJlYWRjcnVtYkl0ZW1zV2lkdGgoKTtcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVkRWxlbWVudCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2FsY0JyZWFkY3J1bWIoKSB7XG4gICAgY29uc3QgYnJlYWRjcnVtYkZhdm9yaXRlID0gdGhpcy5nZXRCcmVhZGNydW1iRmF2b3JpdGVXaWR0aCgpO1xuICAgIGNvbnN0IGV4aXN0TGFiZWwgPSB0aGlzLmV4aXN0c0Zhdm9yaXRlbGFiZWwoKTtcbiAgICBjb25zdCBicmVhZGNydW1iID0gdGhpcy5nZXRCcmVhZGNydW1iV2lkdGgoYnJlYWRjcnVtYkZhdm9yaXRlLCBleGlzdExhYmVsKTtcbiAgICBjb25zdCBicmVhZGNydW1iVG9vbHRpcCA9IHRoaXMuZ2V0QnJlYWRjcnVtYlRvb2x0aXBXaWR0aCgpO1xuICAgIGlmIChicmVhZGNydW1iIDw9IHRoaXMuX2JyZWFkY3J1bWJJdGVtc0xlbmdodCkge1xuICAgICAgdGhpcy5lbmFibGVCcmVhZGNydW1iUmVzcG9uc2l2ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpc2FibGVCcmVhZGNydW1iUmVzcG9uc2l2ZSgpO1xuICAgIH1cblxuICAgIGlmIChicmVhZGNydW1iVG9vbHRpcCAmJiBicmVhZGNydW1iIDw9IGJyZWFkY3J1bWJUb29sdGlwKSB7XG4gICAgICB0aGlzLmhpZGRlbkxpdGVyYWxGYXZvcml0ZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGlkZGVuTGl0ZXJhbEZhdm9yaXRlID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRCcmVhZGNydW1iRmF2b3JpdGVXaWR0aCgpIHtcbiAgICByZXR1cm4gdGhpcy5mYXZvcml0ZVNlcnZpY2VcbiAgICAgID8gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvLWJyZWFkY3J1bWItZmF2b3JpdGUnKS5vZmZzZXRXaWR0aCArIDIwXG4gICAgICA6IDA7XG4gIH1cblxuICBwcml2YXRlIGdldEJyZWFkY3J1bWJUb29sdGlwV2lkdGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmF2b3JpdGVTZXJ2aWNlID8gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvLWJyZWFkY3J1bWItdG9vbHRpcCcpPy5vZmZzZXRXaWR0aCA6IDA7XG4gIH1cblxuICBwcml2YXRlIGV4aXN0c0Zhdm9yaXRlbGFiZWwoKSB7XG4gICAgcmV0dXJuICEhdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvLWJyZWFkY3J1bWItZmF2b3JpdGUtbGFiZWwnKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0QnJlYWRjcnVtYldpZHRoKGJyZWFkY3J1bWJGYXZvcml0ZSwgZXhpc3RMYWJlbCkge1xuICAgIGNvbnN0IHdpZHRoU3BhbiA9ICFleGlzdExhYmVsID8gOTUgOiAwO1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG8tYnJlYWRjcnVtYicpLm9mZnNldFdpZHRoIC0gKGJyZWFkY3J1bWJGYXZvcml0ZSArIHdpZHRoU3Bhbik7XG4gIH1cblxuICBwcml2YXRlIGNhbGNCcmVhZGNydW1iSXRlbXNXaWR0aCgpIHtcbiAgICBjb25zdCBicmVhZGNydW1iSXRlbSA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wby1icmVhZGNydW1iLWl0ZW0nKTtcblxuICAgIHRoaXMuX2JyZWFkY3J1bWJJdGVtc0xlbmdodCA9IEFycmF5LmZyb20oYnJlYWRjcnVtYkl0ZW0pXG4gICAgICAubWFwKGJyZWFkY3J1bWIgPT4gYnJlYWRjcnVtYlsnb2Zmc2V0V2lkdGgnXSlcbiAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAxNik7XG4gIH1cblxuICBwcml2YXRlIGVuYWJsZUJyZWFkY3J1bWJSZXNwb25zaXZlKCkge1xuICAgIHRoaXMuc2hvd0Ryb3Bkb3duVG9nZ2xlID0gdHJ1ZTtcbiAgfVxuXG4gIHByaXZhdGUgZGlzYWJsZUJyZWFkY3J1bWJSZXNwb25zaXZlKCkge1xuICAgIHRoaXMuc2hvd0Ryb3Bkb3duVG9nZ2xlID0gZmFsc2U7XG4gICAgdGhpcy5pdGVtc1ZpZXcgPSBbXS5jb25jYXQodGhpcy5pdGVtcyk7XG4gICAgdGhpcy5zaG93RHJvcGRvd24gPSBmYWxzZTtcbiAgfVxuXG4gIHByaXZhdGUgZGVib3VuY2VSZXNpemUoKSB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dFJlc2l6ZSk7XG4gICAgdGhpcy50aW1lb3V0UmVzaXplID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIHRoaXMuY2FsY3VsYXRlZEVsZW1lbnQgJiZcbiAgICAgICAgIXRoaXMuaGlkZGVuV2l0aG91dFJlc2l6ZSAmJlxuICAgICAgICB0aGlzLmJyZWFkY3J1bWJFbGVtZW50Lm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGggPT09IDBcbiAgICAgICkge1xuICAgICAgICB0aGlzLmhpZGRlbldpdGhvdXRSZXNpemUgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jYWxjQnJlYWRjcnVtYigpO1xuICAgICAgfVxuICAgIH0sIDUwKTtcbiAgfVxuXG4gIHByaXZhdGUgaW5pdEJyZWFkY3J1bWJTaXplKCkge1xuICAgIHRoaXMuY2FsY0JyZWFkY3J1bWJJdGVtc1dpZHRoKCk7XG4gICAgdGhpcy5jYWxjQnJlYWRjcnVtYigpO1xuICAgIHRoaXMuY2FsY3VsYXRlZEVsZW1lbnQgPSB0cnVlO1xuICB9XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplUmVzaXplTGlzdGVuZXIoKSB7XG4gICAgdGhpcy5yZXNpemVMaXN0ZW5lciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKCd3aW5kb3cnLCAncmVzaXplJywgKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmRlYm91bmNlUmVzaXplKCk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbW92ZVJlc2l6ZUxpc3RlbmVyKCkge1xuICAgIHRoaXMucmVzaXplTGlzdGVuZXIoKTtcbiAgfVxufVxuIiwiPG5hdiBjbGFzcz1cInBvLWJyZWFkY3J1bWJcIiAjYnJlYWRjcnVtYj5cbiAgPGRpdiBjbGFzcz1cInBvLWJyZWFkY3J1bWItaXRlbXNcIj5cbiAgICA8dWxcbiAgICAgICNkcm9wZG93bkljb25cbiAgICAgICpuZ0lmPVwic2hvd0Ryb3Bkb3duVG9nZ2xlICYmIGl0ZW1zVmlldy5sZW5ndGggPj0gNFwiXG4gICAgICBjbGFzcz1cInBvLWJyZWFkY3J1bWItaXRlbSBwby1jbGlja2FibGUgcG8tYnJlYWRjcnVtYi10b29sdGlwXCJcbiAgICA+XG4gICAgICA8bGk+XG4gICAgICAgIDxwby1saW5rXG4gICAgICAgICAgW3AtbGFiZWxdPVwiaXRlbXNWaWV3WzBdLmxhYmVsXCJcbiAgICAgICAgICBbcC11cmxdPVwiaXRlbXNWaWV3WzBdLmxpbmtcIlxuICAgICAgICAgIChwLWFjdGlvbik9XCJlbWl0QWN0aW9uKGl0ZW1zVmlld1swXSlcIlxuICAgICAgICA+PC9wby1saW5rPlxuICAgICAgPC9saT5cblxuICAgICAgPHBvLWljb24gcC1pY29uPVwiSUNPTl9BUlJPV19SSUdIVCBwby1icmVhZGNydW1iLWljb24tYXJyb3dcIj48L3BvLWljb24+XG5cbiAgICAgIDxsaVxuICAgICAgICAjdGFyZ2V0XG4gICAgICAgIGNsYXNzPVwicG8tYnJlYWRjcnVtYi1pY29uLW1vcmVcIlxuICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cImxpdGVyYWxzLmxpdGVyYWxCdXR0b25Qb3B1cFwiXG4gICAgICAgIHJvbGU9XCJidXR0b25cIlxuICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICAoY2xpY2spPVwicG9wdXAudG9nZ2xlKClcIlxuICAgICAgICAoa2V5dXApPVwib3BlblBvcHVwKCRldmVudClcIlxuICAgICAgPlxuICAgICAgICA8cG8taWNvbiBwLWljb249XCJJQ09OX01PUkVfVkVSVFwiPjwvcG8taWNvbj5cbiAgICAgIDwvbGk+XG4gICAgICA8cG8taWNvbiBwLWljb249XCJJQ09OX0FSUk9XX1JJR0hUIHBvLWJyZWFkY3J1bWItaWNvbi1hcnJvd1wiPjwvcG8taWNvbj5cblxuICAgICAgPGxpPlxuICAgICAgICA8cG8tbGlua1xuICAgICAgICAgIFtwLWxhYmVsXT1cIml0ZW1zVmlld1tpdGVtc1ZpZXcubGVuZ3RoIC0gMl0ubGFiZWxcIlxuICAgICAgICAgIFtwLXVybF09XCJpdGVtc1ZpZXdbaXRlbXNWaWV3Lmxlbmd0aCAtIDJdLmxpbmtcIlxuICAgICAgICAgIChwLWFjdGlvbik9XCJlbWl0QWN0aW9uKGl0ZW1zVmlld1tpdGVtc1ZpZXcubGVuZ3RoIC0gMl0pXCJcbiAgICAgICAgPjwvcG8tbGluaz5cbiAgICAgIDwvbGk+XG4gICAgICA8cG8taWNvbiBwLWljb249XCJJQ09OX0FSUk9XX1JJR0hUIHBvLWJyZWFkY3J1bWItaWNvbi1hcnJvd1wiPjwvcG8taWNvbj5cblxuICAgICAgPGxpPlxuICAgICAgICA8c3BhblxuICAgICAgICAgIGNsYXNzPVwicG8tYnJlYWRjcnVtYi1pdGVtLWFjdGl2YXRlXCJcbiAgICAgICAgICByb2xlPVwibGlua1wiXG4gICAgICAgICAgdGFiaW5kZXg9XCIwXCJcbiAgICAgICAgICBbYXR0ci5hcmlhLWN1cnJlbnRdPVwiaXRlbXNWaWV3W2l0ZW1zVmlldy5sZW5ndGggLSAxXS5sYWJlbFwiXG4gICAgICAgICAgPnt7IGl0ZW1zVmlld1tpdGVtc1ZpZXcubGVuZ3RoIC0gMV0ubGFiZWwgfX08L3NwYW5cbiAgICAgICAgPlxuICAgICAgPC9saT5cbiAgICAgIDxwby1wb3B1cFxuICAgICAgICAjcG9wdXBcbiAgICAgICAgcC1wb3NpdGlvbj1cImJvdHRvbS1yaWdodFwiXG4gICAgICAgIChwLWNsb3NlKT1cImNsb3NlUG9wVXAoKVwiXG4gICAgICAgIFtwLWhpZGUtYXJyb3ddPVwidHJ1ZVwiXG4gICAgICAgIFtwLWFjdGlvbnNdPVwiaXRlbXNWaWV3UG9wdXBcIlxuICAgICAgICBbcC10YXJnZXRdPVwidGFyZ2V0XCJcbiAgICAgID5cbiAgICAgIDwvcG8tcG9wdXA+XG4gICAgPC91bD5cblxuICAgIDx1bCAqbmdJZj1cIiFzaG93RHJvcGRvd25Ub2dnbGUgfHwgaXRlbXNWaWV3Lmxlbmd0aCA8IDRcIiBjbGFzcz1cInBvLWJyZWFkY3J1bWItaXRlbS1jb250YWluZXJcIj5cbiAgICAgIDxsaSAqbmdGb3I9XCJsZXQgaXRlbSBvZiBpdGVtc1ZpZXc7IGxldCBpdGVtSW5kZXggPSBpbmRleFwiIGNsYXNzPVwicG8tYnJlYWRjcnVtYi1pdGVtXCI+XG4gICAgICAgIDxwby1saW5rXG4gICAgICAgICAgKm5nSWY9XCIhKGl0ZW1JbmRleCA9PT0gaXRlbXNWaWV3Lmxlbmd0aCAtIDEpXCJcbiAgICAgICAgICBbcC1sYWJlbF09XCJpdGVtLmxhYmVsXCJcbiAgICAgICAgICBbcC11cmxdPVwiaXRlbS5saW5rXCJcbiAgICAgICAgICAocC1hY3Rpb24pPVwiZW1pdEFjdGlvbihpdGVtKVwiXG4gICAgICAgID48L3BvLWxpbms+XG4gICAgICAgIDxzcGFuXG4gICAgICAgICAgY2xhc3M9XCJwby1icmVhZGNydW1iLWl0ZW0tYWN0aXZhdGVcIlxuICAgICAgICAgIHJvbGU9XCJsaW5rXCJcbiAgICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICAgICpuZ0lmPVwiaXRlbUluZGV4ID09PSBpdGVtc1ZpZXcubGVuZ3RoIC0gMVwiXG4gICAgICAgICAgW2F0dHIuYXJpYS1jdXJyZW50XT1cIml0ZW0ubGFiZWxcIlxuICAgICAgICAgID57eyBpdGVtLmxhYmVsIH19PC9zcGFuXG4gICAgICAgID5cbiAgICAgICAgPHBvLWljb25cbiAgICAgICAgICAqbmdJZj1cIiEoaXRlbUluZGV4ID09PSBpdGVtc1ZpZXcubGVuZ3RoIC0gMSlcIlxuICAgICAgICAgIHAtaWNvbj1cIklDT05fQVJST1dfUklHSFQgcG8tYnJlYWRjcnVtYi1pY29uLWFycm93XCJcbiAgICAgICAgPjwvcG8taWNvbj5cbiAgICAgIDwvbGk+XG4gICAgPC91bD5cbiAgPC9kaXY+XG5cbiAgPHBvLWJyZWFkY3J1bWItZmF2b3JpdGVcbiAgICAqbmdJZj1cImZhdm9yaXRlU2VydmljZVwiXG4gICAgW3AtZmF2b3JpdGUtc2VydmljZV09XCJmYXZvcml0ZVNlcnZpY2VcIlxuICAgIFtwLWl0ZW0tYWN0aXZlXT1cIml0ZW1zW2l0ZW1zLmxlbmd0aCAtIDFdXCJcbiAgICBbcC1wYXJhbXMtc2VydmljZV09XCJwYXJhbXNTZXJ2aWNlXCJcbiAgICBbcC1oaWRkZW4tbGl0ZXJhbF09XCJoaWRkZW5MaXRlcmFsRmF2b3JpdGVcIlxuICA+XG4gIDwvcG8tYnJlYWRjcnVtYi1mYXZvcml0ZT5cbjwvbmF2PlxuIl19