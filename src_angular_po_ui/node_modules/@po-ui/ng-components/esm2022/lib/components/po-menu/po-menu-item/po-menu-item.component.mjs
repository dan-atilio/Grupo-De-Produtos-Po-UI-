import { Component, Input, ViewChild } from '@angular/core';
import { convertToInt, convertToBoolean } from '../../../utils/util';
import * as i0 from "@angular/core";
import * as i1 from "../services/po-menu-items.service";
import * as i2 from "@angular/common";
import * as i3 from "@angular/router";
import * as i4 from "../../po-badge/po-badge.component";
import * as i5 from "../../po-icon/po-icon.component";
import * as i6 from "../../../directives/po-tooltip/po-tooltip.directive";
const _c0 = ["menuSubItems"];
function PoMenuItemComponent_a_0_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function PoMenuItemComponent_a_0_Template(rf, ctx) { if (rf & 1) {
    const _r9 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "a", 6);
    i0.ɵɵlistener("keydown.enter", function PoMenuItemComponent_a_0_Template_a_keydown_enter_0_listener($event) { i0.ɵɵrestoreView(_r9); const ctx_r8 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r8.clickMenuItem($event)); })("keydown.space", function PoMenuItemComponent_a_0_Template_a_keydown_space_0_listener($event) { i0.ɵɵrestoreView(_r9); const ctx_r10 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r10.clickMenuItem($event)); });
    i0.ɵɵtemplate(1, PoMenuItemComponent_a_0_ng_container_1_Template, 1, 0, "ng-container", 7);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    const _r6 = i0.ɵɵreference(6);
    i0.ɵɵproperty("routerLink", ctx_r0.link)("p-tooltip", ctx_r0.collapsedMenu && ctx_r0.shortLabel ? ctx_r0.shortLabel : undefined)("p-append-in-body", true);
    i0.ɵɵattribute("aria-label", ctx_r0.label);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngTemplateOutlet", _r6);
} }
function PoMenuItemComponent_a_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function PoMenuItemComponent_a_1_Template(rf, ctx) { if (rf & 1) {
    const _r13 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "a", 8);
    i0.ɵɵlistener("keydown.enter", function PoMenuItemComponent_a_1_Template_a_keydown_enter_0_listener($event) { i0.ɵɵrestoreView(_r13); const ctx_r12 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r12.clickMenuItem($event)); })("keydown.space", function PoMenuItemComponent_a_1_Template_a_keydown_space_0_listener($event) { i0.ɵɵrestoreView(_r13); const ctx_r14 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r14.clickMenuItem($event)); });
    i0.ɵɵtemplate(1, PoMenuItemComponent_a_1_ng_container_1_Template, 1, 0, "ng-container", 7);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    const _r6 = i0.ɵɵreference(6);
    i0.ɵɵproperty("href", ctx_r1.link, i0.ɵɵsanitizeUrl)("p-tooltip", ctx_r1.collapsedMenu && ctx_r1.shortLabel ? ctx_r1.shortLabel : undefined)("p-append-in-body", true);
    i0.ɵɵattribute("aria-label", ctx_r1.label);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngTemplateOutlet", _r6);
} }
function PoMenuItemComponent_a_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function PoMenuItemComponent_a_2_Template(rf, ctx) { if (rf & 1) {
    const _r17 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "a", 9);
    i0.ɵɵlistener("keydown.enter", function PoMenuItemComponent_a_2_Template_a_keydown_enter_0_listener($event) { i0.ɵɵrestoreView(_r17); const ctx_r16 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r16.clickMenuItem($event)); })("keydown.space", function PoMenuItemComponent_a_2_Template_a_keydown_space_0_listener($event) { i0.ɵɵrestoreView(_r17); const ctx_r18 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r18.clickMenuItem($event)); });
    i0.ɵɵtemplate(1, PoMenuItemComponent_a_2_ng_container_1_Template, 1, 0, "ng-container", 7);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    const _r6 = i0.ɵɵreference(6);
    i0.ɵɵproperty("p-tooltip", ctx_r2.collapsedMenu && ctx_r2.shortLabel ? ctx_r2.shortLabel : undefined)("p-append-in-body", true);
    i0.ɵɵattribute("aria-label", ctx_r2.label);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngTemplateOutlet", _r6);
} }
function PoMenuItemComponent_div_3_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function PoMenuItemComponent_div_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 10);
    i0.ɵɵtemplate(1, PoMenuItemComponent_div_3_ng_container_1_Template, 1, 0, "ng-container", 7);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    i0.ɵɵnextContext();
    const _r6 = i0.ɵɵreference(6);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngTemplateOutlet", _r6);
} }
function PoMenuItemComponent_div_4_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function PoMenuItemComponent_div_4_li_5_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "li", 16);
    i0.ɵɵelement(1, "po-menu-item", 17);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const subItem_r23 = ctx.$implicit;
    i0.ɵɵattribute("aria-level", subItem_r23.level);
    i0.ɵɵadvance();
    i0.ɵɵproperty("p-action", subItem_r23.action)("p-badge-alert", subItem_r23.badgeAlert)("p-badge-color", subItem_r23.badge ? subItem_r23.badge.color : undefined)("p-badge-value", subItem_r23.badge ? subItem_r23.badge.value : undefined)("p-id", subItem_r23.id)("p-label", subItem_r23.label)("p-level", subItem_r23.level)("p-link", subItem_r23.link)("p-sub-items", subItem_r23.subItems)("p-type", subItem_r23.type);
} }
function PoMenuItemComponent_div_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 11);
    i0.ɵɵtemplate(1, PoMenuItemComponent_div_4_ng_container_1_Template, 1, 0, "ng-container", 7);
    i0.ɵɵelementStart(2, "div", 12, 13)(4, "ul", 14);
    i0.ɵɵtemplate(5, PoMenuItemComponent_div_4_li_5_Template, 2, 11, "li", 15);
    i0.ɵɵelementEnd()()();
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext();
    const _r6 = i0.ɵɵreference(6);
    i0.ɵɵattribute("aria-expanded", ctx_r4.isOpened ? true : false);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngTemplateOutlet", _r6);
    i0.ɵɵadvance();
    i0.ɵɵstyleProp("max-height", ctx_r4.maxHeight, "px");
    i0.ɵɵproperty("hidden", ctx_r4.collapsedMenu || !ctx_r4.isOpened);
    i0.ɵɵattribute("aria-expanded", ctx_r4.isOpened ? true : false)("aria-hidden", !ctx_r4.isOpened ? true : false);
    i0.ɵɵadvance(3);
    i0.ɵɵproperty("ngForOf", ctx_r4.subItems);
} }
function PoMenuItemComponent_ng_template_5_po_icon_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "po-icon", 23);
} if (rf & 2) {
    const ctx_r24 = i0.ɵɵnextContext(2);
    i0.ɵɵproperty("p-icon", ctx_r24.icon);
} }
function PoMenuItemComponent_ng_template_5_po_icon_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "po-icon", 24);
} if (rf & 2) {
    const ctx_r25 = i0.ɵɵnextContext(2);
    i0.ɵɵproperty("p-icon", ctx_r25.isOpened ? "ICON_ARROW_UP po-field-icon" : "ICON_ARROW_DOWN po-field-icon");
} }
function PoMenuItemComponent_ng_template_5_po_badge_5_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "po-badge", 25);
} if (rf & 2) {
    const ctx_r26 = i0.ɵɵnextContext(2);
    i0.ɵɵproperty("ngClass", !ctx_r26.collapsedMenu ? "po-menu-badge-align" : "po-menu-badge-align-collapsed")("p-color", ctx_r26.badgeColor)("p-value", ctx_r26.badgeValue);
} }
function PoMenuItemComponent_ng_template_5_span_6_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "span", 26);
} if (rf & 2) {
    const ctx_r27 = i0.ɵɵnextContext(2);
    i0.ɵɵproperty("ngClass", !ctx_r27.collapsedMenu ? "po-menu-badge-alert" : "po-menu-badge-alert-collapsed");
} }
function PoMenuItemComponent_ng_template_5_Template(rf, ctx) { if (rf & 1) {
    const _r29 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 18);
    i0.ɵɵlistener("click", function PoMenuItemComponent_ng_template_5_Template_div_click_0_listener($event) { i0.ɵɵrestoreView(_r29); const ctx_r28 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r28.clickMenuItem($event)); })("keydown.enter", function PoMenuItemComponent_ng_template_5_Template_div_keydown_enter_0_listener($event) { i0.ɵɵrestoreView(_r29); const ctx_r30 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r30.clickMenuItem($event)); })("keydown.space", function PoMenuItemComponent_ng_template_5_Template_div_keydown_space_0_listener($event) { i0.ɵɵrestoreView(_r29); const ctx_r31 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r31.clickMenuItem($event)); });
    i0.ɵɵtemplate(1, PoMenuItemComponent_ng_template_5_po_icon_1_Template, 1, 1, "po-icon", 19)(2, PoMenuItemComponent_ng_template_5_po_icon_2_Template, 1, 1, "po-icon", 20);
    i0.ɵɵelementStart(3, "span");
    i0.ɵɵtext(4);
    i0.ɵɵelementEnd();
    i0.ɵɵtemplate(5, PoMenuItemComponent_ng_template_5_po_badge_5_Template, 1, 3, "po-badge", 21)(6, PoMenuItemComponent_ng_template_5_span_6_Template, 1, 1, "span", 22);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = i0.ɵɵnextContext();
    i0.ɵɵclassProp("po-menu-icon-container", ctx_r5.level === 1 && ctx_r5.icon)("po-menu-item-selected", ctx_r5.isSelected)("po-menu-item-level-two", ctx_r5.level === 2)("po-menu-item-level-three", ctx_r5.level === 3)("po-menu-item-level-four", ctx_r5.level === 4)("po-menu-item-grouper-up", ctx_r5.type === "subItems" && ctx_r5.isOpened)("po-menu-item-grouper-down", ctx_r5.type === "subItems" && !ctx_r5.isOpened)("po-menu-item-no-data", ctx_r5.type === "noData")("po-menu-sub-item-selected", ctx_r5.isSelectedSubItem);
    i0.ɵɵproperty("p-tooltip", ctx_r5.type === "subItems" && ctx_r5.collapsedMenu && ctx_r5.shortLabel ? ctx_r5.shortLabel : undefined)("p-append-in-body", true)("tabindex", ctx_r5.type === "subItems" ? 0 : -1);
    i0.ɵɵattribute("aria-label", ctx_r5.label)("aria-hidden", ctx_r5.type === "subItems" ? false : true)("role", ctx_r5.type === "subItems" ? "menuitem" : undefined);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngIf", ctx_r5.level === 1 && ctx_r5.icon);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngIf", ctx_r5.type === "subItems" && !ctx_r5.collapsedMenu);
    i0.ɵɵadvance();
    i0.ɵɵclassProp("po-menu-icon-label", ctx_r5.level === 1 && ctx_r5.icon);
    i0.ɵɵadvance();
    i0.ɵɵtextInterpolate1(" ", ctx_r5.label, " ");
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngIf", ctx_r5.canShowBadge);
    i0.ɵɵadvance();
    i0.ɵɵproperty("ngIf", ctx_r5.badgeAlert);
} }
// valor para que caibam 3 linhas de `label`
const poMenuItemSubItemSize = 98;
/**
 * @docsPrivate
 *
 * @description
 *
 * Componente que implementa cada item do po-menu.
 */
export class PoMenuItemComponent {
    menuItemsService;
    // Ação que será chamada ao clicar no item.
    action;
    // Indica se contém algum item filho com o badge.
    badgeAlert;
    // Cor do badge.
    badgeColor;
    // Indica se o menu está colapsado
    collapsedMenu;
    // Ícone de menu
    icon;
    // Identificador do item.
    id;
    // Indica se o item está aberto (menu agrupado)
    isOpened;
    // Texto que aparecerá representando o item.
    label;
    // Indica qual em nível do po-menu encontra-se.
    level;
    // Link do item.
    link;
    // Texto que aparecerá representando o item.
    shortLabel;
    // Indica o tipo de item, como 'internalLink' ou 'subItems'.
    type;
    menuSubItems;
    isSelectedSubItem;
    maxHeight = 0;
    itemSubscription;
    _badgeValue;
    _isSelected = false;
    _isSubItem = false;
    _subItems;
    // Valor do badge.
    set badgeValue(badgeValue) {
        this._badgeValue = convertToInt(badgeValue);
    }
    get badgeValue() {
        return this._badgeValue;
    }
    // Indica se o item está selecionado.
    set isSelected(value) {
        this._isSelected = convertToBoolean(value);
        this.isSelectedSubItem = this.isSelected && this.isSubItem;
    }
    get isSelected() {
        return this._isSelected;
    }
    // Indica se o item é um sub item
    set isSubItem(value) {
        this._isSubItem = convertToBoolean(value);
    }
    get isSubItem() {
        return this._isSubItem;
    }
    // Lista de sub-items.
    set subItems(subitems) {
        this._subItems = subitems;
        if (this.isOpened) {
            this.calcMenuSubItemsMaxHeight();
        }
    }
    get subItems() {
        return this._subItems;
    }
    get canShowBadge() {
        return this.type !== 'subItems' && (this.badgeValue || this.badgeValue === 0) && this.badgeValue >= 0;
    }
    constructor(menuItemsService) {
        this.menuItemsService = menuItemsService;
    }
    ngOnDestroy() {
        this.itemSubscription.unsubscribe();
    }
    ngOnInit() {
        // subscribe to menu component messages
        this.itemSubscription = this.menuItemsService.receiveFromParentMenuClicked().subscribe(menu => {
            this.processMenuItem(menu);
        });
    }
    clickMenuItem(event) {
        if (!(event.ctrlKey || event.metaKey)) {
            event.preventDefault();
            // Emmit to parent
            this.menuItemsService.sendToParentMenuClicked({
                link: this.link,
                action: this.action,
                id: this.id,
                icon: this.icon,
                label: this.label,
                level: this.level,
                subItems: this.subItems,
                isSelected: this.isSelected,
                isOpened: this.isOpened,
                shortLabel: this.shortLabel,
                type: this.type
            });
        }
    }
    accordionAnimation(menuActive, menuOpened, hasSubItemOpened, activatedByRoute) {
        if (this.id === menuOpened['id']) {
            this.maxHeight = this.subItems.length * poMenuItemSubItemSize;
        }
        if (hasSubItemOpened) {
            this.maxHeight = menuOpened['isOpened']
                ? this.maxHeight + menuOpened.subItems.length * poMenuItemSubItemSize
                : this.maxHeight - menuOpened.subItems.length * poMenuItemSubItemSize;
            if (activatedByRoute) {
                this.maxHeight = this.getMinimumHeight(0, this, menuActive);
            }
        }
    }
    activateMenu(menu) {
        this.isSelected = menu && this.id === menu.id;
    }
    calcMenuSubItemsMaxHeight() {
        setTimeout(() => {
            const subItems = Array.from(this.menuSubItems.nativeElement.querySelectorAll('.po-menu-item'));
            subItems.forEach((menuItem) => (this.maxHeight += menuItem.offsetHeight));
        });
    }
    getMinimumHeight(minimumHeight, menuItem, menuActive) {
        minimumHeight += poMenuItemSubItemSize;
        if (menuItem.subItems && this.hasSubItem(menuItem.subItems, menuActive['id'])) {
            for (let index = 0; index < menuItem.subItems.length; index++) {
                minimumHeight = this.getMinimumHeight(minimumHeight, menuItem.subItems[index], menuActive);
            }
        }
        return minimumHeight;
    }
    groupedMenu(menuActive, menuOpened, activatedByRoute = false) {
        const hasSubItemOpened = menuOpened && this.id !== menuOpened['id'] ? this.hasSubItem(this.subItems, menuOpened['id']) : false;
        this.isOpened = this.isMenuOpened(menuOpened, hasSubItemOpened);
        this.isSelected = menuActive && !this.isOpened ? this.hasSubItem(this.subItems, menuActive['id']) : false;
        if (!this.isOpened) {
            this.maxHeight = 0;
            return;
        }
        this.accordionAnimation(menuActive, menuOpened, hasSubItemOpened, activatedByRoute);
    }
    hasSubItem(subItems, id) {
        if (subItems) {
            return subItems.some(item => (item['id'] === id ? true : this.hasSubItem(item.subItems, id)));
        }
    }
    isMenuOpened(menuOpened, hasSubItemOpened) {
        if (menuOpened) {
            return this.id === menuOpened['id'] ? menuOpened['isOpened'] : hasSubItemOpened;
        }
        return false;
    }
    processMenuItem(menu) {
        if (this.type === 'internalLink') {
            this.activateMenu(menu.active);
            return;
        }
        if (this.type === 'subItems') {
            this.groupedMenu(menu.active, menu.grouped, menu.activatedByRoute);
        }
    }
    static ɵfac = function PoMenuItemComponent_Factory(t) { return new (t || PoMenuItemComponent)(i0.ɵɵdirectiveInject(i1.PoMenuItemsService)); };
    static ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PoMenuItemComponent, selectors: [["po-menu-item"]], viewQuery: function PoMenuItemComponent_Query(rf, ctx) { if (rf & 1) {
            i0.ɵɵviewQuery(_c0, 5);
        } if (rf & 2) {
            let _t;
            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.menuSubItems = _t.first);
        } }, inputs: { action: [i0.ɵɵInputFlags.None, "p-action", "action"], badgeAlert: [i0.ɵɵInputFlags.None, "p-badge-alert", "badgeAlert"], badgeColor: [i0.ɵɵInputFlags.None, "p-badge-color", "badgeColor"], collapsedMenu: [i0.ɵɵInputFlags.None, "p-collapsed-menu", "collapsedMenu"], icon: [i0.ɵɵInputFlags.None, "p-icon", "icon"], id: [i0.ɵɵInputFlags.None, "p-id", "id"], isOpened: [i0.ɵɵInputFlags.None, "p-is-opened", "isOpened"], label: [i0.ɵɵInputFlags.None, "p-label", "label"], level: [i0.ɵɵInputFlags.None, "p-level", "level"], link: [i0.ɵɵInputFlags.None, "p-link", "link"], shortLabel: [i0.ɵɵInputFlags.None, "p-short-label", "shortLabel"], type: [i0.ɵɵInputFlags.None, "p-type", "type"], badgeValue: [i0.ɵɵInputFlags.None, "p-badge-value", "badgeValue"], isSelected: [i0.ɵɵInputFlags.None, "p-is-selected", "isSelected"], isSubItem: [i0.ɵɵInputFlags.None, "p-is-sub-item", "isSubItem"], subItems: [i0.ɵɵInputFlags.None, "p-sub-items", "subItems"] }, decls: 7, vars: 5, consts: [["class", "po-menu-item-link", "role", "menuitem", "p-tooltip-position", "right", 3, "routerLink", "p-tooltip", "p-append-in-body", "keydown.enter", "keydown.space", 4, "ngIf"], ["class", "po-menu-item-link", "role", "menuitem", "p-tooltip-position", "right", 3, "href", "p-tooltip", "p-append-in-body", "keydown.enter", "keydown.space", 4, "ngIf"], ["class", "po-menu-item-link", "href", "javascript:;", "role", "menuitem", "p-tooltip-position", "right", 3, "p-tooltip", "p-append-in-body", "keydown.enter", "keydown.space", 4, "ngIf"], ["class", "po-menu-item-link", "role", "none", 4, "ngIf"], ["class", "po-menu-item-link po-clickable", "role", "menuitem", 4, "ngIf"], ["menuItemTemplate", ""], ["role", "menuitem", "p-tooltip-position", "right", 1, "po-menu-item-link", 3, "routerLink", "p-tooltip", "p-append-in-body", "keydown.enter", "keydown.space"], [4, "ngTemplateOutlet"], ["role", "menuitem", "p-tooltip-position", "right", 1, "po-menu-item-link", 3, "href", "p-tooltip", "p-append-in-body", "keydown.enter", "keydown.space"], ["href", "javascript:;", "role", "menuitem", "p-tooltip-position", "right", 1, "po-menu-item-link", 3, "p-tooltip", "p-append-in-body", "keydown.enter", "keydown.space"], ["role", "none", 1, "po-menu-item-link"], ["role", "menuitem", 1, "po-menu-item-link", "po-clickable"], ["role", "group", 1, "po-menu-sub-items", 3, "hidden"], ["menuSubItems", ""], [1, "po-menu-sub-items-list"], ["class", "po-menu-sub-items-list-item", 4, "ngFor", "ngForOf"], [1, "po-menu-sub-items-list-item"], ["p-is-sub-item", "", 3, "p-action", "p-badge-alert", "p-badge-color", "p-badge-value", "p-id", "p-label", "p-level", "p-link", "p-sub-items", "p-type"], ["p-tooltip-position", "right", 1, "po-menu-item", 3, "p-tooltip", "p-append-in-body", "tabindex", "click", "keydown.enter", "keydown.space"], ["aria-hidden", "true", "class", "po-menu-icon-item", 3, "p-icon", 4, "ngIf"], ["class", "po-menu-group-icon", 3, "p-icon", 4, "ngIf"], ["aria-hidden", "true", 3, "ngClass", "p-color", "p-value", 4, "ngIf"], ["aria-hidden", "true", "class", "po-color-07", 3, "ngClass", 4, "ngIf"], ["aria-hidden", "true", 1, "po-menu-icon-item", 3, "p-icon"], [1, "po-menu-group-icon", 3, "p-icon"], ["aria-hidden", "true", 3, "ngClass", "p-color", "p-value"], ["aria-hidden", "true", 1, "po-color-07", 3, "ngClass"]], template: function PoMenuItemComponent_Template(rf, ctx) { if (rf & 1) {
            i0.ɵɵtemplate(0, PoMenuItemComponent_a_0_Template, 2, 5, "a", 0)(1, PoMenuItemComponent_a_1_Template, 2, 5, "a", 1)(2, PoMenuItemComponent_a_2_Template, 2, 4, "a", 2)(3, PoMenuItemComponent_div_3_Template, 2, 1, "div", 3)(4, PoMenuItemComponent_div_4_Template, 6, 8, "div", 4)(5, PoMenuItemComponent_ng_template_5_Template, 7, 31, "ng-template", null, 5, i0.ɵɵtemplateRefExtractor);
        } if (rf & 2) {
            i0.ɵɵproperty("ngIf", ctx.type === "internalLink");
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.type === "externalLink");
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.type === "noLink");
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.type === "noData");
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.type === "subItems");
        } }, dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i2.NgTemplateOutlet, i3.RouterLink, i4.PoBadgeComponent, i5.PoIconComponent, i6.PoTooltipDirective, PoMenuItemComponent], encapsulation: 2 });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoMenuItemComponent, [{
        type: Component,
        args: [{ selector: 'po-menu-item', template: "<!-- menu com link interno -->\n<a\n  *ngIf=\"type === 'internalLink'\"\n  class=\"po-menu-item-link\"\n  role=\"menuitem\"\n  [attr.aria-label]=\"label\"\n  [routerLink]=\"link\"\n  (keydown.enter)=\"clickMenuItem($event)\"\n  (keydown.space)=\"clickMenuItem($event)\"\n  p-tooltip-position=\"right\"\n  [p-tooltip]=\"collapsedMenu && shortLabel ? shortLabel : undefined\"\n  [p-append-in-body]=\"true\"\n>\n  <ng-container *ngTemplateOutlet=\"menuItemTemplate\"></ng-container>\n</a>\n<!-- menu com link externo -->\n<a\n  *ngIf=\"type === 'externalLink'\"\n  class=\"po-menu-item-link\"\n  role=\"menuitem\"\n  [attr.aria-label]=\"label\"\n  [href]=\"link\"\n  (keydown.enter)=\"clickMenuItem($event)\"\n  (keydown.space)=\"clickMenuItem($event)\"\n  p-tooltip-position=\"right\"\n  [p-tooltip]=\"collapsedMenu && shortLabel ? shortLabel : undefined\"\n  [p-append-in-body]=\"true\"\n>\n  <ng-container *ngTemplateOutlet=\"menuItemTemplate\"></ng-container>\n</a>\n<!-- menu sem link -->\n<a\n  *ngIf=\"type === 'noLink'\"\n  class=\"po-menu-item-link\"\n  href=\"javascript:;\"\n  role=\"menuitem\"\n  [attr.aria-label]=\"label\"\n  (keydown.enter)=\"clickMenuItem($event)\"\n  (keydown.space)=\"clickMenuItem($event)\"\n  p-tooltip-position=\"right\"\n  [p-tooltip]=\"collapsedMenu && shortLabel ? shortLabel : undefined\"\n  [p-append-in-body]=\"true\"\n>\n  <ng-container *ngTemplateOutlet=\"menuItemTemplate\"></ng-container>\n</a>\n<!-- menu sem dados -->\n<div *ngIf=\"type === 'noData'\" class=\"po-menu-item-link\" role=\"none\">\n  <ng-container *ngTemplateOutlet=\"menuItemTemplate\"></ng-container>\n</div>\n<!-- menu com sub itens -->\n<div\n  *ngIf=\"type === 'subItems'\"\n  class=\"po-menu-item-link po-clickable\"\n  role=\"menuitem\"\n  [attr.aria-expanded]=\"isOpened ? true : false\"\n>\n  <ng-container *ngTemplateOutlet=\"menuItemTemplate\"></ng-container>\n\n  <div\n    #menuSubItems\n    class=\"po-menu-sub-items\"\n    [hidden]=\"collapsedMenu || !isOpened\"\n    [attr.aria-expanded]=\"isOpened ? true : false\"\n    [attr.aria-hidden]=\"!isOpened ? true : false\"\n    role=\"group\"\n    [style.maxHeight.px]=\"maxHeight\"\n  >\n    <ul class=\"po-menu-sub-items-list\">\n      <li class=\"po-menu-sub-items-list-item\" *ngFor=\"let subItem of subItems\" [attr.aria-level]=\"subItem.level\">\n        <po-menu-item\n          p-is-sub-item\n          [p-action]=\"subItem.action\"\n          [p-badge-alert]=\"subItem.badgeAlert\"\n          [p-badge-color]=\"subItem.badge ? subItem.badge.color : undefined\"\n          [p-badge-value]=\"subItem.badge ? subItem.badge.value : undefined\"\n          [p-id]=\"subItem.id\"\n          [p-label]=\"subItem.label\"\n          [p-level]=\"subItem.level\"\n          [p-link]=\"subItem.link\"\n          [p-sub-items]=\"subItem.subItems\"\n          [p-type]=\"subItem.type\"\n        ></po-menu-item>\n      </li>\n    </ul>\n  </div>\n</div>\n\n<ng-template #menuItemTemplate>\n  <div\n    p-tooltip-position=\"right\"\n    [p-tooltip]=\"type === 'subItems' && collapsedMenu && shortLabel ? shortLabel : undefined\"\n    [p-append-in-body]=\"true\"\n    class=\"po-menu-item\"\n    [tabindex]=\"type === 'subItems' ? 0 : -1\"\n    [attr.aria-label]=\"label\"\n    [attr.aria-hidden]=\"type === 'subItems' ? false : true\"\n    [attr.role]=\"type === 'subItems' ? 'menuitem' : undefined\"\n    [class.po-menu-icon-container]=\"level === 1 && icon\"\n    [class.po-menu-item-selected]=\"isSelected\"\n    [class.po-menu-item-level-two]=\"level === 2\"\n    [class.po-menu-item-level-three]=\"level === 3\"\n    [class.po-menu-item-level-four]=\"level === 4\"\n    [class.po-menu-item-grouper-up]=\"type === 'subItems' && isOpened\"\n    [class.po-menu-item-grouper-down]=\"type === 'subItems' && !isOpened\"\n    [class.po-menu-item-no-data]=\"type === 'noData'\"\n    [class.po-menu-sub-item-selected]=\"isSelectedSubItem\"\n    (click)=\"clickMenuItem($event)\"\n    (keydown.enter)=\"clickMenuItem($event)\"\n    (keydown.space)=\"clickMenuItem($event)\"\n  >\n    <po-icon *ngIf=\"level === 1 && icon\" aria-hidden=\"true\" class=\"po-menu-icon-item\" [p-icon]=\"icon\"></po-icon>\n\n    <po-icon\n      *ngIf=\"type === 'subItems' && !collapsedMenu\"\n      class=\"po-menu-group-icon\"\n      [p-icon]=\"isOpened ? 'ICON_ARROW_UP po-field-icon' : 'ICON_ARROW_DOWN po-field-icon'\"\n    ></po-icon>\n\n    <span [class.po-menu-icon-label]=\"level === 1 && icon\">\n      {{ label }}\n    </span>\n\n    <po-badge\n      *ngIf=\"canShowBadge\"\n      aria-hidden=\"true\"\n      [ngClass]=\"!collapsedMenu ? 'po-menu-badge-align' : 'po-menu-badge-align-collapsed'\"\n      [p-color]=\"badgeColor\"\n      [p-value]=\"badgeValue\"\n    ></po-badge>\n\n    <span\n      *ngIf=\"badgeAlert\"\n      aria-hidden=\"true\"\n      class=\"po-color-07\"\n      [ngClass]=\"!collapsedMenu ? 'po-menu-badge-alert' : 'po-menu-badge-alert-collapsed'\"\n    ></span>\n  </div>\n</ng-template>\n" }]
    }], () => [{ type: i1.PoMenuItemsService }], { action: [{
            type: Input,
            args: ['p-action']
        }], badgeAlert: [{
            type: Input,
            args: ['p-badge-alert']
        }], badgeColor: [{
            type: Input,
            args: ['p-badge-color']
        }], collapsedMenu: [{
            type: Input,
            args: ['p-collapsed-menu']
        }], icon: [{
            type: Input,
            args: ['p-icon']
        }], id: [{
            type: Input,
            args: ['p-id']
        }], isOpened: [{
            type: Input,
            args: ['p-is-opened']
        }], label: [{
            type: Input,
            args: ['p-label']
        }], level: [{
            type: Input,
            args: ['p-level']
        }], link: [{
            type: Input,
            args: ['p-link']
        }], shortLabel: [{
            type: Input,
            args: ['p-short-label']
        }], type: [{
            type: Input,
            args: ['p-type']
        }], menuSubItems: [{
            type: ViewChild,
            args: ['menuSubItems']
        }], badgeValue: [{
            type: Input,
            args: ['p-badge-value']
        }], isSelected: [{
            type: Input,
            args: ['p-is-selected']
        }], isSubItem: [{
            type: Input,
            args: ['p-is-sub-item']
        }], subItems: [{
            type: Input,
            args: ['p-sub-items']
        }] }); })();
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassDebugInfo(PoMenuItemComponent, { className: "PoMenuItemComponent", filePath: "lib/components/po-menu/po-menu-item/po-menu-item.component.ts", lineNumber: 24 }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tbWVudS1pdGVtLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpL3NyYy9saWIvY29tcG9uZW50cy9wby1tZW51L3BvLW1lbnUtaXRlbS9wby1tZW51LWl0ZW0uY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdWkvc3JjL2xpYi9jb21wb25lbnRzL3BvLW1lbnUvcG8tbWVudS1pdGVtL3BvLW1lbnUtaXRlbS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFjLEtBQUssRUFBa0MsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSXhHLE9BQU8sRUFBRSxZQUFZLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQzs7Ozs7Ozs7OztJQ1NuRSx3QkFBa0U7Ozs7SUFacEUsNEJBV0M7SUFMQywrS0FBaUIsZUFBQSw0QkFBcUIsQ0FBQSxJQUFDLG1LQUN0QixlQUFBLDZCQUFxQixDQUFBLElBREM7SUFNdkMsMEZBQWtFO0lBQ3BFLGlCQUFJOzs7O0lBUkYsd0NBQW1CLHdGQUFBLDBCQUFBO0lBRG5CLDBDQUF5QjtJQVFWLGNBQWtDO0lBQWxDLHNDQUFrQzs7O0lBZWpELHdCQUFrRTs7OztJQVpwRSw0QkFXQztJQUxDLGlMQUFpQixlQUFBLDZCQUFxQixDQUFBLElBQUMsb0tBQ3RCLGVBQUEsNkJBQXFCLENBQUEsSUFEQztJQU12QywwRkFBa0U7SUFDcEUsaUJBQUk7Ozs7SUFSRixvREFBYSx3RkFBQSwwQkFBQTtJQURiLDBDQUF5QjtJQVFWLGNBQWtDO0lBQWxDLHNDQUFrQzs7O0lBZWpELHdCQUFrRTs7OztJQVpwRSw0QkFXQztJQUxDLGlMQUFpQixlQUFBLDZCQUFxQixDQUFBLElBQUMsb0tBQ3RCLGVBQUEsNkJBQXFCLENBQUEsSUFEQztJQU12QywwRkFBa0U7SUFDcEUs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QUsxQixjQUF5QjtZQUF6Qiw4Q0FBeUI7aUtENUJmLG1CQUFtQjs7aUZBQW5CLG1CQUFtQjtjQUovQixTQUFTOzJCQUNFLGNBQWM7bURBS0wsTUFBTTtrQkFBeEIsS0FBSzttQkFBQyxVQUFVO1lBR08sVUFBVTtrQkFBakMsS0FBSzttQkFBQyxlQUFlO1lBR0UsVUFBVTtrQkFBakMsS0FBSzttQkFBQyxlQUFlO1lBR0ssYUFBYTtrQkFBdkMsS0FBSzttQkFBQyxrQkFBa0I7WUFHUixJQUFJO2tCQUFwQixLQUFLO21CQUFDLFFBQVE7WUFHQSxFQUFFO2tCQUFoQixLQUFLO21CQUFDLE1BQU07WUFHUyxRQUFRO2tCQUE3QixLQUFLO21CQUFDLGFBQWE7WUFHRixLQUFLO2tCQUF0QixLQUFLO21CQUFDLFNBQVM7WUFHRSxLQUFLO2tCQUF0QixLQUFLO21CQUFDLFNBQVM7WUFHQyxJQUFJO2tCQUFwQixLQUFLO21CQUFDLFFBQVE7WUFHUyxVQUFVO2tCQUFqQyxLQUFLO21CQUFDLGVBQWU7WUFHTCxJQUFJO2tCQUFwQixLQUFLO21CQUFDLFFBQVE7WUFFWSxZQUFZO2tCQUF0QyxTQUFTO21CQUFDLGNBQWM7WUFZRyxVQUFVO2tCQUFyQyxLQUFLO21CQUFDLGVBQWU7WUFTTSxVQUFVO2tCQUFyQyxLQUFLO21CQUFDLGVBQWU7WUFVTSxTQUFTO2tCQUFwQyxLQUFLO21CQUFDLGVBQWU7WUFTSSxRQUFRO2tCQUFqQyxLQUFLO21CQUFDLGFBQWE7O2tGQTdFVCxtQkFBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIElucHV0LCBPbkRlc3Ryb3ksIE9uSW5pdCwgVGVtcGxhdGVSZWYsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgY29udmVydFRvSW50LCBjb252ZXJ0VG9Cb29sZWFuIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbCc7XG5cbmltcG9ydCB7IFBvTWVudUl0ZW0gfSBmcm9tICcuLi9wby1tZW51LWl0ZW0uaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvTWVudUl0ZW1zU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3BvLW1lbnUtaXRlbXMuc2VydmljZSc7XG5cbi8vIHZhbG9yIHBhcmEgcXVlIGNhaWJhbSAzIGxpbmhhcyBkZSBgbGFiZWxgXG5jb25zdCBwb01lbnVJdGVtU3ViSXRlbVNpemUgPSA5ODtcblxuLyoqXG4gKiBAZG9jc1ByaXZhdGVcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBDb21wb25lbnRlIHF1ZSBpbXBsZW1lbnRhIGNhZGEgaXRlbSBkbyBwby1tZW51LlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdwby1tZW51LWl0ZW0nLFxuICB0ZW1wbGF0ZVVybDogJy4vcG8tbWVudS1pdGVtLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBQb01lbnVJdGVtQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95LCBPbkluaXQge1xuICAvLyBBw6fDo28gcXVlIHNlcsOhIGNoYW1hZGEgYW8gY2xpY2FyIG5vIGl0ZW0uXG4gIEBJbnB1dCgncC1hY3Rpb24nKSBhY3Rpb246IEZ1bmN0aW9uO1xuXG4gIC8vIEluZGljYSBzZSBjb250w6ltIGFsZ3VtIGl0ZW0gZmlsaG8gY29tIG8gYmFkZ2UuXG4gIEBJbnB1dCgncC1iYWRnZS1hbGVydCcpIGJhZGdlQWxlcnQ6IGJvb2xlYW47XG5cbiAgLy8gQ29yIGRvIGJhZGdlLlxuICBASW5wdXQoJ3AtYmFkZ2UtY29sb3InKSBiYWRnZUNvbG9yOiBzdHJpbmc7XG5cbiAgLy8gSW5kaWNhIHNlIG8gbWVudSBlc3TDoSBjb2xhcHNhZG9cbiAgQElucHV0KCdwLWNvbGxhcHNlZC1tZW51JykgY29sbGFwc2VkTWVudTogYm9vbGVhbjtcblxuICAvLyDDjWNvbmUgZGUgbWVudVxuICBASW5wdXQoJ3AtaWNvbicpIGljb246IHN0cmluZyB8IFRlbXBsYXRlUmVmPHZvaWQ+O1xuXG4gIC8vIElkZW50aWZpY2Fkb3IgZG8gaXRlbS5cbiAgQElucHV0KCdwLWlkJykgaWQ6IHN0cmluZztcblxuICAvLyBJbmRpY2Egc2UgbyBpdGVtIGVzdMOhIGFiZXJ0byAobWVudSBhZ3J1cGFkbylcbiAgQElucHV0KCdwLWlzLW9wZW5lZCcpIGlzT3BlbmVkOiBib29sZWFuO1xuXG4gIC8vIFRleHRvIHF1ZSBhcGFyZWNlcsOhIHJlcHJlc2VudGFuZG8gbyBpdGVtLlxuICBASW5wdXQoJ3AtbGFiZWwnKSBsYWJlbDogc3RyaW5nO1xuXG4gIC8vIEluZGljYSBxdWFsIGVtIG7DrXZlbCBkbyBwby1tZW51IGVuY29udHJhLXNlLlxuICBASW5wdXQoJ3AtbGV2ZWwnKSBsZXZlbDogbnVtYmVyO1xuXG4gIC8vIExpbmsgZG8gaXRlbS5cbiAgQElucHV0KCdwLWxpbmsnKSBsaW5rPzogc3RyaW5nO1xuXG4gIC8vIFRleHRvIHF1ZSBhcGFyZWNlcsOhIHJlcHJlc2VudGFuZG8gbyBpdGVtLlxuICBASW5wdXQoJ3Atc2hvcnQtbGFiZWwnKSBzaG9ydExhYmVsOiBzdHJpbmc7XG5cbiAgLy8gSW5kaWNhIG8gdGlwbyBkZSBpdGVtLCBjb21vICdpbnRlcm5hbExpbmsnIG91ICdzdWJJdGVtcycuXG4gIEBJbnB1dCgncC10eXBlJykgdHlwZTogc3RyaW5nO1xuXG4gIEBWaWV3Q2hpbGQoJ21lbnVTdWJJdGVtcycpIG1lbnVTdWJJdGVtczogRWxlbWVudFJlZjtcblxuICBpc1NlbGVjdGVkU3ViSXRlbTtcbiAgbWF4SGVpZ2h0OiBudW1iZXIgPSAwO1xuXG4gIHByaXZhdGUgaXRlbVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBwcml2YXRlIF9iYWRnZVZhbHVlOiBudW1iZXI7XG4gIHByaXZhdGUgX2lzU2VsZWN0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfaXNTdWJJdGVtOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgX3N1Ykl0ZW1zOiBBcnJheTxQb01lbnVJdGVtPjtcblxuICAvLyBWYWxvciBkbyBiYWRnZS5cbiAgQElucHV0KCdwLWJhZGdlLXZhbHVlJykgc2V0IGJhZGdlVmFsdWUoYmFkZ2VWYWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5fYmFkZ2VWYWx1ZSA9IGNvbnZlcnRUb0ludChiYWRnZVZhbHVlKTtcbiAgfVxuXG4gIGdldCBiYWRnZVZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLl9iYWRnZVZhbHVlO1xuICB9XG5cbiAgLy8gSW5kaWNhIHNlIG8gaXRlbSBlc3TDoSBzZWxlY2lvbmFkby5cbiAgQElucHV0KCdwLWlzLXNlbGVjdGVkJykgc2V0IGlzU2VsZWN0ZWQodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9pc1NlbGVjdGVkID0gY29udmVydFRvQm9vbGVhbih2YWx1ZSk7XG5cbiAgICB0aGlzLmlzU2VsZWN0ZWRTdWJJdGVtID0gdGhpcy5pc1NlbGVjdGVkICYmIHRoaXMuaXNTdWJJdGVtO1xuICB9XG4gIGdldCBpc1NlbGVjdGVkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc1NlbGVjdGVkO1xuICB9XG5cbiAgLy8gSW5kaWNhIHNlIG8gaXRlbSDDqSB1bSBzdWIgaXRlbVxuICBASW5wdXQoJ3AtaXMtc3ViLWl0ZW0nKSBzZXQgaXNTdWJJdGVtKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5faXNTdWJJdGVtID0gY29udmVydFRvQm9vbGVhbih2YWx1ZSk7XG4gIH1cblxuICBnZXQgaXNTdWJJdGVtKCkge1xuICAgIHJldHVybiB0aGlzLl9pc1N1Ykl0ZW07XG4gIH1cblxuICAvLyBMaXN0YSBkZSBzdWItaXRlbXMuXG4gIEBJbnB1dCgncC1zdWItaXRlbXMnKSBzZXQgc3ViSXRlbXMoc3ViaXRlbXM6IEFycmF5PFBvTWVudUl0ZW0+KSB7XG4gICAgdGhpcy5fc3ViSXRlbXMgPSBzdWJpdGVtcztcbiAgICBpZiAodGhpcy5pc09wZW5lZCkge1xuICAgICAgdGhpcy5jYWxjTWVudVN1Ykl0ZW1zTWF4SGVpZ2h0KCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHN1Ykl0ZW1zKCkge1xuICAgIHJldHVybiB0aGlzLl9zdWJJdGVtcztcbiAgfVxuXG4gIGdldCBjYW5TaG93QmFkZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMudHlwZSAhPT0gJ3N1Ykl0ZW1zJyAmJiAodGhpcy5iYWRnZVZhbHVlIHx8IHRoaXMuYmFkZ2VWYWx1ZSA9PT0gMCkgJiYgdGhpcy5iYWRnZVZhbHVlID49IDA7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lbnVJdGVtc1NlcnZpY2U6IFBvTWVudUl0ZW1zU2VydmljZSkge31cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLml0ZW1TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIC8vIHN1YnNjcmliZSB0byBtZW51IGNvbXBvbmVudCBtZXNzYWdlc1xuICAgIHRoaXMuaXRlbVN1YnNjcmlwdGlvbiA9IHRoaXMubWVudUl0ZW1zU2VydmljZS5yZWNlaXZlRnJvbVBhcmVudE1lbnVDbGlja2VkKCkuc3Vic2NyaWJlKG1lbnUgPT4ge1xuICAgICAgdGhpcy5wcm9jZXNzTWVudUl0ZW0obWVudSk7XG4gICAgfSk7XG4gIH1cblxuICBjbGlja01lbnVJdGVtKGV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCEoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5KSkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgLy8gRW1taXQgdG8gcGFyZW50XG4gICAgICB0aGlzLm1lbnVJdGVtc1NlcnZpY2Uuc2VuZFRvUGFyZW50TWVudUNsaWNrZWQoe1xuICAgICAgICBsaW5rOiB0aGlzLmxpbmssXG4gICAgICAgIGFjdGlvbjogdGhpcy5hY3Rpb24sXG4gICAgICAgIGlkOiB0aGlzLmlkLFxuICAgICAgICBpY29uOiB0aGlzLmljb24sXG4gICAgICAgIGxhYmVsOiB0aGlzLmxhYmVsLFxuICAgICAgICBsZXZlbDogdGhpcy5sZXZlbCxcbiAgICAgICAgc3ViSXRlbXM6IHRoaXMuc3ViSXRlbXMsXG4gICAgICAgIGlzU2VsZWN0ZWQ6IHRoaXMuaXNTZWxlY3RlZCxcbiAgICAgICAgaXNPcGVuZWQ6IHRoaXMuaXNPcGVuZWQsXG4gICAgICAgIHNob3J0TGFiZWw6IHRoaXMuc2hvcnRMYWJlbCxcbiAgICAgICAgdHlwZTogdGhpcy50eXBlXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFjY29yZGlvbkFuaW1hdGlvbihcbiAgICBtZW51QWN0aXZlOiBQb01lbnVJdGVtLFxuICAgIG1lbnVPcGVuZWQ6IFBvTWVudUl0ZW0sXG4gICAgaGFzU3ViSXRlbU9wZW5lZDogYm9vbGVhbixcbiAgICBhY3RpdmF0ZWRCeVJvdXRlOiBib29sZWFuXG4gICkge1xuICAgIGlmICh0aGlzLmlkID09PSBtZW51T3BlbmVkWydpZCddKSB7XG4gICAgICB0aGlzLm1heEhlaWdodCA9IHRoaXMuc3ViSXRlbXMubGVuZ3RoICogcG9NZW51SXRlbVN1Ykl0ZW1TaXplO1xuICAgIH1cblxuICAgIGlmIChoYXNTdWJJdGVtT3BlbmVkKSB7XG4gICAgICB0aGlzLm1heEhlaWdodCA9IG1lbnVPcGVuZWRbJ2lzT3BlbmVkJ11cbiAgICAgICAgPyB0aGlzLm1heEhlaWdodCArIG1lbnVPcGVuZWQuc3ViSXRlbXMubGVuZ3RoICogcG9NZW51SXRlbVN1Ykl0ZW1TaXplXG4gICAgICAgIDogdGhpcy5tYXhIZWlnaHQgLSBtZW51T3BlbmVkLnN1Ykl0ZW1zLmxlbmd0aCAqIHBvTWVudUl0ZW1TdWJJdGVtU2l6ZTtcblxuICAgICAgaWYgKGFjdGl2YXRlZEJ5Um91dGUpIHtcbiAgICAgICAgdGhpcy5tYXhIZWlnaHQgPSB0aGlzLmdldE1pbmltdW1IZWlnaHQoMCwgdGhpcywgbWVudUFjdGl2ZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhY3RpdmF0ZU1lbnUobWVudTogYW55KTogdm9pZCB7XG4gICAgdGhpcy5pc1NlbGVjdGVkID0gbWVudSAmJiB0aGlzLmlkID09PSBtZW51LmlkO1xuICB9XG5cbiAgcHJpdmF0ZSBjYWxjTWVudVN1Ykl0ZW1zTWF4SGVpZ2h0KCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgY29uc3Qgc3ViSXRlbXMgPSBBcnJheS5mcm9tKHRoaXMubWVudVN1Ykl0ZW1zLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvLW1lbnUtaXRlbScpKTtcbiAgICAgIHN1Ykl0ZW1zLmZvckVhY2goKG1lbnVJdGVtOiBhbnkpID0+ICh0aGlzLm1heEhlaWdodCArPSBtZW51SXRlbS5vZmZzZXRIZWlnaHQpKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWluaW11bUhlaWdodChtaW5pbXVtSGVpZ2h0OiBudW1iZXIsIG1lbnVJdGVtOiBQb01lbnVJdGVtLCBtZW51QWN0aXZlOiBQb01lbnVJdGVtKSB7XG4gICAgbWluaW11bUhlaWdodCArPSBwb01lbnVJdGVtU3ViSXRlbVNpemU7XG5cbiAgICBpZiAobWVudUl0ZW0uc3ViSXRlbXMgJiYgdGhpcy5oYXNTdWJJdGVtKG1lbnVJdGVtLnN1Ykl0ZW1zLCBtZW51QWN0aXZlWydpZCddKSkge1xuICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IG1lbnVJdGVtLnN1Ykl0ZW1zLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICBtaW5pbXVtSGVpZ2h0ID0gdGhpcy5nZXRNaW5pbXVtSGVpZ2h0KG1pbmltdW1IZWlnaHQsIG1lbnVJdGVtLnN1Ykl0ZW1zW2luZGV4XSwgbWVudUFjdGl2ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG1pbmltdW1IZWlnaHQ7XG4gIH1cblxuICBwcml2YXRlIGdyb3VwZWRNZW51KG1lbnVBY3RpdmU6IFBvTWVudUl0ZW0sIG1lbnVPcGVuZWQ6IFBvTWVudUl0ZW0sIGFjdGl2YXRlZEJ5Um91dGU6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuICAgIGNvbnN0IGhhc1N1Ykl0ZW1PcGVuZWQgPVxuICAgICAgbWVudU9wZW5lZCAmJiB0aGlzLmlkICE9PSBtZW51T3BlbmVkWydpZCddID8gdGhpcy5oYXNTdWJJdGVtKHRoaXMuc3ViSXRlbXMsIG1lbnVPcGVuZWRbJ2lkJ10pIDogZmFsc2U7XG5cbiAgICB0aGlzLmlzT3BlbmVkID0gdGhpcy5pc01lbnVPcGVuZWQobWVudU9wZW5lZCwgaGFzU3ViSXRlbU9wZW5lZCk7XG5cbiAgICB0aGlzLmlzU2VsZWN0ZWQgPSBtZW51QWN0aXZlICYmICF0aGlzLmlzT3BlbmVkID8gdGhpcy5oYXNTdWJJdGVtKHRoaXMuc3ViSXRlbXMsIG1lbnVBY3RpdmVbJ2lkJ10pIDogZmFsc2U7XG5cbiAgICBpZiAoIXRoaXMuaXNPcGVuZWQpIHtcbiAgICAgIHRoaXMubWF4SGVpZ2h0ID0gMDtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmFjY29yZGlvbkFuaW1hdGlvbihtZW51QWN0aXZlLCBtZW51T3BlbmVkLCBoYXNTdWJJdGVtT3BlbmVkLCBhY3RpdmF0ZWRCeVJvdXRlKTtcbiAgfVxuXG4gIHByaXZhdGUgaGFzU3ViSXRlbShzdWJJdGVtczogQXJyYXk8UG9NZW51SXRlbT4sIGlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoc3ViSXRlbXMpIHtcbiAgICAgIHJldHVybiBzdWJJdGVtcy5zb21lKGl0ZW0gPT4gKGl0ZW1bJ2lkJ10gPT09IGlkID8gdHJ1ZSA6IHRoaXMuaGFzU3ViSXRlbShpdGVtLnN1Ykl0ZW1zLCBpZCkpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGlzTWVudU9wZW5lZChtZW51T3BlbmVkOiBQb01lbnVJdGVtLCBoYXNTdWJJdGVtT3BlbmVkOiBib29sZWFuKTogYm9vbGVhbiB7XG4gICAgaWYgKG1lbnVPcGVuZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLmlkID09PSBtZW51T3BlbmVkWydpZCddID8gbWVudU9wZW5lZFsnaXNPcGVuZWQnXSA6IGhhc1N1Ykl0ZW1PcGVuZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSBwcm9jZXNzTWVudUl0ZW0obWVudSkge1xuICAgIGlmICh0aGlzLnR5cGUgPT09ICdpbnRlcm5hbExpbmsnKSB7XG4gICAgICB0aGlzLmFjdGl2YXRlTWVudShtZW51LmFjdGl2ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gJ3N1Ykl0ZW1zJykge1xuICAgICAgdGhpcy5ncm91cGVkTWVudShtZW51LmFjdGl2ZSwgbWVudS5ncm91cGVkLCBtZW51LmFjdGl2YXRlZEJ5Um91dGUpO1xuICAgIH1cbiAgfVxufVxuIiwiPCEtLSBtZW51IGNvbSBsaW5rIGludGVybm8gLS0+XG48YVxuICAqbmdJZj1cInR5cGUgPT09ICdpbnRlcm5hbExpbmsnXCJcbiAgY2xhc3M9XCJwby1tZW51LWl0ZW0tbGlua1wiXG4gIHJvbGU9XCJtZW51aXRlbVwiXG4gIFthdHRyLmFyaWEtbGFiZWxdPVwibGFiZWxcIlxuICBbcm91dGVyTGlua109XCJsaW5rXCJcbiAgKGtleWRvd24uZW50ZXIpPVwiY2xpY2tNZW51SXRlbSgkZXZlbnQpXCJcbiAgKGtleWRvd24uc3BhY2UpPVwiY2xpY2tNZW51SXRlbSgkZXZlbnQpXCJcbiAgcC10b29sdGlwLXBvc2l0aW9uPVwicmlnaHRcIlxuICBbcC10b29sdGlwXT1cImNvbGxhcHNlZE1lbnUgJiYgc2hvcnRMYWJlbCA/IHNob3J0TGFiZWwgOiB1bmRlZmluZWRcIlxuICBbcC1hcHBlbmQtaW4tYm9keV09XCJ0cnVlXCJcbj5cbiAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm1lbnVJdGVtVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cbjwvYT5cbjwhLS0gbWVudSBjb20gbGluayBleHRlcm5vIC0tPlxuPGFcbiAgKm5nSWY9XCJ0eXBlID09PSAnZXh0ZXJuYWxMaW5rJ1wiXG4gIGNsYXNzPVwicG8tbWVudS1pdGVtLWxpbmtcIlxuICByb2xlPVwibWVudWl0ZW1cIlxuICBbYXR0ci5hcmlhLWxhYmVsXT1cImxhYmVsXCJcbiAgW2hyZWZdPVwibGlua1wiXG4gIChrZXlkb3duLmVudGVyKT1cImNsaWNrTWVudUl0ZW0oJGV2ZW50KVwiXG4gIChrZXlkb3duLnNwYWNlKT1cImNsaWNrTWVudUl0ZW0oJGV2ZW50KVwiXG4gIHAtdG9vbHRpcC1wb3NpdGlvbj1cInJpZ2h0XCJcbiAgW3AtdG9vbHRpcF09XCJjb2xsYXBzZWRNZW51ICYmIHNob3J0TGFiZWwgPyBzaG9ydExhYmVsIDogdW5kZWZpbmVkXCJcbiAgW3AtYXBwZW5kLWluLWJvZHldPVwidHJ1ZVwiXG4+XG4gIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJtZW51SXRlbVRlbXBsYXRlXCI+PC9uZy1jb250YWluZXI+XG48L2E+XG48IS0tIG1lbnUgc2VtIGxpbmsgLS0+XG48YVxuICAqbmdJZj1cInR5cGUgPT09ICdub0xpbmsnXCJcbiAgY2xhc3M9XCJwby1tZW51LWl0ZW0tbGlua1wiXG4gIGhyZWY9XCJqYXZhc2NyaXB0OjtcIlxuICByb2xlPVwibWVudWl0ZW1cIlxuICBbYXR0ci5hcmlhLWxhYmVsXT1cImxhYmVsXCJcbiAgKGtleWRvd24uZW50ZXIpPVwiY2xpY2tNZW51SXRlbSgkZXZlbnQpXCJcbiAgKGtleWRvd24uc3BhY2UpPVwiY2xpY2tNZW51SXRlbSgkZXZlbnQpXCJcbiAgcC10b29sdGlwLXBvc2l0aW9uPVwicmlnaHRcIlxuICBbcC10b29sdGlwXT1cImNvbGxhcHNlZE1lbnUgJiYgc2hvcnRMYWJlbCA/IHNob3J0TGFiZWwgOiB1bmRlZmluZWRcIlxuICBbcC1hcHBlbmQtaW4tYm9keV09XCJ0cnVlXCJcbj5cbiAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm1lbnVJdGVtVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cbjwvYT5cbjwhLS0gbWVudSBzZW0gZGFkb3MgLS0+XG48ZGl2ICpuZ0lmPVwidHlwZSA9PT0gJ25vRGF0YSdcIiBjbGFzcz1cInBvLW1lbnUtaXRlbS1saW5rXCIgcm9sZT1cIm5vbmVcIj5cbiAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm1lbnVJdGVtVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cbjwvZGl2PlxuPCEtLSBtZW51IGNvbSBzdWIgaXRlbnMgLS0+XG48ZGl2XG4gICpuZ0lmPVwidHlwZSA9PT0gJ3N1Ykl0ZW1zJ1wiXG4gIGNsYXNzPVwicG8tbWVudS1pdGVtLWxpbmsgcG8tY2xpY2thYmxlXCJcbiAgcm9sZT1cIm1lbnVpdGVtXCJcbiAgW2F0dHIuYXJpYS1leHBhbmRlZF09XCJpc09wZW5lZCA/IHRydWUgOiBmYWxzZVwiXG4+XG4gIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJtZW51SXRlbVRlbXBsYXRlXCI+PC9uZy1jb250YWluZXI+XG5cbiAgPGRpdlxuICAgICNtZW51U3ViSXRlbXNcbiAgICBjbGFzcz1cInBvLW1lbnUtc3ViLWl0ZW1zXCJcbiAgICBbaGlkZGVuXT1cImNvbGxhcHNlZE1lbnUgfHwgIWlzT3BlbmVkXCJcbiAgICBbYXR0ci5hcmlhLWV4cGFuZGVkXT1cImlzT3BlbmVkID8gdHJ1ZSA6IGZhbHNlXCJcbiAgICBbYXR0ci5hcmlhLWhpZGRlbl09XCIhaXNPcGVuZWQgPyB0cnVlIDogZmFsc2VcIlxuICAgIHJvbGU9XCJncm91cFwiXG4gICAgW3N0eWxlLm1heEhlaWdodC5weF09XCJtYXhIZWlnaHRcIlxuICA+XG4gICAgPHVsIGNsYXNzPVwicG8tbWVudS1zdWItaXRlbXMtbGlzdFwiPlxuICAgICAgPGxpIGNsYXNzPVwicG8tbWVudS1zdWItaXRlbXMtbGlzdC1pdGVtXCIgKm5nRm9yPVwibGV0IHN1Ykl0ZW0gb2Ygc3ViSXRlbXNcIiBbYXR0ci5hcmlhLWxldmVsXT1cInN1Ykl0ZW0ubGV2ZWxcIj5cbiAgICAgICAgPHBvLW1lbnUtaXRlbVxuICAgICAgICAgIHAtaXMtc3ViLWl0ZW1cbiAgICAgICAgICBbcC1hY3Rpb25dPVwic3ViSXRlbS5hY3Rpb25cIlxuICAgICAgICAgIFtwLWJhZGdlLWFsZXJ0XT1cInN1Ykl0ZW0uYmFkZ2VBbGVydFwiXG4gICAgICAgICAgW3AtYmFkZ2UtY29sb3JdPVwic3ViSXRlbS5iYWRnZSA/IHN1Ykl0ZW0uYmFkZ2UuY29sb3IgOiB1bmRlZmluZWRcIlxuICAgICAgICAgIFtwLWJhZGdlLXZhbHVlXT1cInN1Ykl0ZW0uYmFkZ2UgPyBzdWJJdGVtLmJhZGdlLnZhbHVlIDogdW5kZWZpbmVkXCJcbiAgICAgICAgICBbcC1pZF09XCJzdWJJdGVtLmlkXCJcbiAgICAgICAgICBbcC1sYWJlbF09XCJzdWJJdGVtLmxhYmVsXCJcbiAgICAgICAgICBbcC1sZXZlbF09XCJzdWJJdGVtLmxldmVsXCJcbiAgICAgICAgICBbcC1saW5rXT1cInN1Ykl0ZW0ubGlua1wiXG4gICAgICAgICAgW3Atc3ViLWl0ZW1zXT1cInN1Ykl0ZW0uc3ViSXRlbXNcIlxuICAgICAgICAgIFtwLXR5cGVdPVwic3ViSXRlbS50eXBlXCJcbiAgICAgICAgPjwvcG8tbWVudS1pdGVtPlxuICAgICAgPC9saT5cbiAgICA8L3VsPlxuICA8L2Rpdj5cbjwvZGl2PlxuXG48bmctdGVtcGxhdGUgI21lbnVJdGVtVGVtcGxhdGU+XG4gIDxkaXZcbiAgICBwLXRvb2x0aXAtcG9zaXRpb249XCJyaWdodFwiXG4gICAgW3AtdG9vbHRpcF09XCJ0eXBlID09PSAnc3ViSXRlbXMnICYmIGNvbGxhcHNlZE1lbnUgJiYgc2hvcnRMYWJlbCA/IHNob3J0TGFiZWwgOiB1bmRlZmluZWRcIlxuICAgIFtwLWFwcGVuZC1pbi1ib2R5XT1cInRydWVcIlxuICAgIGNsYXNzPVwicG8tbWVudS1pdGVtXCJcbiAgICBbdGFiaW5kZXhdPVwidHlwZSA9PT0gJ3N1Ykl0ZW1zJyA/IDAgOiAtMVwiXG4gICAgW2F0dHIuYXJpYS1sYWJlbF09XCJsYWJlbFwiXG4gICAgW2F0dHIuYXJpYS1oaWRkZW5dPVwidHlwZSA9PT0gJ3N1Ykl0ZW1zJyA/IGZhbHNlIDogdHJ1ZVwiXG4gICAgW2F0dHIucm9sZV09XCJ0eXBlID09PSAnc3ViSXRlbXMnID8gJ21lbnVpdGVtJyA6IHVuZGVmaW5lZFwiXG4gICAgW2NsYXNzLnBvLW1lbnUtaWNvbi1jb250YWluZXJdPVwibGV2ZWwgPT09IDEgJiYgaWNvblwiXG4gICAgW2NsYXNzLnBvLW1lbnUtaXRlbS1zZWxlY3RlZF09XCJpc1NlbGVjdGVkXCJcbiAgICBbY2xhc3MucG8tbWVudS1pdGVtLWxldmVsLXR3b109XCJsZXZlbCA9PT0gMlwiXG4gICAgW2NsYXNzLnBvLW1lbnUtaXRlbS1sZXZlbC10aHJlZV09XCJsZXZlbCA9PT0gM1wiXG4gICAgW2NsYXNzLnBvLW1lbnUtaXRlbS1sZXZlbC1mb3VyXT1cImxldmVsID09PSA0XCJcbiAgICBbY2xhc3MucG8tbWVudS1pdGVtLWdyb3VwZXItdXBdPVwidHlwZSA9PT0gJ3N1Ykl0ZW1zJyAmJiBpc09wZW5lZFwiXG4gICAgW2NsYXNzLnBvLW1lbnUtaXRlbS1ncm91cGVyLWRvd25dPVwidHlwZSA9PT0gJ3N1Ykl0ZW1zJyAmJiAhaXNPcGVuZWRcIlxuICAgIFtjbGFzcy5wby1tZW51LWl0ZW0tbm8tZGF0YV09XCJ0eXBlID09PSAnbm9EYXRhJ1wiXG4gICAgW2NsYXNzLnBvLW1lbnUtc3ViLWl0ZW0tc2VsZWN0ZWRdPVwiaXNTZWxlY3RlZFN1Ykl0ZW1cIlxuICAgIChjbGljayk9XCJjbGlja01lbnVJdGVtKCRldmVudClcIlxuICAgIChrZXlkb3duLmVudGVyKT1cImNsaWNrTWVudUl0ZW0oJGV2ZW50KVwiXG4gICAgKGtleWRvd24uc3BhY2UpPVwiY2xpY2tNZW51SXRlbSgkZXZlbnQpXCJcbiAgPlxuICAgIDxwby1pY29uICpuZ0lmPVwibGV2ZWwgPT09IDEgJiYgaWNvblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIGNsYXNzPVwicG8tbWVudS1pY29uLWl0ZW1cIiBbcC1pY29uXT1cImljb25cIj48L3BvLWljb24+XG5cbiAgICA8cG8taWNvblxuICAgICAgKm5nSWY9XCJ0eXBlID09PSAnc3ViSXRlbXMnICYmICFjb2xsYXBzZWRNZW51XCJcbiAgICAgIGNsYXNzPVwicG8tbWVudS1ncm91cC1pY29uXCJcbiAgICAgIFtwLWljb25dPVwiaXNPcGVuZWQgPyAnSUNPTl9BUlJPV19VUCBwby1maWVsZC1pY29uJyA6ICdJQ09OX0FSUk9XX0RPV04gcG8tZmllbGQtaWNvbidcIlxuICAgID48L3BvLWljb24+XG5cbiAgICA8c3BhbiBbY2xhc3MucG8tbWVudS1pY29uLWxhYmVsXT1cImxldmVsID09PSAxICYmIGljb25cIj5cbiAgICAgIHt7IGxhYmVsIH19XG4gICAgPC9zcGFuPlxuXG4gICAgPHBvLWJhZGdlXG4gICAgICAqbmdJZj1cImNhblNob3dCYWRnZVwiXG4gICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxuICAgICAgW25nQ2xhc3NdPVwiIWNvbGxhcHNlZE1lbnUgPyAncG8tbWVudS1iYWRnZS1hbGlnbicgOiAncG8tbWVudS1iYWRnZS1hbGlnbi1jb2xsYXBzZWQnXCJcbiAgICAgIFtwLWNvbG9yXT1cImJhZGdlQ29sb3JcIlxuICAgICAgW3AtdmFsdWVdPVwiYmFkZ2VWYWx1ZVwiXG4gICAgPjwvcG8tYmFkZ2U+XG5cbiAgICA8c3BhblxuICAgICAgKm5nSWY9XCJiYWRnZUFsZXJ0XCJcbiAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXG4gICAgICBjbGFzcz1cInBvLWNvbG9yLTA3XCJcbiAgICAgIFtuZ0NsYXNzXT1cIiFjb2xsYXBzZWRNZW51ID8gJ3BvLW1lbnUtYmFkZ2UtYWxlcnQnIDogJ3BvLW1lbnUtYmFkZ2UtYWxlcnQtY29sbGFwc2VkJ1wiXG4gICAgPjwvc3Bhbj5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuIl19