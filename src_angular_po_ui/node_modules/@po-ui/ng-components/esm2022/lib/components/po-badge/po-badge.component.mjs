import { Component, inject } from '@angular/core';
import { PoBadgeBaseComponent } from './po-badge-base.component';
import { PoBadgeLiteralsDefault } from './interfaces/po-badge-literals-default';
import { PoLanguageService } from '../../services/po-language/po-language.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "../po-icon/po-icon.component";
function PoBadgeComponent_po_icon_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "po-icon", 3);
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-icon", ctx_r0.badgeIcon);
} }
function PoBadgeComponent_span_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 4);
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance();
    i0.ɵɵtextInterpolate(ctx_r1.badgeValue);
} }
const _c0 = a0 => ({ "background-color": a0 });
const _c1 = () => ({});
const PO_BADGE_MAX_NOTIFICATIONS = 9;
/**
 * @docsExtends PoBadgeBaseComponent
 *
 * @example
 *
 * <example name="po-badge-basic" title="PO Badge Basic">
 *  <file name="sample-po-badge-basic/sample-po-badge-basic.component.html"> </file>
 *  <file name="sample-po-badge-basic/sample-po-badge-basic.component.ts"> </file>
 * </example>
 *
 * <example name="po-badge-labs" title="PO Badge Labs">
 *  <file name="sample-po-badge-labs/sample-po-badge-labs.component.html"> </file>
 *  <file name="sample-po-badge-labs/sample-po-badge-labs.component.ts"> </file>
 * </example>
 *
 * <example name="po-badge-message" title="PO Badge Message">
 *  <file name="sample-po-badge-message/sample-po-badge-message.component.html"> </file>
 *  <file name="sample-po-badge-message/sample-po-badge-message.component.css"> </file>
 *  <file name="sample-po-badge-message/sample-po-badge-message.component.ts"> </file>
 * </example>
 */
export class PoBadgeComponent extends PoBadgeBaseComponent {
    isNotification = false;
    notificationLabel = '';
    literals;
    badgeIcon = '';
    isValidValue = false;
    poLanguageService = inject(PoLanguageService);
    ngOnInit() {
        this.literals = PoBadgeLiteralsDefault[this.poLanguageService.getShortLanguage()];
        this.initialize();
    }
    ngOnChanges(changes) {
        if (changes['status'] || changes['icon']) {
            this.setStatus();
        }
        if (changes['value']) {
            this.setBadgeValue();
            this.setBadgeNotification(changes['value'].currentValue);
            this.setLiterals();
        }
    }
    initialize() {
        this.setStatus();
        this.setLiterals();
        this.setBadgeValue();
        this.setBadgeNotification(this.value);
    }
    getChangeStyle() {
        if ((this.color === 'color-07' && !this.customColor) || this.status) {
            return 'po-badge-default';
        }
        else if (this.color) {
            return `po-${this.color}`;
        }
    }
    setLiterals() {
        if (this.value) {
            this.notificationLabel =
                this.value > 1
                    ? `${this.ariaLabel ?? ''} ${this.value} ${this.literals?.notifications}`
                    : `${this.ariaLabel ?? ''} ${this.value} ${this.literals?.notification}`;
        }
        else {
            this.notificationLabel = `${this.ariaLabel ?? ''} ${this.literals?.notification}`;
        }
    }
    setStatus() {
        this.isNotification = false;
        this.badgeValue = null;
        this.switchIconStatus();
    }
    switchIconStatus() {
        if (typeof this.icon === 'boolean' && this.icon) {
            this.badgeIcon = '';
            if (['positive', 'negative', 'warning', 'disabled'].includes(this.status)) {
                switch (this.status) {
                    case 'positive':
                        this.badgeIcon = 'ICON_OK';
                        break;
                    case 'negative':
                        this.badgeIcon = 'ICON_MINUS';
                        break;
                    case 'warning':
                        this.badgeIcon = 'ICON_WARNING';
                        break;
                }
            }
        }
        else {
            this.badgeIcon = this.icon;
        }
    }
    setBadgeNotification(value) {
        if (value > 1 && !this.status) {
            this.isNotification = true;
            return true;
        }
        else {
            this.isNotification = false;
            this.badgeValue = null;
            return false;
        }
    }
    setBadgeValue() {
        if (this.value) {
            this.checkBadgeValue(this.value);
        }
    }
    checkBadgeValue(value) {
        this.isValidValue = Number.isInteger(value) && value >= 1;
        this.badgeValue = this.isValidValue ? this.formatBadgeValue(value) : '';
    }
    formatBadgeValue(value) {
        return value > PO_BADGE_MAX_NOTIFICATIONS ? '9+' : value.toString();
    }
    static ɵfac = /*@__PURE__*/ (() => { let ɵPoBadgeComponent_BaseFactory; return function PoBadgeComponent_Factory(t) { return (ɵPoBadgeComponent_BaseFactory || (ɵPoBadgeComponent_BaseFactory = i0.ɵɵgetInheritedFactory(PoBadgeComponent)))(t || PoBadgeComponent); }; })();
    static ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PoBadgeComponent, selectors: [["po-badge"]], features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], decls: 3, vars: 16, consts: [[3, "ariaLabel", "ngStyle"], [3, "p-icon", 4, "ngIf"], ["class", "po-badge-value", "aria-hidden", "true", 4, "ngIf"], [3, "p-icon"], ["aria-hidden", "true", 1, "po-badge-value"]], template: function PoBadgeComponent_Template(rf, ctx) { if (rf & 1) {
            i0.ɵɵelementStart(0, "div", 0);
            i0.ɵɵtemplate(1, PoBadgeComponent_po_icon_1_Template, 1, 1, "po-icon", 1)(2, PoBadgeComponent_span_2_Template, 2, 1, "span", 2);
            i0.ɵɵelementEnd();
        } if (rf & 2) {
            i0.ɵɵclassMapInterpolate2("", ctx.getChangeStyle(), " po-badge po-badge-", ctx.size ? ctx.size : "medium", "");
            i0.ɵɵclassProp("po-badge-notification", ctx.isNotification && !ctx.status)("po-badge-border", ctx.showBorder);
            i0.ɵɵproperty("ariaLabel", ctx.notificationLabel)("ngStyle", ctx.customColor && !ctx.status ? i0.ɵɵpureFunction1(13, _c0, ctx.customColor) : i0.ɵɵpureFunction0(15, _c1));
            i0.ɵɵattribute("data-status", ctx.status);
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", !ctx.isNotification && ctx.size !== "small" && ctx.badgeIcon && ctx.status !== "disabled");
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.value > 1);
        } }, dependencies: [i1.NgIf, i1.NgStyle, i2.PoIconComponent], styles: ["[_nghost-%COMP%]{display:inline-block;vertical-align:middle}"] });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoBadgeComponent, [{
        type: Component,
        args: [{ selector: 'po-badge', template: "<div\n  class=\"{{ getChangeStyle() }} po-badge po-badge-{{ size ? size : 'medium' }}\"\n  [class.po-badge-notification]=\"isNotification && !status\"\n  [class.po-badge-border]=\"showBorder\"\n  [attr.data-status]=\"status\"\n  [ariaLabel]=\"notificationLabel\"\n  [ngStyle]=\"customColor && !status ? { 'background-color': customColor } : {}\"\n>\n  <po-icon\n    *ngIf=\"!isNotification && size !== 'small' && badgeIcon && status !== 'disabled'\"\n    [p-icon]=\"badgeIcon\"\n  ></po-icon>\n  <span *ngIf=\"value > 1\" class=\"po-badge-value\" aria-hidden=\"true\">{{ badgeValue }}</span>\n</div>\n", styles: [":host{display:inline-block;vertical-align:middle}\n"] }]
    }], null, null); })();
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassDebugInfo(PoBadgeComponent, { className: "PoBadgeComponent", filePath: "lib/components/po-badge/po-badge.component.ts", lineNumber: 36 }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tYmFkZ2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdWkvc3JjL2xpYi9jb21wb25lbnRzL3BvLWJhZGdlL3BvLWJhZGdlLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpL3NyYy9saWIvY29tcG9uZW50cy9wby1iYWRnZS9wby1iYWRnZS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFvQyxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFcEYsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFFakUsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDaEYsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0RBQWdELENBQUM7Ozs7O0lDR2pGLDZCQUdXOzs7SUFEVCx5Q0FBb0I7OztJQUV0QiwrQkFBa0U7SUFBQSxZQUFnQjtJQUFBLGlCQUFPOzs7SUFBdkIsY0FBZ0I7SUFBaEIsdUNBQWdCOzs7O0FETHBGLE1BQU0sMEJBQTBCLEdBQUcsQ0FBQyxDQUFDO0FBRXJDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQW9CRztBQU1ILE1BQU0sT0FBTyxnQkFBaUIsU0FBUSxvQkFBb0I7SUFDeEQsY0FBYyxHQUFZLEtBQUssQ0FBQztJQUNoQyxpQkFBaUIsR0FBVyxFQUFFLENBQUM7SUFDL0IsUUFBUSxDQUFrQjtJQUMxQixTQUFTLEdBQVcsRUFBRSxDQUFDO0lBQ3ZCLFlBQVksR0FBWSxLQUFLLENBQUM7SUFFdEIsaUJBQWlCLEdBQUcsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFFdEQsUUFBUTtRQUNOLElBQUksQ0FBQyxRQUFRLEdBQUcsc0JBQXNCLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FB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RHVCWCxnQkFBZ0I7Y0FMNUIsU0FBUzsyQkFDRSxVQUFVOztrRkFJVCxnQkFBZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uQ2hhbmdlcywgT25Jbml0LCBTaW1wbGVDaGFuZ2VzLCBpbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgUG9CYWRnZUJhc2VDb21wb25lbnQgfSBmcm9tICcuL3BvLWJhZGdlLWJhc2UuY29tcG9uZW50JztcbmltcG9ydCB7IFBvQmFkZ2VMaXRlcmFscyB9IGZyb20gJy4vaW50ZXJmYWNlcy9wby1iYWRnZS1saXRlcmFscy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9CYWRnZUxpdGVyYWxzRGVmYXVsdCB9IGZyb20gJy4vaW50ZXJmYWNlcy9wby1iYWRnZS1saXRlcmFscy1kZWZhdWx0JztcbmltcG9ydCB7IFBvTGFuZ3VhZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcG8tbGFuZ3VhZ2UvcG8tbGFuZ3VhZ2Uuc2VydmljZSc7XG5cbmNvbnN0IFBPX0JBREdFX01BWF9OT1RJRklDQVRJT05TID0gOTtcblxuLyoqXG4gKiBAZG9jc0V4dGVuZHMgUG9CYWRnZUJhc2VDb21wb25lbnRcbiAqXG4gKiBAZXhhbXBsZVxuICpcbiAqIDxleGFtcGxlIG5hbWU9XCJwby1iYWRnZS1iYXNpY1wiIHRpdGxlPVwiUE8gQmFkZ2UgQmFzaWNcIj5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLWJhZGdlLWJhc2ljL3NhbXBsZS1wby1iYWRnZS1iYXNpYy5jb21wb25lbnQuaHRtbFwiPiA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS1wby1iYWRnZS1iYXNpYy9zYW1wbGUtcG8tYmFkZ2UtYmFzaWMuY29tcG9uZW50LnRzXCI+IDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwicG8tYmFkZ2UtbGFic1wiIHRpdGxlPVwiUE8gQmFkZ2UgTGFic1wiPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tYmFkZ2UtbGFicy9zYW1wbGUtcG8tYmFkZ2UtbGFicy5jb21wb25lbnQuaHRtbFwiPiA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS1wby1iYWRnZS1sYWJzL3NhbXBsZS1wby1iYWRnZS1sYWJzLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInBvLWJhZGdlLW1lc3NhZ2VcIiB0aXRsZT1cIlBPIEJhZGdlIE1lc3NhZ2VcIj5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLWJhZGdlLW1lc3NhZ2Uvc2FtcGxlLXBvLWJhZGdlLW1lc3NhZ2UuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tYmFkZ2UtbWVzc2FnZS9zYW1wbGUtcG8tYmFkZ2UtbWVzc2FnZS5jb21wb25lbnQuY3NzXCI+IDwvZmlsZT5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLWJhZGdlLW1lc3NhZ2Uvc2FtcGxlLXBvLWJhZGdlLW1lc3NhZ2UuY29tcG9uZW50LnRzXCI+IDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncG8tYmFkZ2UnLFxuICB0ZW1wbGF0ZVVybDogJy4vcG8tYmFkZ2UuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZXM6IFsnOmhvc3QgeyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IH0nXVxufSlcbmV4cG9ydCBjbGFzcyBQb0JhZGdlQ29tcG9uZW50IGV4dGVuZHMgUG9CYWRnZUJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG4gIGlzTm90aWZpY2F0aW9uOiBib29sZWFuID0gZmFsc2U7XG4gIG5vdGlmaWNhdGlvbkxhYmVsOiBzdHJpbmcgPSAnJztcbiAgbGl0ZXJhbHM6IFBvQmFkZ2VMaXRlcmFscztcbiAgYmFkZ2VJY29uOiBzdHJpbmcgPSAnJztcbiAgaXNWYWxpZFZhbHVlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBwb0xhbmd1YWdlU2VydmljZSA9IGluamVjdChQb0xhbmd1YWdlU2VydmljZSk7XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5saXRlcmFscyA9IFBvQmFkZ2VMaXRlcmFsc0RlZmF1bHRbdGhpcy5wb0xhbmd1YWdlU2VydmljZS5nZXRTaG9ydExhbmd1YWdlKCldO1xuXG4gICAgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgaWYgKGNoYW5nZXNbJ3N0YXR1cyddIHx8IGNoYW5nZXNbJ2ljb24nXSkge1xuICAgICAgdGhpcy5zZXRTdGF0dXMoKTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlc1sndmFsdWUnXSkge1xuICAgICAgdGhpcy5zZXRCYWRnZVZhbHVlKCk7XG4gICAgICB0aGlzLnNldEJhZGdlTm90aWZpY2F0aW9uKGNoYW5nZXNbJ3ZhbHVlJ10uY3VycmVudFZhbHVlKTtcbiAgICAgIHRoaXMuc2V0TGl0ZXJhbHMoKTtcbiAgICB9XG4gIH1cblxuICBpbml0aWFsaXplKCkge1xuICAgIHRoaXMuc2V0U3RhdHVzKCk7XG4gICAgdGhpcy5zZXRMaXRlcmFscygpO1xuICAgIHRoaXMuc2V0QmFkZ2VWYWx1ZSgpO1xuICAgIHRoaXMuc2V0QmFkZ2VOb3RpZmljYXRpb24odGhpcy52YWx1ZSk7XG4gIH1cblxuICBnZXRDaGFuZ2VTdHlsZSgpIHtcbiAgICBpZiAoKHRoaXMuY29sb3IgPT09ICdjb2xvci0wNycgJiYgIXRoaXMuY3VzdG9tQ29sb3IpIHx8IHRoaXMuc3RhdHVzKSB7XG4gICAgICByZXR1cm4gJ3BvLWJhZGdlLWRlZmF1bHQnO1xuICAgIH0gZWxzZSBpZiAodGhpcy5jb2xvcikge1xuICAgICAgcmV0dXJuIGBwby0ke3RoaXMuY29sb3J9YDtcbiAgICB9XG4gIH1cblxuICBzZXRMaXRlcmFscygpIHtcbiAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgdGhpcy5ub3RpZmljYXRpb25MYWJlbCA9XG4gICAgICAgIHRoaXMudmFsdWUgPiAxXG4gICAgICAgICAgPyBgJHt0aGlzLmFyaWFMYWJlbCA/PyAnJ30gJHt0aGlzLnZhbHVlfSAke3RoaXMubGl0ZXJhbHM/Lm5vdGlmaWNhdGlvbnN9YFxuICAgICAgICAgIDogYCR7dGhpcy5hcmlhTGFiZWwgPz8gJyd9ICR7dGhpcy52YWx1ZX0gJHt0aGlzLmxpdGVyYWxzPy5ub3RpZmljYXRpb259YDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ub3RpZmljYXRpb25MYWJlbCA9IGAke3RoaXMuYXJpYUxhYmVsID8/ICcnfSAke3RoaXMubGl0ZXJhbHM/Lm5vdGlmaWNhdGlvbn1gO1xuICAgIH1cbiAgfVxuXG4gIHNldFN0YXR1cygpIHtcbiAgICB0aGlzLmlzTm90aWZpY2F0aW9uID0gZmFsc2U7XG4gICAgdGhpcy5iYWRnZVZhbHVlID0gbnVsbDtcbiAgICB0aGlzLnN3aXRjaEljb25TdGF0dXMoKTtcbiAgfVxuXG4gIHN3aXRjaEljb25TdGF0dXMoKSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLmljb24gPT09ICdib29sZWFuJyAmJiB0aGlzLmljb24pIHtcbiAgICAgIHRoaXMuYmFkZ2VJY29uID0gJyc7XG5cbiAgICAgIGlmIChbJ3Bvc2l0aXZlJywgJ25lZ2F0aXZlJywgJ3dhcm5pbmcnLCAnZGlzYWJsZWQnXS5pbmNsdWRlcyh0aGlzLnN0YXR1cykpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnN0YXR1cykge1xuICAgICAgICAgIGNhc2UgJ3Bvc2l0aXZlJzpcbiAgICAgICAgICAgIHRoaXMuYmFkZ2VJY29uID0gJ0lDT05fT0snO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICduZWdhdGl2ZSc6XG4gICAgICAgICAgICB0aGlzLmJhZGdlSWNvbiA9ICdJQ09OX01JTlVTJztcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnd2FybmluZyc6XG4gICAgICAgICAgICB0aGlzLmJhZGdlSWNvbiA9ICdJQ09OX1dBUk5JTkcnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5iYWRnZUljb24gPSB0aGlzLmljb24gYXMgc3RyaW5nO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0QmFkZ2VOb3RpZmljYXRpb24odmFsdWU6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGlmICh2YWx1ZSA+IDEgJiYgIXRoaXMuc3RhdHVzKSB7XG4gICAgICB0aGlzLmlzTm90aWZpY2F0aW9uID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmlzTm90aWZpY2F0aW9uID0gZmFsc2U7XG4gICAgICB0aGlzLmJhZGdlVmFsdWUgPSBudWxsO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0QmFkZ2VWYWx1ZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgdGhpcy5jaGVja0JhZGdlVmFsdWUodGhpcy52YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjaGVja0JhZGdlVmFsdWUodmFsdWU6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuaXNWYWxpZFZhbHVlID0gTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkgJiYgdmFsdWUgPj0gMTtcbiAgICB0aGlzLmJhZGdlVmFsdWUgPSB0aGlzLmlzVmFsaWRWYWx1ZSA/IHRoaXMuZm9ybWF0QmFkZ2VWYWx1ZSh2YWx1ZSkgOiAnJztcbiAgfVxuXG4gIHByaXZhdGUgZm9ybWF0QmFkZ2VWYWx1ZSh2YWx1ZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdmFsdWUgPiBQT19CQURHRV9NQVhfTk9USUZJQ0FUSU9OUyA/ICc5KycgOiB2YWx1ZS50b1N0cmluZygpO1xuICB9XG59XG4iLCI8ZGl2XG4gIGNsYXNzPVwie3sgZ2V0Q2hhbmdlU3R5bGUoKSB9fSBwby1iYWRnZSBwby1iYWRnZS17eyBzaXplID8gc2l6ZSA6ICdtZWRpdW0nIH19XCJcbiAgW2NsYXNzLnBvLWJhZGdlLW5vdGlmaWNhdGlvbl09XCJpc05vdGlmaWNhdGlvbiAmJiAhc3RhdHVzXCJcbiAgW2NsYXNzLnBvLWJhZGdlLWJvcmRlcl09XCJzaG93Qm9yZGVyXCJcbiAgW2F0dHIuZGF0YS1zdGF0dXNdPVwic3RhdHVzXCJcbiAgW2FyaWFMYWJlbF09XCJub3RpZmljYXRpb25MYWJlbFwiXG4gIFtuZ1N0eWxlXT1cImN1c3RvbUNvbG9yICYmICFzdGF0dXMgPyB7ICdiYWNrZ3JvdW5kLWNvbG9yJzogY3VzdG9tQ29sb3IgfSA6IHt9XCJcbj5cbiAgPHBvLWljb25cbiAgICAqbmdJZj1cIiFpc05vdGlmaWNhdGlvbiAmJiBzaXplICE9PSAnc21hbGwnICYmIGJhZGdlSWNvbiAmJiBzdGF0dXMgIT09ICdkaXNhYmxlZCdcIlxuICAgIFtwLWljb25dPVwiYmFkZ2VJY29uXCJcbiAgPjwvcG8taWNvbj5cbiAgPHNwYW4gKm5nSWY9XCJ2YWx1ZSA+IDFcIiBjbGFzcz1cInBvLWJhZGdlLXZhbHVlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+e3sgYmFkZ2VWYWx1ZSB9fTwvc3Bhbj5cbjwvZGl2PlxuIl19