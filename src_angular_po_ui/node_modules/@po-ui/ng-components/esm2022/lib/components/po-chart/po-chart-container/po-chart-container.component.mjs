import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { PoChartType } from '../enums/po-chart-type.enum';
import * as i0 from "@angular/core";
import * as i1 from "../services/po-chart-maths.service";
import * as i2 from "@angular/common";
import * as i3 from "./po-chart-line/po-chart-area/po-chart-area.component";
import * as i4 from "./po-chart-axis/po-chart-axis.component";
import * as i5 from "./po-chart-line/po-chart-line.component";
import * as i6 from "./po-chart-circular/po-chart-pie/po-chart-pie.component";
import * as i7 from "./po-chart-circular/po-chart-donut/po-chart-donut.component";
import * as i8 from "./po-chart-bar/po-chart-bar.component";
import * as i9 from "./po-chart-bar/po-chart-column/po-chart-column.component";
const _c0 = ["svgELement"];
function PoChartContainerComponent__svg_g_2_Template(rf, ctx) { if (rf & 1) {
    const _r9 = i0.ɵɵgetCurrentView();
    i0.ɵɵnamespaceSVG();
    i0.ɵɵelementStart(0, "g", 9);
    i0.ɵɵlistener("p-categories-coordinates", function PoChartContainerComponent__svg_g_2_Template__svg_g_p_categories_coordinates_0_listener($event) { i0.ɵɵrestoreView(_r9); const ctx_r8 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r8.getCategoriesCoordinates($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-align-by-the-corners", ctx_r1.alignByTheCorners)("p-range", ctx_r1.range)("p-type", ctx_r1.type)("p-series", ctx_r1.series)("p-container-size", ctx_r1.containerSize)("p-options", ctx_r1.axisOptions)("p-categories", ctx_r1.categories);
} }
function PoChartContainerComponent__svg_g_3_Template(rf, ctx) { if (rf & 1) {
    const _r11 = i0.ɵɵgetCurrentView();
    i0.ɵɵnamespaceSVG();
    i0.ɵɵelementStart(0, "g", 10);
    i0.ɵɵlistener("p-bar-hover", function PoChartContainerComponent__svg_g_3_Template__svg_g_p_bar_hover_0_listener($event) { i0.ɵɵrestoreView(_r11); const ctx_r10 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r10.onSerieHover($event)); })("p-bar-click", function PoChartContainerComponent__svg_g_3_Template__svg_g_p_bar_click_0_listener($event) { i0.ɵɵrestoreView(_r11); const ctx_r12 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r12.onSerieClick($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-align-by-the-corners", ctx_r2.alignByTheCorners)("p-svg-space", ctx_r2.svgSpace)("p-categories", ctx_r2.categories)("p-categories-coordinates", ctx_r2.categoriesCoordinates)("p-range", ctx_r2.range)("p-series", ctx_r2.seriesByType["area"])("p-container-size", ctx_r2.containerSize);
} }
function PoChartContainerComponent__svg_g_4_Template(rf, ctx) { if (rf & 1) {
    const _r14 = i0.ɵɵgetCurrentView();
    i0.ɵɵnamespaceSVG();
    i0.ɵɵelementStart(0, "g", 11);
    i0.ɵɵlistener("p-bar-hover", function PoChartContainerComponent__svg_g_4_Template__svg_g_p_bar_hover_0_listener($event) { i0.ɵɵrestoreView(_r14); const ctx_r13 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r13.onSerieHover($event)); })("p-bar-click", function PoChartContainerComponent__svg_g_4_Template__svg_g_p_bar_click_0_listener($event) { i0.ɵɵrestoreView(_r14); const ctx_r15 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r15.onSerieClick($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-categories", ctx_r3.categories)("p-range", ctx_r3.range)("p-series", ctx_r3.seriesByType["column"])("p-container-size", ctx_r3.containerSize);
} }
function PoChartContainerComponent__svg_g_5_Template(rf, ctx) { if (rf & 1) {
    const _r17 = i0.ɵɵgetCurrentView();
    i0.ɵɵnamespaceSVG();
    i0.ɵɵelementStart(0, "g", 12);
    i0.ɵɵlistener("p-point-hover", function PoChartContainerComponent__svg_g_5_Template__svg_g_p_point_hover_0_listener($event) { i0.ɵɵrestoreView(_r17); const ctx_r16 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r16.onSerieHover($event)); })("p-point-click", function PoChartContainerComponent__svg_g_5_Template__svg_g_p_point_click_0_listener($event) { i0.ɵɵrestoreView(_r17); const ctx_r18 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r18.onSerieClick($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-categories", ctx_r4.categories)("p-range", ctx_r4.range)("p-series", ctx_r4.seriesByType["line"])("p-container-size", ctx_r4.containerSize);
} }
function PoChartContainerComponent__svg_g_6_Template(rf, ctx) { if (rf & 1) {
    const _r20 = i0.ɵɵgetCurrentView();
    i0.ɵɵnamespaceSVG();
    i0.ɵɵelementStart(0, "g", 13);
    i0.ɵɵlistener("p-bar-hover", function PoChartContainerComponent__svg_g_6_Template__svg_g_p_bar_hover_0_listener($event) { i0.ɵɵrestoreView(_r20); const ctx_r19 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r19.onSerieHover($event)); })("p-bar-click", function PoChartContainerComponent__svg_g_6_Template__svg_g_p_bar_click_0_listener($event) { i0.ɵɵrestoreView(_r20); const ctx_r21 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r21.onSerieClick($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-categories", ctx_r5.categories)("p-range", ctx_r5.range)("p-series", ctx_r5.seriesByType["bar"])("p-container-size", ctx_r5.containerSize);
} }
function PoChartContainerComponent__svg_g_7_Template(rf, ctx) { if (rf & 1) {
    const _r23 = i0.ɵɵgetCurrentView();
    i0.ɵɵnamespaceSVG();
    i0.ɵɵelementStart(0, "g", 14);
    i0.ɵɵlistener("p-circular-hover", function PoChartContainerComponent__svg_g_7_Template__svg_g_p_circular_hover_0_listener($event) { i0.ɵɵrestoreView(_r23); const ctx_r22 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r22.onSerieHover($event)); })("p-circular-click", function PoChartContainerComponent__svg_g_7_Template__svg_g_p_circular_click_0_listener($event) { i0.ɵɵrestoreView(_r23); const ctx_r24 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r24.onSerieClick($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r6 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-series", ctx_r6.seriesByType["pie"])("p-container-size", ctx_r6.containerSize);
} }
function PoChartContainerComponent__svg_g_8_Template(rf, ctx) { if (rf & 1) {
    const _r26 = i0.ɵɵgetCurrentView();
    i0.ɵɵnamespaceSVG();
    i0.ɵɵelementStart(0, "g", 15);
    i0.ɵɵlistener("p-circular-hover", function PoChartContainerComponent__svg_g_8_Template__svg_g_p_circular_hover_0_listener($event) { i0.ɵɵrestoreView(_r26); const ctx_r25 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r25.onSerieHover($event)); })("p-circular-click", function PoChartContainerComponent__svg_g_8_Template__svg_g_p_circular_click_0_listener($event) { i0.ɵɵrestoreView(_r26); const ctx_r27 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r27.onSerieClick($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r7 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-options", ctx_r7.options)("p-series", ctx_r7.seriesByType["donut"])("p-container-size", ctx_r7.containerSize);
} }
export class PoChartContainerComponent {
    mathsService;
    categories;
    type;
    containerSize;
    serieClick = new EventEmitter();
    serieHover = new EventEmitter();
    svgELement;
    alignByTheCorners;
    axisOptions;
    categoriesCoordinates;
    range;
    seriesByType;
    svgSpace;
    viewBox;
    _options;
    _series = [];
    set options(value) {
        if (value instanceof Object && !(value instanceof Array)) {
            this._options = value;
            this.verifyAxisOptions(this._options);
        }
    }
    get options() {
        return this._options;
    }
    set series(data) {
        this._series = data;
        this.setAlignByTheCorners(this._series);
        this.setSeriesByType(this._series);
        this.setRange(this._series, this.options);
    }
    get series() {
        return this._series;
    }
    get isTypeCircular() {
        return this.type === PoChartType.Pie || this.type === PoChartType.Donut;
    }
    constructor(mathsService) {
        this.mathsService = mathsService;
    }
    ngOnChanges(changes) {
        if (changes.type || changes.containerSize) {
            this.setViewBox();
            this.setSvgSpace();
        }
    }
    getCategoriesCoordinates(value) {
        this.categoriesCoordinates = value;
    }
    onSerieClick(event) {
        this.serieClick.emit(event);
    }
    onSerieHover(event) {
        this.serieHover.emit(event);
    }
    getRange(series, options = {}) {
        const domain = this.mathsService.calculateMinAndMaxValues(series);
        const minValue = !options.axis?.minRange && domain.minValue > 0
            ? 0
            : options.axis?.minRange < domain.minValue
                ? options.axis.minRange
                : domain.minValue;
        const maxValue = options.axis?.maxRange > domain.maxValue ? options.axis.maxRange : domain.maxValue;
        const updatedDomainValues = { minValue, maxValue };
        return { ...domain, ...updatedDomainValues };
    }
    setSvgSpace() {
        // Representa um ponto 2D dentro do viewport do SVG. Ele é a representação do cursor do mouse para comparação de coordenadas com cada dado de série.
        const svgPoint = this.svgELement.nativeElement.createSVGPoint();
        // Retorna um DOMMatrix representando as matrizes 2D e 3D transformadas a partir das coordenadas do elemento, em relação ao document, para coordenadas relativas ao viewport do SVG.
        // É utilizado nos gráficos do tipo área para que seja possível equiparar as coordenadas do evento com cada dado de série, para assim ativar o ponto de dado equivalente.
        const svgDomMatrix = this.svgELement.nativeElement.getScreenCTM()?.inverse();
        this.svgSpace = { svgPoint, svgDomMatrix };
    }
    setAlignByTheCorners(series) {
        this.alignByTheCorners = series.every(serie => serie.type === PoChartType.Area || serie.type === PoChartType.Bar);
    }
    setRange(series, options = {}) {
        if (!this.isTypeCircular) {
            this.range = this.getRange(series, options);
        }
    }
    setSeriesByType(series) {
        this.seriesByType = {
            [PoChartType.Area]: series.filter(serie => serie.type === PoChartType.Area),
            [PoChartType.Column]: series.filter(serie => serie.type === PoChartType.Column),
            [PoChartType.Bar]: series.filter(serie => serie.type === PoChartType.Bar),
            [PoChartType.Line]: series.filter(serie => serie.type === PoChartType.Line),
            [PoChartType.Donut]: series.filter(serie => serie.type === PoChartType.Donut),
            [PoChartType.Pie]: series.filter(serie => serie.type === PoChartType.Pie)
        };
    }
    setViewBox() {
        const { svgWidth, svgHeight } = this.containerSize;
        const viewBoxWidth = this.isTypeCircular ? svgHeight : svgWidth;
        // Tratamento necessário para que não corte o vetor nas extremidades
        const offsetXY = 1;
        this.viewBox = `${offsetXY} -${offsetXY} ${viewBoxWidth} ${this.containerSize.svgHeight}`;
    }
    verifyAxisOptions(options) {
        if (!this.isTypeCircular && options.hasOwnProperty('axis')) {
            this.range = this.getRange(this.series, this.options);
            this.axisOptions = {
                ...this.axisOptions,
                ...options.axis
            };
        }
    }
    static ɵfac = function PoChartContainerComponent_Factory(t) { return new (t || PoChartContainerComponent)(i0.ɵɵdirectiveInject(i1.PoChartMathsService)); };
    static ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PoChartContainerComponent, selectors: [["po-chart-container"]], viewQuery: function PoChartContainerComponent_Query(rf, ctx) { if (rf & 1) {
            i0.ɵɵviewQuery(_c0, 7);
        } if (rf & 2) {
            let _t;
            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.svgELement = _t.first);
        } }, inputs: { categories: [i0.ɵɵInputFlags.None, "p-categories", "categories"], type: [i0.ɵɵInputFlags.None, "p-type", "type"], containerSize: [i0.ɵɵInputFlags.None, "p-container-size", "containerSize"], options: [i0.ɵɵInputFlags.None, "p-options", "options"], series: [i0.ɵɵInputFlags.None, "p-series", "series"] }, outputs: { serieClick: "p-serie-click", serieHover: "p-serie-hover" }, features: [i0.ɵɵNgOnChangesFeature], decls: 9, vars: 10, consts: [["preserveAspectRatio", "xMidYMin meet", 1, "po-chart-svg-element"], ["svgELement", ""], ["po-chart-axis", "", 3, "p-align-by-the-corners", "p-range", "p-type", "p-series", "p-container-size", "p-options", "p-categories", "p-categories-coordinates", 4, "ngIf"], ["po-chart-area", "", 3, "p-align-by-the-corners", "p-svg-space", "p-categories", "p-categories-coordinates", "p-range", "p-series", "p-container-size", "p-bar-hover", "p-bar-click", 4, "ngIf"], ["po-chart-column", "", 3, "p-categories", "p-range", "p-series", "p-container-size", "p-bar-hover", "p-bar-click", 4, "ngIf"], ["po-chart-line", "", 3, "p-categories", "p-range", "p-series", "p-container-size", "p-point-hover", "p-point-click", 4, "ngIf"], ["po-chart-bar", "", 3, "p-categories", "p-range", "p-series", "p-container-size", "p-bar-hover", "p-bar-click", 4, "ngIf"], ["po-chart-pie", "", 3, "p-series", "p-container-size", "p-circular-hover", "p-circular-click", 4, "ngIf"], ["po-chart-donut", "", 3, "p-options", "p-series", "p-container-size", "p-circular-hover", "p-circular-click", 4, "ngIf"], ["po-chart-axis", "", 3, "p-align-by-the-corners", "p-range", "p-type", "p-series", "p-container-size", "p-options", "p-categories", "p-categories-coordinates"], ["po-chart-area", "", 3, "p-align-by-the-corners", "p-svg-space", "p-categories", "p-categories-coordinates", "p-range", "p-series", "p-container-size", "p-bar-hover", "p-bar-click"], ["po-chart-column", "", 3, "p-categories", "p-range", "p-series", "p-container-size", "p-bar-hover", "p-bar-click"], ["po-chart-line", "", 3, "p-categories", "p-range", "p-series", "p-container-size", "p-point-hover", "p-point-click"], ["po-chart-bar", "", 3, "p-categories", "p-range", "p-series", "p-container-size", "p-bar-hover", "p-bar-click"], ["po-chart-pie", "", 3, "p-series", "p-container-size", "p-circular-hover", "p-circular-click"], ["po-chart-donut", "", 3, "p-options", "p-series", "p-container-size", "p-circular-hover", "p-circular-click"]], template: function PoChartContainerComponent_Template(rf, ctx) { if (rf & 1) {
            i0.ɵɵnamespaceSVG();
            i0.ɵɵelementStart(0, "svg", 0, 1);
            i0.ɵɵtemplate(2, PoChartContainerComponent__svg_g_2_Template, 1, 7, "g", 2)(3, PoChartContainerComponent__svg_g_3_Template, 1, 7, "g", 3)(4, PoChartContainerComponent__svg_g_4_Template, 1, 4, "g", 4)(5, PoChartContainerComponent__svg_g_5_Template, 1, 4, "g", 5)(6, PoChartContainerComponent__svg_g_6_Template, 1, 4, "g", 6)(7, PoChartContainerComponent__svg_g_7_Template, 1, 2, "g", 7)(8, PoChartContainerComponent__svg_g_8_Template, 1, 3, "g", 8);
            i0.ɵɵelementEnd();
        } if (rf & 2) {
            i0.ɵɵattribute("viewBox", ctx.viewBox)("width", ctx.containerSize.svgWidth)("height", ctx.containerSize.svgHeight);
            i0.ɵɵadvance(2);
            i0.ɵɵproperty("ngIf", !ctx.isTypeCircular);
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", (ctx.type === "area" || ctx.type === "line" || ctx.type === "column") && ctx.seriesByType["area"].length);
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", (ctx.type === "area" || ctx.type === "line" || ctx.type === "column") && ctx.seriesByType["column"].length);
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", (ctx.type === "area" || ctx.type === "line" || ctx.type === "column") && ctx.seriesByType["line"].length);
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.type === "bar");
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.type === "pie");
            i0.ɵɵadvance();
            i0.ɵɵproperty("ngIf", ctx.type === "donut");
        } }, dependencies: [i2.NgIf, i3.PoChartAreaComponent, i4.PoChartAxisComponent, i5.PoChartLineComponent, i6.PoChartPieComponent, i7.PoChartDonutComponent, i8.PoChartBarComponent, i9.PoChartColumnComponent], encapsulation: 2 });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoChartContainerComponent, [{
        type: Component,
        args: [{ selector: 'po-chart-container', template: "<svg:svg\n  #svgELement\n  class=\"po-chart-svg-element\"\n  preserveAspectRatio=\"xMidYMin meet\"\n  [attr.viewBox]=\"viewBox\"\n  [attr.width]=\"containerSize.svgWidth\"\n  [attr.height]=\"containerSize.svgHeight\"\n>\n  <!-- axis -->\n  <svg:g\n    *ngIf=\"!isTypeCircular\"\n    po-chart-axis\n    [p-align-by-the-corners]=\"alignByTheCorners\"\n    [p-range]=\"range\"\n    [p-type]=\"type\"\n    [p-series]=\"series\"\n    [p-container-size]=\"containerSize\"\n    [p-options]=\"axisOptions\"\n    [p-categories]=\"categories\"\n    (p-categories-coordinates)=\"getCategoriesCoordinates($event)\"\n  ></svg:g>\n\n  <!-- chart area -->\n  <svg:g\n    *ngIf=\"(type === 'area' || type === 'line' || type === 'column') && seriesByType['area'].length\"\n    po-chart-area\n    [p-align-by-the-corners]=\"alignByTheCorners\"\n    [p-svg-space]=\"svgSpace\"\n    [p-categories]=\"categories\"\n    [p-categories-coordinates]=\"categoriesCoordinates\"\n    [p-range]=\"range\"\n    [p-series]=\"seriesByType['area']\"\n    [p-container-size]=\"containerSize\"\n    (p-bar-hover)=\"onSerieHover($event)\"\n    (p-bar-click)=\"onSerieClick($event)\"\n  ></svg:g>\n\n  <!-- chart column -->\n  <svg:g\n    *ngIf=\"(type === 'area' || type === 'line' || type === 'column') && seriesByType['column'].length\"\n    po-chart-column\n    [p-categories]=\"categories\"\n    [p-range]=\"range\"\n    [p-series]=\"seriesByType['column']\"\n    [p-container-size]=\"containerSize\"\n    (p-bar-hover)=\"onSerieHover($event)\"\n    (p-bar-click)=\"onSerieClick($event)\"\n  ></svg:g>\n\n  <!-- chart line -->\n  <svg:g\n    *ngIf=\"(type === 'area' || type === 'line' || type === 'column') && seriesByType['line'].length\"\n    po-chart-line\n    [p-categories]=\"categories\"\n    [p-range]=\"range\"\n    [p-series]=\"seriesByType['line']\"\n    [p-container-size]=\"containerSize\"\n    (p-point-hover)=\"onSerieHover($event)\"\n    (p-point-click)=\"onSerieClick($event)\"\n  ></svg:g>\n\n  <!-- chart bar -->\n  <svg:g\n    *ngIf=\"type === 'bar'\"\n    po-chart-bar\n    [p-categories]=\"categories\"\n    [p-range]=\"range\"\n    [p-series]=\"seriesByType['bar']\"\n    [p-container-size]=\"containerSize\"\n    (p-bar-hover)=\"onSerieHover($event)\"\n    (p-bar-click)=\"onSerieClick($event)\"\n  ></svg:g>\n\n  <svg:g\n    *ngIf=\"type === 'pie'\"\n    po-chart-pie\n    [p-series]=\"seriesByType['pie']\"\n    [p-container-size]=\"containerSize\"\n    (p-circular-hover)=\"onSerieHover($event)\"\n    (p-circular-click)=\"onSerieClick($event)\"\n  ></svg:g>\n\n  <svg:g\n    *ngIf=\"type === 'donut'\"\n    po-chart-donut\n    [p-options]=\"options\"\n    [p-series]=\"seriesByType['donut']\"\n    [p-container-size]=\"containerSize\"\n    (p-circular-hover)=\"onSerieHover($event)\"\n    (p-circular-click)=\"onSerieClick($event)\"\n  ></svg:g>\n</svg:svg>\n" }]
    }], () => [{ type: i1.PoChartMathsService }], { categories: [{
            type: Input,
            args: ['p-categories']
        }], type: [{
            type: Input,
            args: ['p-type']
        }], containerSize: [{
            type: Input,
            args: ['p-container-size']
        }], serieClick: [{
            type: Output,
            args: ['p-serie-click']
        }], serieHover: [{
            type: Output,
            args: ['p-serie-hover']
        }], svgELement: [{
            type: ViewChild,
            args: ['svgELement', { static: true }]
        }], options: [{
            type: Input,
            args: ['p-options']
        }], series: [{
            type: Input,
            args: ['p-series']
        }] }); })();
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassDebugInfo(PoChartContainerComponent, { className: "PoChartContainerComponent", filePath: "lib/components/po-chart/po-chart-container/po-chart-container.component.ts", lineNumber: 15 }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tY2hhcnQtY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpL3NyYy9saWIvY29tcG9uZW50cy9wby1jaGFydC9wby1jaGFydC1jb250YWluZXIvcG8tY2hhcnQtY29udGFpbmVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpL3NyYy9saWIvY29tcG9uZW50cy9wby1jaGFydC9wby1jaGFydC1jb250YWluZXIvcG8tY2hhcnQtY29udGFpbmVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQWMsWUFBWSxFQUFFLEtBQUssRUFBYSxNQUFNLEVBQWlCLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV4SCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7Ozs7Ozs7Ozs7Ozs7OztJQ094RCw0QkFXQztJQURDLHFOQUE0QixlQUFBLHVDQUFnQyxDQUFBLElBQUM7SUFDOUQsaUJBQVE7OztJQVJQLGlFQUE0Qyx5QkFBQSx1QkFBQSwyQkFBQSwwQ0FBQSxpQ0FBQSxtQ0FBQTs7Ozs7SUFXOUMsNkJBWUM7SUFGQyw2TEFBZSxlQUFBLDRCQUFvQixDQUFBLElBQUMsZ0xBQ3JCLGVBQUEsNEJBQW9CLENBQUEsSUFEQztJQUVyQyxpQkFBUTs7O0lBVFAsaUVBQTRDLGdDQUFBLG1DQUFBLDBEQUFBLHlCQUFBLHlDQUFBLDBDQUFBOzs7OztJQVk5Qyw2QkFTQztJQUZDLDZMQUFlLGVBQUEsNEJBQW9CLENBQUEsSUFBQyxnTEFDckIsZUFBQSw0QkFBb0IsQ0FBQSxJQURDO0lBRXJDLGlCQUFROzs7SUFOUCxnREFBMkIseUJBQUEsMkNBQUEsMENBQUE7Ozs7O0lBUzdCLDZCQVNDO0lBRkMsaU1BQWlCLGVBQUEsNEJBQW9CLENBQUEsSUFBQyxvTEFDckIs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V1MsOERBQUEsOERBQUEsOERBQUEsOERBQUEsOERBQUEsOERBQUE7WUF1RVgsaUJBQVU7O1lBdkZSLHNDQUF3QixxQ0FBQSx1Q0FBQTtZQU1yQixlQUFxQjtZQUFyQiwwQ0FBcUI7WUFjckIsY0FBOEY7WUFBOUYsK0hBQThGO1lBZTlGLGNBQWdHO1lBQWhHLGlJQUFnRztZQVloRyxjQUE4RjtZQUE5RiwrSEFBOEY7WUFZOUYsY0FBb0I7WUFBcEIseUNBQW9CO1lBV3BCLGNBQW9CO1lBQXBCLHlDQUFvQjtZQVNwQixjQUFzQjtZQUF0QiwyQ0FBc0I7OztpRkRyRWQseUJBQXlCO2NBSnJDLFNBQVM7MkJBQ0Usb0JBQW9CO29EQUlQLFVBQVU7a0JBQWhDLEtBQUs7bUJBQUMsY0FBYztZQUVKLElBQUk7a0JBQXBCLEtBQUs7bUJBQUMsUUFBUTtZQUVZLGFBQWE7a0JBQXZDLEtBQUs7bUJBQUMsa0JBQWtCO1lBRUEsVUFBVTtrQkFBbEMsTUFBTTttQkFBQyxlQUFlO1lBRUUsVUFBVTtrQkFBbEMsTUFBTTttQkFBQyxlQUFlO1lBRW9CLFVBQVU7a0JBQXBELFNBQVM7bUJBQUMsWUFBWSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtZQWFqQixPQUFPO2tCQUE5QixLQUFLO21CQUFDLFdBQVc7WUFZSyxNQUFNO2tCQUE1QixLQUFLO21CQUFDLFVBQVU7O2tGQXBDTix5QkFBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uQ2hhbmdlcywgT3V0cHV0LCBTaW1wbGVDaGFuZ2VzLCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgUG9DaGFydFR5cGUgfSBmcm9tICcuLi9lbnVtcy9wby1jaGFydC10eXBlLmVudW0nO1xuaW1wb3J0IHsgUG9DaGFydENvbnRhaW5lclNpemUgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3BvLWNoYXJ0LWNvbnRhaW5lci1zaXplLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0NoYXJ0T3B0aW9ucyB9IGZyb20gJy4uL2ludGVyZmFjZXMvcG8tY2hhcnQtb3B0aW9ucy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9DaGFydEF4aXNPcHRpb25zIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9wby1jaGFydC1heGlzLW9wdGlvbnMuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvQ2hhcnRNYXRoc1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9wby1jaGFydC1tYXRocy5zZXJ2aWNlJztcbmltcG9ydCB7IFBvQ2hhcnRNaW5NYXhWYWx1ZXMgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3BvLWNoYXJ0LW1pbi1tYXgtdmFsdWVzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0NoYXJ0U2VyaWUgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3BvLWNoYXJ0LXNlcmllLmludGVyZmFjZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3BvLWNoYXJ0LWNvbnRhaW5lcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9wby1jaGFydC1jb250YWluZXIuY29tcG9uZW50Lmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIFBvQ2hhcnRDb250YWluZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xuICBASW5wdXQoJ3AtY2F0ZWdvcmllcycpIGNhdGVnb3JpZXM6IEFycmF5PHN0cmluZz47XG5cbiAgQElucHV0KCdwLXR5cGUnKSB0eXBlOiBQb0NoYXJ0VHlwZTtcblxuICBASW5wdXQoJ3AtY29udGFpbmVyLXNpemUnKSBjb250YWluZXJTaXplOiBQb0NoYXJ0Q29udGFpbmVyU2l6ZTtcblxuICBAT3V0cHV0KCdwLXNlcmllLWNsaWNrJykgc2VyaWVDbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIEBPdXRwdXQoJ3Atc2VyaWUtaG92ZXInKSBzZXJpZUhvdmVyID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgQFZpZXdDaGlsZCgnc3ZnRUxlbWVudCcsIHsgc3RhdGljOiB0cnVlIH0pIHN2Z0VMZW1lbnQ6IEVsZW1lbnRSZWY7XG5cbiAgYWxpZ25CeVRoZUNvcm5lcnM6IGJvb2xlYW47XG4gIGF4aXNPcHRpb25zOiBQb0NoYXJ0QXhpc09wdGlvbnM7XG4gIGNhdGVnb3JpZXNDb29yZGluYXRlczogQXJyYXk8bnVtYmVyPjtcbiAgcmFuZ2U6IFBvQ2hhcnRNaW5NYXhWYWx1ZXM7XG4gIHNlcmllc0J5VHlwZTtcbiAgc3ZnU3BhY2U7XG4gIHZpZXdCb3g6IHN0cmluZztcblxuICBwcml2YXRlIF9vcHRpb25zOiBQb0NoYXJ0T3B0aW9ucztcbiAgcHJpdmF0ZSBfc2VyaWVzOiBBcnJheTxQb0NoYXJ0U2VyaWU+ID0gW107XG5cbiAgQElucHV0KCdwLW9wdGlvbnMnKSBzZXQgb3B0aW9ucyh2YWx1ZTogUG9DaGFydE9wdGlvbnMpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QgJiYgISh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgdGhpcy5fb3B0aW9ucyA9IHZhbHVlO1xuXG4gICAgICB0aGlzLnZlcmlmeUF4aXNPcHRpb25zKHRoaXMuX29wdGlvbnMpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBvcHRpb25zKCkge1xuICAgIHJldHVybiB0aGlzLl9vcHRpb25zO1xuICB9XG5cbiAgQElucHV0KCdwLXNlcmllcycpIHNldCBzZXJpZXMoZGF0YTogQXJyYXk8UG9DaGFydFNlcmllPikge1xuICAgIHRoaXMuX3NlcmllcyA9IGRhdGE7XG4gICAgdGhpcy5zZXRBbGlnbkJ5VGhlQ29ybmVycyh0aGlzLl9zZXJpZXMpO1xuICAgIHRoaXMuc2V0U2VyaWVzQnlUeXBlKHRoaXMuX3Nlcmllcyk7XG4gICAgdGhpcy5zZXRSYW5nZSh0aGlzLl9zZXJpZXMsIHRoaXMub3B0aW9ucyk7XG4gIH1cblxuICBnZXQgc2VyaWVzKCkge1xuICAgIHJldHVybiB0aGlzLl9zZXJpZXM7XG4gIH1cblxuICBnZXQgaXNUeXBlQ2lyY3VsYXIoKSB7XG4gICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gUG9DaGFydFR5cGUuUGllIHx8IHRoaXMudHlwZSA9PT0gUG9DaGFydFR5cGUuRG9udXQ7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1hdGhzU2VydmljZTogUG9DaGFydE1hdGhzU2VydmljZSkge31cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgaWYgKGNoYW5nZXMudHlwZSB8fCBjaGFuZ2VzLmNvbnRhaW5lclNpemUpIHtcbiAgICAgIHRoaXMuc2V0Vmlld0JveCgpO1xuICAgICAgdGhpcy5zZXRTdmdTcGFjZSgpO1xuICAgIH1cbiAgfVxuXG4gIGdldENhdGVnb3JpZXNDb29yZGluYXRlcyh2YWx1ZTogQXJyYXk8bnVtYmVyPik6IHZvaWQge1xuICAgIHRoaXMuY2F0ZWdvcmllc0Nvb3JkaW5hdGVzID0gdmFsdWU7XG4gIH1cblxuICBvblNlcmllQ2xpY2soZXZlbnQ6IGFueSkge1xuICAgIHRoaXMuc2VyaWVDbGljay5lbWl0KGV2ZW50KTtcbiAgfVxuXG4gIG9uU2VyaWVIb3ZlcihldmVudDogYW55KSB7XG4gICAgdGhpcy5zZXJpZUhvdmVyLmVtaXQoZXZlbnQpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSYW5nZShzZXJpZXM6IEFycmF5PFBvQ2hhcnRTZXJpZT4sIG9wdGlvbnM6IFBvQ2hhcnRPcHRpb25zID0ge30pOiBQb0NoYXJ0TWluTWF4VmFsdWVzIHtcbiAgICBjb25zdCBkb21haW4gPSB0aGlzLm1hdGhzU2VydmljZS5jYWxjdWxhdGVNaW5BbmRNYXhWYWx1ZXMoc2VyaWVzKTtcbiAgICBjb25zdCBtaW5WYWx1ZSA9XG4gICAgICAhb3B0aW9ucy5heGlzPy5taW5SYW5nZSAmJiBkb21haW4ubWluVmFsdWUgPiAwXG4gICAgICAgID8gMFxuICAgICAgICA6IG9wdGlvbnMuYXhpcz8ubWluUmFuZ2UgPCBkb21haW4ubWluVmFsdWVcbiAgICAgICAgICA/IG9wdGlvbnMuYXhpcy5taW5SYW5nZVxuICAgICAgICAgIDogZG9tYWluLm1pblZhbHVlO1xuICAgIGNvbnN0IG1heFZhbHVlID0gb3B0aW9ucy5heGlzPy5tYXhSYW5nZSA+IGRvbWFpbi5tYXhWYWx1ZSA/IG9wdGlvbnMuYXhpcy5tYXhSYW5nZSA6IGRvbWFpbi5tYXhWYWx1ZTtcbiAgICBjb25zdCB1cGRhdGVkRG9tYWluVmFsdWVzID0geyBtaW5WYWx1ZSwgbWF4VmFsdWUgfTtcblxuICAgIHJldHVybiB7IC4uLmRvbWFpbiwgLi4udXBkYXRlZERvbWFpblZhbHVlcyB9O1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRTdmdTcGFjZSgpIHtcbiAgICAvLyBSZXByZXNlbnRhIHVtIHBvbnRvIDJEIGRlbnRybyBkbyB2aWV3cG9ydCBkbyBTVkcuIEVsZSDDqSBhIHJlcHJlc2VudGHDp8OjbyBkbyBjdXJzb3IgZG8gbW91c2UgcGFyYSBjb21wYXJhw6fDo28gZGUgY29vcmRlbmFkYXMgY29tIGNhZGEgZGFkbyBkZSBzw6lyaWUuXG4gICAgY29uc3Qgc3ZnUG9pbnQgPSB0aGlzLnN2Z0VMZW1lbnQubmF0aXZlRWxlbWVudC5jcmVhdGVTVkdQb2ludCgpO1xuICAgIC8vIFJldG9ybmEgdW0gRE9NTWF0cml4IHJlcHJlc2VudGFuZG8gYXMgbWF0cml6ZXMgMkQgZSAzRCB0cmFuc2Zvcm1hZGFzIGEgcGFydGlyIGRhcyBjb29yZGVuYWRhcyBkbyBlbGVtZW50bywgZW0gcmVsYcOnw6NvIGFvIGRvY3VtZW50LCBwYXJhIGNvb3JkZW5hZGFzIHJlbGF0aXZhcyBhbyB2aWV3cG9ydCBkbyBTVkcuXG4gICAgLy8gw4kgdXRpbGl6YWRvIG5vcyBncsOhZmljb3MgZG8gdGlwbyDDoXJlYSBwYXJhIHF1ZSBzZWphIHBvc3PDrXZlbCBlcXVpcGFyYXIgYXMgY29vcmRlbmFkYXMgZG8gZXZlbnRvIGNvbSBjYWRhIGRhZG8gZGUgc8OpcmllLCBwYXJhIGFzc2ltIGF0aXZhciBvIHBvbnRvIGRlIGRhZG8gZXF1aXZhbGVudGUuXG4gICAgY29uc3Qgc3ZnRG9tTWF0cml4ID0gdGhpcy5zdmdFTGVtZW50Lm5hdGl2ZUVsZW1lbnQuZ2V0U2NyZWVuQ1RNKCk/LmludmVyc2UoKTtcblxuICAgIHRoaXMuc3ZnU3BhY2UgPSB7IHN2Z1BvaW50LCBzdmdEb21NYXRyaXggfTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0QWxpZ25CeVRoZUNvcm5lcnMoc2VyaWVzOiBBcnJheTxQb0NoYXJ0U2VyaWU+KTogdm9pZCB7XG4gICAgdGhpcy5hbGlnbkJ5VGhlQ29ybmVycyA9IHNlcmllcy5ldmVyeShzZXJpZSA9PiBzZXJpZS50eXBlID09PSBQb0NoYXJ0VHlwZS5BcmVhIHx8IHNlcmllLnR5cGUgPT09IFBvQ2hhcnRUeXBlLkJhcik7XG4gIH1cblxuICBwcml2YXRlIHNldFJhbmdlKHNlcmllczogQXJyYXk8UG9DaGFydFNlcmllPiwgb3B0aW9uczogUG9DaGFydE9wdGlvbnMgPSB7fSkge1xuICAgIGlmICghdGhpcy5pc1R5cGVDaXJjdWxhcikge1xuICAgICAgdGhpcy5yYW5nZSA9IHRoaXMuZ2V0UmFuZ2Uoc2VyaWVzLCBvcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldFNlcmllc0J5VHlwZShzZXJpZXM6IEFycmF5PFBvQ2hhcnRTZXJpZT4pIHtcbiAgICB0aGlzLnNlcmllc0J5VHlwZSA9IHtcbiAgICAgIFtQb0NoYXJ0VHlwZS5BcmVhXTogc2VyaWVzLmZpbHRlcihzZXJpZSA9PiBzZXJpZS50eXBlID09PSBQb0NoYXJ0VHlwZS5BcmVhKSxcbiAgICAgIFtQb0NoYXJ0VHlwZS5Db2x1bW5dOiBzZXJpZXMuZmlsdGVyKHNlcmllID0+IHNlcmllLnR5cGUgPT09IFBvQ2hhcnRUeXBlLkNvbHVtbiksXG4gICAgICBbUG9DaGFydFR5cGUuQmFyXTogc2VyaWVzLmZpbHRlcihzZXJpZSA9PiBzZXJpZS50eXBlID09PSBQb0NoYXJ0VHlwZS5CYXIpLFxuICAgICAgW1BvQ2hhcnRUeXBlLkxpbmVdOiBzZXJpZXMuZmlsdGVyKHNlcmllID0+IHNlcmllLnR5cGUgPT09IFBvQ2hhcnRUeXBlLkxpbmUpLFxuICAgICAgW1BvQ2hhcnRUeXBlLkRvbnV0XTogc2VyaWVzLmZpbHRlcihzZXJpZSA9PiBzZXJpZS50eXBlID09PSBQb0NoYXJ0VHlwZS5Eb251dCksXG4gICAgICBbUG9DaGFydFR5cGUuUGllXTogc2VyaWVzLmZpbHRlcihzZXJpZSA9PiBzZXJpZS50eXBlID09PSBQb0NoYXJ0VHlwZS5QaWUpXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0Vmlld0JveCgpIHtcbiAgICBjb25zdCB7IHN2Z1dpZHRoLCBzdmdIZWlnaHQgfSA9IHRoaXMuY29udGFpbmVyU2l6ZTtcbiAgICBjb25zdCB2aWV3Qm94V2lkdGggPSB0aGlzLmlzVHlwZUNpcmN1bGFyID8gc3ZnSGVpZ2h0IDogc3ZnV2lkdGg7XG4gICAgLy8gVHJhdGFtZW50byBuZWNlc3PDoXJpbyBwYXJhIHF1ZSBuw6NvIGNvcnRlIG8gdmV0b3IgbmFzIGV4dHJlbWlkYWRlc1xuICAgIGNvbnN0IG9mZnNldFhZID0gMTtcblxuICAgIHRoaXMudmlld0JveCA9IGAke29mZnNldFhZfSAtJHtvZmZzZXRYWX0gJHt2aWV3Qm94V2lkdGh9ICR7dGhpcy5jb250YWluZXJTaXplLnN2Z0hlaWdodH1gO1xuICB9XG5cbiAgcHJpdmF0ZSB2ZXJpZnlBeGlzT3B0aW9ucyhvcHRpb25zOiBQb0NoYXJ0T3B0aW9ucyk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc1R5cGVDaXJjdWxhciAmJiBvcHRpb25zLmhhc093blByb3BlcnR5KCdheGlzJykpIHtcbiAgICAgIHRoaXMucmFuZ2UgPSB0aGlzLmdldFJhbmdlKHRoaXMuc2VyaWVzLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgdGhpcy5heGlzT3B0aW9ucyA9IHtcbiAgICAgICAgLi4udGhpcy5heGlzT3B0aW9ucyxcbiAgICAgICAgLi4ub3B0aW9ucy5heGlzXG4gICAgICB9O1xuICAgIH1cbiAgfVxufVxuIiwiPHN2ZzpzdmdcbiAgI3N2Z0VMZW1lbnRcbiAgY2xhc3M9XCJwby1jaGFydC1zdmctZWxlbWVudFwiXG4gIHByZXNlcnZlQXNwZWN0UmF0aW89XCJ4TWlkWU1pbiBtZWV0XCJcbiAgW2F0dHIudmlld0JveF09XCJ2aWV3Qm94XCJcbiAgW2F0dHIud2lkdGhdPVwiY29udGFpbmVyU2l6ZS5zdmdXaWR0aFwiXG4gIFthdHRyLmhlaWdodF09XCJjb250YWluZXJTaXplLnN2Z0hlaWdodFwiXG4+XG4gIDwhLS0gYXhpcyAtLT5cbiAgPHN2ZzpnXG4gICAgKm5nSWY9XCIhaXNUeXBlQ2lyY3VsYXJcIlxuICAgIHBvLWNoYXJ0LWF4aXNcbiAgICBbcC1hbGlnbi1ieS10aGUtY29ybmVyc109XCJhbGlnbkJ5VGhlQ29ybmVyc1wiXG4gICAgW3AtcmFuZ2VdPVwicmFuZ2VcIlxuICAgIFtwLXR5cGVdPVwidHlwZVwiXG4gICAgW3Atc2VyaWVzXT1cInNlcmllc1wiXG4gICAgW3AtY29udGFpbmVyLXNpemVdPVwiY29udGFpbmVyU2l6ZVwiXG4gICAgW3Atb3B0aW9uc109XCJheGlzT3B0aW9uc1wiXG4gICAgW3AtY2F0ZWdvcmllc109XCJjYXRlZ29yaWVzXCJcbiAgICAocC1jYXRlZ29yaWVzLWNvb3JkaW5hdGVzKT1cImdldENhdGVnb3JpZXNDb29yZGluYXRlcygkZXZlbnQpXCJcbiAgPjwvc3ZnOmc+XG5cbiAgPCEtLSBjaGFydCBhcmVhIC0tPlxuICA8c3ZnOmdcbiAgICAqbmdJZj1cIih0eXBlID09PSAnYXJlYScgfHwgdHlwZSA9PT0gJ2xpbmUnIHx8IHR5cGUgPT09ICdjb2x1bW4nKSAmJiBzZXJpZXNCeVR5cGVbJ2FyZWEnXS5sZW5ndGhcIlxuICAgIHBvLWNoYXJ0LWFyZWFcbiAgICBbcC1hbGlnbi1ieS10aGUtY29ybmVyc109XCJhbGlnbkJ5VGhlQ29ybmVyc1wiXG4gICAgW3Atc3ZnLXNwYWNlXT1cInN2Z1NwYWNlXCJcbiAgICBbcC1jYXRlZ29yaWVzXT1cImNhdGVnb3JpZXNcIlxuICAgIFtwLWNhdGVnb3JpZXMtY29vcmRpbmF0ZXNdPVwiY2F0ZWdvcmllc0Nvb3JkaW5hdGVzXCJcbiAgICBbcC1yYW5nZV09XCJyYW5nZVwiXG4gICAgW3Atc2VyaWVzXT1cInNlcmllc0J5VHlwZVsnYXJlYSddXCJcbiAgICBbcC1jb250YWluZXItc2l6ZV09XCJjb250YWluZXJTaXplXCJcbiAgICAocC1iYXItaG92ZXIpPVwib25TZXJpZUhvdmVyKCRldmVudClcIlxuICAgIChwLWJhci1jbGljayk9XCJvblNlcmllQ2xpY2soJGV2ZW50KVwiXG4gID48L3N2ZzpnPlxuXG4gIDwhLS0gY2hhcnQgY29sdW1uIC0tPlxuICA8c3ZnOmdcbiAgICAqbmdJZj1cIih0eXBlID09PSAnYXJlYScgfHwgdHlwZSA9PT0gJ2xpbmUnIHx8IHR5cGUgPT09ICdjb2x1bW4nKSAmJiBzZXJpZXNCeVR5cGVbJ2NvbHVtbiddLmxlbmd0aFwiXG4gICAgcG8tY2hhcnQtY29sdW1uXG4gICAgW3AtY2F0ZWdvcmllc109XCJjYXRlZ29yaWVzXCJcbiAgICBbcC1yYW5nZV09XCJyYW5nZVwiXG4gICAgW3Atc2VyaWVzXT1cInNlcmllc0J5VHlwZVsnY29sdW1uJ11cIlxuICAgIFtwLWNvbnRhaW5lci1zaXplXT1cImNvbnRhaW5lclNpemVcIlxuICAgIChwLWJhci1ob3Zlcik9XCJvblNlcmllSG92ZXIoJGV2ZW50KVwiXG4gICAgKHAtYmFyLWNsaWNrKT1cIm9uU2VyaWVDbGljaygkZXZlbnQpXCJcbiAgPjwvc3ZnOmc+XG5cbiAgPCEtLSBjaGFydCBsaW5lIC0tPlxuICA8c3ZnOmdcbiAgICAqbmdJZj1cIih0eXBlID09PSAnYXJlYScgfHwgdHlwZSA9PT0gJ2xpbmUnIHx8IHR5cGUgPT09ICdjb2x1bW4nKSAmJiBzZXJpZXNCeVR5cGVbJ2xpbmUnXS5sZW5ndGhcIlxuICAgIHBvLWNoYXJ0LWxpbmVcbiAgICBbcC1jYXRlZ29yaWVzXT1cImNhdGVnb3JpZXNcIlxuICAgIFtwLXJhbmdlXT1cInJhbmdlXCJcbiAgICBbcC1zZXJpZXNdPVwic2VyaWVzQnlUeXBlWydsaW5lJ11cIlxuICAgIFtwLWNvbnRhaW5lci1zaXplXT1cImNvbnRhaW5lclNpemVcIlxuICAgIChwLXBvaW50LWhvdmVyKT1cIm9uU2VyaWVIb3ZlcigkZXZlbnQpXCJcbiAgICAocC1wb2ludC1jbGljayk9XCJvblNlcmllQ2xpY2soJGV2ZW50KVwiXG4gID48L3N2ZzpnPlxuXG4gIDwhLS0gY2hhcnQgYmFyIC0tPlxuICA8c3ZnOmdcbiAgICAqbmdJZj1cInR5cGUgPT09ICdiYXInXCJcbiAgICBwby1jaGFydC1iYXJcbiAgICBbcC1jYXRlZ29yaWVzXT1cImNhdGVnb3JpZXNcIlxuICAgIFtwLXJhbmdlXT1cInJhbmdlXCJcbiAgICBbcC1zZXJpZXNdPVwic2VyaWVzQnlUeXBlWydiYXInXVwiXG4gICAgW3AtY29udGFpbmVyLXNpemVdPVwiY29udGFpbmVyU2l6ZVwiXG4gICAgKHAtYmFyLWhvdmVyKT1cIm9uU2VyaWVIb3ZlcigkZXZlbnQpXCJcbiAgICAocC1iYXItY2xpY2spPVwib25TZXJpZUNsaWNrKCRldmVudClcIlxuICA+PC9zdmc6Zz5cblxuICA8c3ZnOmdcbiAgICAqbmdJZj1cInR5cGUgPT09ICdwaWUnXCJcbiAgICBwby1jaGFydC1waWVcbiAgICBbcC1zZXJpZXNdPVwic2VyaWVzQnlUeXBlWydwaWUnXVwiXG4gICAgW3AtY29udGFpbmVyLXNpemVdPVwiY29udGFpbmVyU2l6ZVwiXG4gICAgKHAtY2lyY3VsYXItaG92ZXIpPVwib25TZXJpZUhvdmVyKCRldmVudClcIlxuICAgIChwLWNpcmN1bGFyLWNsaWNrKT1cIm9uU2VyaWVDbGljaygkZXZlbnQpXCJcbiAgPjwvc3ZnOmc+XG5cbiAgPHN2ZzpnXG4gICAgKm5nSWY9XCJ0eXBlID09PSAnZG9udXQnXCJcbiAgICBwby1jaGFydC1kb251dFxuICAgIFtwLW9wdGlvbnNdPVwib3B0aW9uc1wiXG4gICAgW3Atc2VyaWVzXT1cInNlcmllc0J5VHlwZVsnZG9udXQnXVwiXG4gICAgW3AtY29udGFpbmVyLXNpemVdPVwiY29udGFpbmVyU2l6ZVwiXG4gICAgKHAtY2lyY3VsYXItaG92ZXIpPVwib25TZXJpZUhvdmVyKCRldmVudClcIlxuICAgIChwLWNpcmN1bGFyLWNsaWNrKT1cIm9uU2VyaWVDbGljaygkZXZlbnQpXCJcbiAgPjwvc3ZnOmc+XG48L3N2Zzpzdmc+XG4iXX0=