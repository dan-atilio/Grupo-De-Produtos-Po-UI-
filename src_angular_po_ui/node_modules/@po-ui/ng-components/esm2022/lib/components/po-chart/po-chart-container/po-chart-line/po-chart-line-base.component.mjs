import { Directive, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { PoChartType } from '../../enums/po-chart-type.enum';
import { PoChartPlotAreaPaddingTop } from '../../helpers/po-chart-default-values.constant';
import * as i0 from "@angular/core";
import * as i1 from "../../services/po-chart-maths.service";
const _c0 = ["chartLine"];
export class PoChartLineBaseComponent {
    mathsService;
    renderer;
    elementRef;
    alignByTheCorners = false;
    categories;
    categoriesCoordinates;
    svgSpace;
    pointClick = new EventEmitter();
    pointHover = new EventEmitter();
    chartLine;
    activeTooltip;
    animate = true;
    chartType;
    seriesPathsCoordinates;
    seriesPointsCoordinates = [];
    firstValidItemFromSerieArray;
    seriesLength;
    _containerSize = {};
    _range = {};
    _series = [];
    set range(value) {
        if (value instanceof Object && !(value instanceof Array)) {
            this._range = value;
            this.seriePathPointsDefinition(this.containerSize, this._series, this._range);
        }
    }
    get range() {
        return this._range;
    }
    set containerSize(value) {
        this._containerSize = value;
        this.seriePathPointsDefinition(this._containerSize, this.series, this.range);
    }
    get containerSize() {
        return this._containerSize;
    }
    set series(seriesList) {
        const seriesDataArrayFilter = seriesList.filter(serie => Array.isArray(serie.data));
        if (seriesDataArrayFilter.length) {
            this._series = seriesDataArrayFilter;
            this.animate = true;
            this.seriesLength = this.mathsService.seriesGreaterLength(this.series);
            this.chartType = this._series[0].type;
            this.seriePathPointsDefinition(this.containerSize, seriesDataArrayFilter, this.range);
        }
        else {
            this._series = [];
        }
    }
    get series() {
        return this._series;
    }
    constructor(mathsService, renderer, elementRef) {
        this.mathsService = mathsService;
        this.renderer = renderer;
        this.elementRef = elementRef;
    }
    onSeriePointClick(selectedItem) {
        this.pointClick.emit(selectedItem);
    }
    trackBy(index) {
        return index;
    }
    getTooltipLabel(data, label, tooltipLabel) {
        const dataLabel = label ? `${label}: ` : '';
        const dataValue = data.toString();
        return tooltipLabel || `${dataLabel}${dataValue}`;
    }
    svgPathCommand() {
        const command = this.firstValidItemFromSerieArray ? 'M' : 'L';
        // firstValidItemFromSerieArray: tratamento para permitir ao usuário definir o primeiro valor como null para que seja ignorado;
        this.firstValidItemFromSerieArray = false;
        return command;
    }
    xCoordinate(index, containerSize) {
        const halfCategoryWidth = !this.alignByTheCorners
            ? (containerSize.svgWidth - containerSize.axisXLabelWidth) / this.seriesLength / 2
            : 0;
        const divideIndexBySeriesLength = index / (this.alignByTheCorners ? this.seriesLength - 1 : this.seriesLength);
        const xRatio = isNaN(divideIndexBySeriesLength) ? 0 : divideIndexBySeriesLength;
        return Math.floor(containerSize.axisXLabelWidth +
            halfCategoryWidth +
            (containerSize.svgWidth - containerSize.axisXLabelWidth) * xRatio);
    }
    serieCategory(index, categories = []) {
        return categories[index] ?? undefined;
    }
    seriePathPointsDefinition(containerSize, series, range) {
        this.seriesPointsCoordinates = [];
        this.seriesPathsCoordinates = series.map((serie) => {
            if (Array.isArray(serie.data)) {
                let pathCoordinates = '';
                let pointCoordinates = [];
                const color = serie.color;
                this.firstValidItemFromSerieArray = true;
                serie.data.forEach((data, index) => {
                    if (this.mathsService.verifyIfFloatOrInteger(data)) {
                        const svgPathCommand = this.svgPathCommand();
                        const xCoordinate = this.xCoordinate(index, containerSize);
                        const yCoordinate = this.yCoordinate(range, data, containerSize);
                        const category = this.serieCategory(index, this.categories);
                        const label = serie.label;
                        const tooltip = serie.tooltip;
                        const tooltipLabel = this.getTooltipLabel(data, label, tooltip);
                        const isActive = this.chartType === PoChartType.Line;
                        pointCoordinates = [
                            ...pointCoordinates,
                            { category, label, tooltipLabel, data: data, xCoordinate, yCoordinate, color, isActive }
                        ];
                        pathCoordinates += ` ${svgPathCommand}${xCoordinate} ${yCoordinate}`;
                    }
                });
                pathCoordinates = this.verifyIfClosePath(pathCoordinates, serie.data.length - 1, range, 0, containerSize);
                this.seriesPointsCoordinates = [...this.seriesPointsCoordinates, pointCoordinates];
                return { coordinates: pathCoordinates, color, isActive: true };
            }
        });
    }
    verifyIfClosePath(pathCoordinates, lastIndex, range, data, containerSize) {
        const { axisXLabelWidth, svgWidth } = containerSize;
        if (this.chartType === PoChartType.Area) {
            const xLastPosition = this.xCoordinate(lastIndex, containerSize);
            const baseYCoordinate = this.yCoordinate(range, data, containerSize);
            const xInitialPosition = Math.floor(this.alignByTheCorners
                ? axisXLabelWidth
                : axisXLabelWidth + (svgWidth - axisXLabelWidth) / this.seriesLength / 2);
            return `${pathCoordinates} ${xLastPosition} ${baseYCoordinate} L${xInitialPosition} ${baseYCoordinate} Z`;
        }
        return pathCoordinates;
    }
    yCoordinate(range, data, containerSize) {
        const yRratio = this.mathsService.getSeriePercentage(range, data);
        const yCoordinate = containerSize.svgPlottingAreaHeight - containerSize.svgPlottingAreaHeight * yRratio + PoChartPlotAreaPaddingTop;
        return Math.floor(yCoordinate);
    }
    static ɵfac = function PoChartLineBaseComponent_Factory(t) { return new (t || PoChartLineBaseComponent)(i0.ɵɵdirectiveInject(i1.PoChartMathsService), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i0.ElementRef)); };
    static ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: PoChartLineBaseComponent, viewQuery: function PoChartLineBaseComponent_Query(rf, ctx) { if (rf & 1) {
            i0.ɵɵviewQuery(_c0, 5);
        } if (rf & 2) {
            let _t;
            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.chartLine = _t.first);
        } }, inputs: { alignByTheCorners: [i0.ɵɵInputFlags.None, "p-align-by-the-corners", "alignByTheCorners"], categories: [i0.ɵɵInputFlags.None, "p-categories", "categories"], categoriesCoordinates: [i0.ɵɵInputFlags.None, "p-categories-coordinates", "categoriesCoordinates"], svgSpace: [i0.ɵɵInputFlags.None, "p-svg-space", "svgSpace"], range: [i0.ɵɵInputFlags.None, "p-range", "range"], containerSize: [i0.ɵɵInputFlags.None, "p-container-size", "containerSize"], series: [i0.ɵɵInputFlags.None, "p-series", "series"] }, outputs: { pointClick: "p-point-click", pointHover: "p-point-hover" } });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoChartLineBaseComponent, [{
        type: Directive
    }], () => [{ type: i1.PoChartMathsService }, { type: i0.Renderer2 }, { type: i0.ElementRef }], { alignByTheCorners: [{
            type: Input,
            args: ['p-align-by-the-corners']
        }], categories: [{
            type: Input,
            args: ['p-categories']
        }], categoriesCoordinates: [{
            type: Input,
            args: ['p-categories-coordinates']
        }], svgSpace: [{
            type: Input,
            args: ['p-svg-space']
        }], pointClick: [{
            type: Output,
            args: ['p-point-click']
        }], pointHover: [{
            type: Output,
            args: ['p-point-hover']
        }], chartLine: [{
            type: ViewChild,
            args: ['chartLine']
        }], range: [{
            type: Input,
            args: ['p-range']
        }], containerSize: [{
            type: Input,
            args: ['p-container-size']
        }], series: [{
            type: Input,
            args: ['p-series']
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tY2hhcnQtbGluZS1iYXNlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VpL3NyYy9saWIvY29tcG9uZW50cy9wby1jaGFydC9wby1jaGFydC1jb250YWluZXIvcG8tY2hhcnQtbGluZS9wby1jaGFydC1saW5lLWJhc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQWMsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQWEsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXpHLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUM3RCxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxnREFBZ0QsQ0FBQzs7OztBQVUzRixNQUFNLE9BQWdCLHdCQUF3QjtJQXFFaEM7SUFDQTtJQUNBO0lBdEVxQixpQkFBaUIsR0FBWSxLQUFLLENBQUM7SUFFN0MsVUFBVSxDQUFnQjtJQUVkLHFCQUFxQixDQUFnQjtJQUVsRCxRQUFRLENBQUM7SUFFTixVQUFVLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztJQUVyQyxVQUFVLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztJQUV0QyxTQUFTLENBQWE7SUFFOUMsYUFBYSxDQUFVO0lBQ3ZCLE9BQU8sR0FBWSxJQUFJLENBQUM7SUFDeEIsU0FBUyxDQUFjO0lBQ3ZCLHNCQUFzQixDQUFnQztJQUN0RCx1QkFBdUIsR0FBMkMsRUFBRSxDQUFDO0lBRTNELDRCQUE0QixDQUFVO0lBQ3RDLFlBQVksQ0FBUztJQUV2QixjQUFjLEdBQXlCLEVBQUUsQ0FBQztJQUMxQyxNQUFNLEdBQXdCLEVBQUUsQ0FBQztJQUNqQyxPQUFPLEdBQXdCLEVBQUUsQ0FBQztJQUUxQyxJQUFzQixLQUFLLENBQUMsS0FBMEI7UUFDcEQsSUFBSSxLQUFLLFlBQVksTUFBTSxJQUFJLENBQUMs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QVcsQ0FBQyxLQUEwQixFQUFFLElBQVksRUFBRSxhQUFtQztRQUMvRixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLGtCQUFrQixDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNsRSxNQUFNLFdBQVcsR0FDZixhQUFhLENBQUMscUJBQXFCLEdBQUcsYUFBYSxDQUFDLHFCQUFxQixHQUFHLE9BQU8sR0FBRyx5QkFBeUIsQ0FBQztRQUVsSCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDakMsQ0FBQztrRkFyTG1CLHdCQUF3Qjs2REFBeEIsd0JBQXdCOzs7Ozs7O2lGQUF4Qix3QkFBd0I7Y0FEN0MsU0FBUztxR0FFeUIsaUJBQWlCO2tCQUFqRCxLQUFLO21CQUFDLHdCQUF3QjtZQUVSLFVBQVU7a0JBQWhDLEtBQUs7bUJBQUMsY0FBYztZQUVjLHFCQUFxQjtrQkFBdkQsS0FBSzttQkFBQywwQkFBMEI7WUFFWCxRQUFRO2tCQUE3QixLQUFLO21CQUFDLGFBQWE7WUFFSyxVQUFVO2tCQUFsQyxNQUFNO21CQUFDLGVBQWU7WUFFRSxVQUFVO2tCQUFsQyxNQUFNO21CQUFDLGVBQWU7WUFFQyxTQUFTO2tCQUFoQyxTQUFTO21CQUFDLFdBQVc7WUFlQSxLQUFLO2tCQUExQixLQUFLO21CQUFDLFNBQVM7WUFZZSxhQUFhO2tCQUEzQyxLQUFLO21CQUFDLGtCQUFrQjtZQVVGLE1BQU07a0JBQTVCLEtBQUs7bUJBQUMsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT3V0cHV0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBQb0NoYXJ0VHlwZSB9IGZyb20gJy4uLy4uL2VudW1zL3BvLWNoYXJ0LXR5cGUuZW51bSc7XG5pbXBvcnQgeyBQb0NoYXJ0UGxvdEFyZWFQYWRkaW5nVG9wIH0gZnJvbSAnLi4vLi4vaGVscGVycy9wby1jaGFydC1kZWZhdWx0LXZhbHVlcy5jb25zdGFudCc7XG5cbmltcG9ydCB7IFBvQ2hhcnRDb250YWluZXJTaXplIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy9wby1jaGFydC1jb250YWluZXItc2l6ZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9DaGFydE1hdGhzU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3BvLWNoYXJ0LW1hdGhzLnNlcnZpY2UnO1xuaW1wb3J0IHsgUG9DaGFydE1pbk1heFZhbHVlcyB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvcG8tY2hhcnQtbWluLW1heC12YWx1ZXMuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvQ2hhcnRQYXRoQ29vcmRpbmF0ZXMgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL3BvLWNoYXJ0LXBhdGgtY29vcmRpbmF0ZXMuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvQ2hhcnRQb2ludHNDb29yZGluYXRlcyB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvcG8tY2hhcnQtcG9pbnRzLWNvb3JkaW5hdGVzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0NoYXJ0U2VyaWUgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL3BvLWNoYXJ0LXNlcmllLmludGVyZmFjZSc7XG5cbkBEaXJlY3RpdmUoKVxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFBvQ2hhcnRMaW5lQmFzZUNvbXBvbmVudCB7XG4gIEBJbnB1dCgncC1hbGlnbi1ieS10aGUtY29ybmVycycpIGFsaWduQnlUaGVDb3JuZXJzOiBib29sZWFuID0gZmFsc2U7XG5cbiAgQElucHV0KCdwLWNhdGVnb3JpZXMnKSBjYXRlZ29yaWVzOiBBcnJheTxzdHJpbmc+O1xuXG4gIEBJbnB1dCgncC1jYXRlZ29yaWVzLWNvb3JkaW5hdGVzJykgY2F0ZWdvcmllc0Nvb3JkaW5hdGVzOiBBcnJheTxudW1iZXI+O1xuXG4gIEBJbnB1dCgncC1zdmctc3BhY2UnKSBzdmdTcGFjZTtcblxuICBAT3V0cHV0KCdwLXBvaW50LWNsaWNrJykgcG9pbnRDbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIEBPdXRwdXQoJ3AtcG9pbnQtaG92ZXInKSBwb2ludEhvdmVyID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgQFZpZXdDaGlsZCgnY2hhcnRMaW5lJykgY2hhcnRMaW5lOiBFbGVtZW50UmVmO1xuXG4gIGFjdGl2ZVRvb2x0aXA6IGJvb2xlYW47XG4gIGFuaW1hdGU6IGJvb2xlYW4gPSB0cnVlO1xuICBjaGFydFR5cGU6IFBvQ2hhcnRUeXBlO1xuICBzZXJpZXNQYXRoc0Nvb3JkaW5hdGVzOiBBcnJheTxQb0NoYXJ0UGF0aENvb3JkaW5hdGVzPjtcbiAgc2VyaWVzUG9pbnRzQ29vcmRpbmF0ZXM6IEFycmF5PEFycmF5PFBvQ2hhcnRQb2ludHNDb29yZGluYXRlcz4+ID0gW107XG5cbiAgcHJvdGVjdGVkIGZpcnN0VmFsaWRJdGVtRnJvbVNlcmllQXJyYXk6IGJvb2xlYW47XG4gIHByb3RlY3RlZCBzZXJpZXNMZW5ndGg6IG51bWJlcjtcblxuICBwcml2YXRlIF9jb250YWluZXJTaXplOiBQb0NoYXJ0Q29udGFpbmVyU2l6ZSA9IHt9O1xuICBwcml2YXRlIF9yYW5nZTogUG9DaGFydE1pbk1heFZhbHVlcyA9IHt9O1xuICBwcml2YXRlIF9zZXJpZXM6IEFycmF5PFBvQ2hhcnRTZXJpZT4gPSBbXTtcblxuICBASW5wdXQoJ3AtcmFuZ2UnKSBzZXQgcmFuZ2UodmFsdWU6IFBvQ2hhcnRNaW5NYXhWYWx1ZXMpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QgJiYgISh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgdGhpcy5fcmFuZ2UgPSB2YWx1ZTtcblxuICAgICAgdGhpcy5zZXJpZVBhdGhQb2ludHNEZWZpbml0aW9uKHRoaXMuY29udGFpbmVyU2l6ZSwgdGhpcy5fc2VyaWVzLCB0aGlzLl9yYW5nZSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHJhbmdlKCkge1xuICAgIHJldHVybiB0aGlzLl9yYW5nZTtcbiAgfVxuXG4gIEBJbnB1dCgncC1jb250YWluZXItc2l6ZScpIHNldCBjb250YWluZXJTaXplKHZhbHVlOiBQb0NoYXJ0Q29udGFpbmVyU2l6ZSkge1xuICAgIHRoaXMuX2NvbnRhaW5lclNpemUgPSB2YWx1ZTtcblxuICAgIHRoaXMuc2VyaWVQYXRoUG9pbnRzRGVmaW5pdGlvbih0aGlzLl9jb250YWluZXJTaXplLCB0aGlzLnNlcmllcywgdGhpcy5yYW5nZSk7XG4gIH1cblxuICBnZXQgY29udGFpbmVyU2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fY29udGFpbmVyU2l6ZTtcbiAgfVxuXG4gIEBJbnB1dCgncC1zZXJpZXMnKSBzZXQgc2VyaWVzKHNlcmllc0xpc3Q6IEFycmF5PFBvQ2hhcnRTZXJpZT4pIHtcbiAgICBjb25zdCBzZXJpZXNEYXRhQXJyYXlGaWx0ZXIgPSBzZXJpZXNMaXN0LmZpbHRlcihzZXJpZSA9PiBBcnJheS5pc0FycmF5KHNlcmllLmRhdGEpKTtcblxuICAgIGlmIChzZXJpZXNEYXRhQXJyYXlGaWx0ZXIubGVuZ3RoKSB7XG4gICAgICB0aGlzLl9zZXJpZXMgPSBzZXJpZXNEYXRhQXJyYXlGaWx0ZXI7XG4gICAgICB0aGlzLmFuaW1hdGUgPSB0cnVlO1xuICAgICAgdGhpcy5zZXJpZXNMZW5ndGggPSB0aGlzLm1hdGhzU2VydmljZS5zZXJpZXNHcmVhdGVyTGVuZ3RoKHRoaXMuc2VyaWVzKTtcbiAgICAgIHRoaXMuY2hhcnRUeXBlID0gdGhpcy5fc2VyaWVzWzBdLnR5cGU7XG4gICAgICB0aGlzLnNlcmllUGF0aFBvaW50c0RlZmluaXRpb24odGhpcy5jb250YWluZXJTaXplLCBzZXJpZXNEYXRhQXJyYXlGaWx0ZXIsIHRoaXMucmFuZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zZXJpZXMgPSBbXTtcbiAgICB9XG4gIH1cblxuICBnZXQgc2VyaWVzKCkge1xuICAgIHJldHVybiB0aGlzLl9zZXJpZXM7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgbWF0aHNTZXJ2aWNlOiBQb0NoYXJ0TWF0aHNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCByZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgIHByb3RlY3RlZCBlbGVtZW50UmVmOiBFbGVtZW50UmVmXG4gICkge31cblxuICBvblNlcmllUG9pbnRDbGljayhzZWxlY3RlZEl0ZW06IGFueSkge1xuICAgIHRoaXMucG9pbnRDbGljay5lbWl0KHNlbGVjdGVkSXRlbSk7XG4gIH1cblxuICB0cmFja0J5KGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4O1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUb29sdGlwTGFiZWwoZGF0YTogbnVtYmVyLCBsYWJlbDogc3RyaW5nLCB0b29sdGlwTGFiZWw6IHN0cmluZykge1xuICAgIGNvbnN0IGRhdGFMYWJlbCA9IGxhYmVsID8gYCR7bGFiZWx9OiBgIDogJyc7XG4gICAgY29uc3QgZGF0YVZhbHVlID0gZGF0YS50b1N0cmluZygpO1xuXG4gICAgcmV0dXJuIHRvb2x0aXBMYWJlbCB8fCBgJHtkYXRhTGFiZWx9JHtkYXRhVmFsdWV9YDtcbiAgfVxuXG4gIHByaXZhdGUgc3ZnUGF0aENvbW1hbmQoKSB7XG4gICAgY29uc3QgY29tbWFuZCA9IHRoaXMuZmlyc3RWYWxpZEl0ZW1Gcm9tU2VyaWVBcnJheSA/ICdNJyA6ICdMJztcbiAgICAvLyBmaXJzdFZhbGlkSXRlbUZyb21TZXJpZUFycmF5OiB0cmF0YW1lbnRvIHBhcmEgcGVybWl0aXIgYW8gdXN1w6FyaW8gZGVmaW5pciBvIHByaW1laXJvIHZhbG9yIGNvbW8gbnVsbCBwYXJhIHF1ZSBzZWphIGlnbm9yYWRvO1xuICAgIHRoaXMuZmlyc3RWYWxpZEl0ZW1Gcm9tU2VyaWVBcnJheSA9IGZhbHNlO1xuXG4gICAgcmV0dXJuIGNvbW1hbmQ7XG4gIH1cblxuICBwcml2YXRlIHhDb29yZGluYXRlKGluZGV4OiBudW1iZXIsIGNvbnRhaW5lclNpemU6IFBvQ2hhcnRDb250YWluZXJTaXplKSB7XG4gICAgY29uc3QgaGFsZkNhdGVnb3J5V2lkdGggPSAhdGhpcy5hbGlnbkJ5VGhlQ29ybmVyc1xuICAgICAgPyAoY29udGFpbmVyU2l6ZS5zdmdXaWR0aCAtIGNvbnRhaW5lclNpemUuYXhpc1hMYWJlbFdpZHRoKSAvIHRoaXMuc2VyaWVzTGVuZ3RoIC8gMlxuICAgICAgOiAwO1xuXG4gICAgY29uc3QgZGl2aWRlSW5kZXhCeVNlcmllc0xlbmd0aCA9IGluZGV4IC8gKHRoaXMuYWxpZ25CeVRoZUNvcm5lcnMgPyB0aGlzLnNlcmllc0xlbmd0aCAtIDEgOiB0aGlzLnNlcmllc0xlbmd0aCk7XG4gICAgY29uc3QgeFJhdGlvID0gaXNOYU4oZGl2aWRlSW5kZXhCeVNlcmllc0xlbmd0aCkgPyAwIDogZGl2aWRlSW5kZXhCeVNlcmllc0xlbmd0aDtcblxuICAgIHJldHVybiBNYXRoLmZsb29yKFxuICAgICAgY29udGFpbmVyU2l6ZS5heGlzWExhYmVsV2lkdGggK1xuICAgICAgICBoYWxmQ2F0ZWdvcnlXaWR0aCArXG4gICAgICAgIChjb250YWluZXJTaXplLnN2Z1dpZHRoIC0gY29udGFpbmVyU2l6ZS5heGlzWExhYmVsV2lkdGgpICogeFJhdGlvXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc2VyaWVDYXRlZ29yeShpbmRleDogbnVtYmVyLCBjYXRlZ29yaWVzOiBBcnJheTxzdHJpbmc+ID0gW10pIHtcbiAgICByZXR1cm4gY2F0ZWdvcmllc1tpbmRleF0gPz8gdW5kZWZpbmVkO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXJpZVBhdGhQb2ludHNEZWZpbml0aW9uKFxuICAgIGNvbnRhaW5lclNpemU6IFBvQ2hhcnRDb250YWluZXJTaXplLFxuICAgIHNlcmllczogQXJyYXk8UG9DaGFydFNlcmllPixcbiAgICByYW5nZTogUG9DaGFydE1pbk1heFZhbHVlc1xuICApIHtcbiAgICB0aGlzLnNlcmllc1BvaW50c0Nvb3JkaW5hdGVzID0gW107XG5cbiAgICB0aGlzLnNlcmllc1BhdGhzQ29vcmRpbmF0ZXMgPSBzZXJpZXMubWFwKChzZXJpZTogUG9DaGFydFNlcmllKSA9PiB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShzZXJpZS5kYXRhKSkge1xuICAgICAgICBsZXQgcGF0aENvb3JkaW5hdGVzOiBzdHJpbmcgPSAnJztcbiAgICAgICAgbGV0IHBvaW50Q29vcmRpbmF0ZXM6IEFycmF5PFBvQ2hhcnRQb2ludHNDb29yZGluYXRlcz4gPSBbXTtcbiAgICAgICAgY29uc3QgY29sb3IgPSBzZXJpZS5jb2xvcjtcbiAgICAgICAgdGhpcy5maXJzdFZhbGlkSXRlbUZyb21TZXJpZUFycmF5ID0gdHJ1ZTtcblxuICAgICAgICBzZXJpZS5kYXRhLmZvckVhY2goKGRhdGEsIGluZGV4KSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMubWF0aHNTZXJ2aWNlLnZlcmlmeUlmRmxvYXRPckludGVnZXIoZGF0YSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHN2Z1BhdGhDb21tYW5kID0gdGhpcy5zdmdQYXRoQ29tbWFuZCgpO1xuICAgICAgICAgICAgY29uc3QgeENvb3JkaW5hdGUgPSB0aGlzLnhDb29yZGluYXRlKGluZGV4LCBjb250YWluZXJTaXplKTtcbiAgICAgICAgICAgIGNvbnN0IHlDb29yZGluYXRlID0gdGhpcy55Q29vcmRpbmF0ZShyYW5nZSwgZGF0YSwgY29udGFpbmVyU2l6ZSk7XG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yeSA9IHRoaXMuc2VyaWVDYXRlZ29yeShpbmRleCwgdGhpcy5jYXRlZ29yaWVzKTtcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gc2VyaWUubGFiZWw7XG4gICAgICAgICAgICBjb25zdCB0b29sdGlwID0gc2VyaWUudG9vbHRpcDtcbiAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBMYWJlbCA9IHRoaXMuZ2V0VG9vbHRpcExhYmVsKGRhdGEsIGxhYmVsLCB0b29sdGlwKTtcbiAgICAgICAgICAgIGNvbnN0IGlzQWN0aXZlID0gdGhpcy5jaGFydFR5cGUgPT09IFBvQ2hhcnRUeXBlLkxpbmU7XG4gICAgICAgICAgICBwb2ludENvb3JkaW5hdGVzID0gW1xuICAgICAgICAgICAgICAuLi5wb2ludENvb3JkaW5hdGVzLFxuICAgICAgICAgICAgICB7IGNhdGVnb3J5LCBsYWJlbCwgdG9vbHRpcExhYmVsLCBkYXRhOiBkYXRhLCB4Q29vcmRpbmF0ZSwgeUNvb3JkaW5hdGUsIGNvbG9yLCBpc0FjdGl2ZSB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgcGF0aENvb3JkaW5hdGVzICs9IGAgJHtzdmdQYXRoQ29tbWFuZH0ke3hDb29yZGluYXRlfSAke3lDb29yZGluYXRlfWA7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBwYXRoQ29vcmRpbmF0ZXMgPSB0aGlzLnZlcmlmeUlmQ2xvc2VQYXRoKHBhdGhDb29yZGluYXRlcywgc2VyaWUuZGF0YS5sZW5ndGggLSAxLCByYW5nZSwgMCwgY29udGFpbmVyU2l6ZSk7XG5cbiAgICAgICAgdGhpcy5zZXJpZXNQb2ludHNDb29yZGluYXRlcyA9IFsuLi50aGlzLnNlcmllc1BvaW50c0Nvb3JkaW5hdGVzLCBwb2ludENvb3JkaW5hdGVzXTtcblxuICAgICAgICByZXR1cm4geyBjb29yZGluYXRlczogcGF0aENvb3JkaW5hdGVzLCBjb2xvciwgaXNBY3RpdmU6IHRydWUgfTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgdmVyaWZ5SWZDbG9zZVBhdGgocGF0aENvb3JkaW5hdGVzLCBsYXN0SW5kZXgsIHJhbmdlLCBkYXRhLCBjb250YWluZXJTaXplKSB7XG4gICAgY29uc3QgeyBheGlzWExhYmVsV2lkdGgsIHN2Z1dpZHRoIH0gPSBjb250YWluZXJTaXplO1xuXG4gICAgaWYgKHRoaXMuY2hhcnRUeXBlID09PSBQb0NoYXJ0VHlwZS5BcmVhKSB7XG4gICAgICBjb25zdCB4TGFzdFBvc2l0aW9uID0gdGhpcy54Q29vcmRpbmF0ZShsYXN0SW5kZXgsIGNvbnRhaW5lclNpemUpO1xuICAgICAgY29uc3QgYmFzZVlDb29yZGluYXRlID0gdGhpcy55Q29vcmRpbmF0ZShyYW5nZSwgZGF0YSwgY29udGFpbmVyU2l6ZSk7XG4gICAgICBjb25zdCB4SW5pdGlhbFBvc2l0aW9uID0gTWF0aC5mbG9vcihcbiAgICAgICAgdGhpcy5hbGlnbkJ5VGhlQ29ybmVyc1xuICAgICAgICAgID8gYXhpc1hMYWJlbFdpZHRoXG4gICAgICAgICAgOiBheGlzWExhYmVsV2lkdGggKyAoc3ZnV2lkdGggLSBheGlzWExhYmVsV2lkdGgpIC8gdGhpcy5zZXJpZXNMZW5ndGggLyAyXG4gICAgICApO1xuXG4gICAgICByZXR1cm4gYCR7cGF0aENvb3JkaW5hdGVzfSAke3hMYXN0UG9zaXRpb259ICR7YmFzZVlDb29yZGluYXRlfSBMJHt4SW5pdGlhbFBvc2l0aW9ufSAke2Jhc2VZQ29vcmRpbmF0ZX0gWmA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhdGhDb29yZGluYXRlcztcbiAgfVxuXG4gIHByaXZhdGUgeUNvb3JkaW5hdGUocmFuZ2U6IFBvQ2hhcnRNaW5NYXhWYWx1ZXMsIGRhdGE6IG51bWJlciwgY29udGFpbmVyU2l6ZTogUG9DaGFydENvbnRhaW5lclNpemUpIHtcbiAgICBjb25zdCB5UnJhdGlvID0gdGhpcy5tYXRoc1NlcnZpY2UuZ2V0U2VyaWVQZXJjZW50YWdlKHJhbmdlLCBkYXRhKTtcbiAgICBjb25zdCB5Q29vcmRpbmF0ZSA9XG4gICAgICBjb250YWluZXJTaXplLnN2Z1Bsb3R0aW5nQXJlYUhlaWdodCAtIGNvbnRhaW5lclNpemUuc3ZnUGxvdHRpbmdBcmVhSGVpZ2h0ICogeVJyYXRpbyArIFBvQ2hhcnRQbG90QXJlYVBhZGRpbmdUb3A7XG5cbiAgICByZXR1cm4gTWF0aC5mbG9vcih5Q29vcmRpbmF0ZSk7XG4gIH1cbn1cbiJdfQ==