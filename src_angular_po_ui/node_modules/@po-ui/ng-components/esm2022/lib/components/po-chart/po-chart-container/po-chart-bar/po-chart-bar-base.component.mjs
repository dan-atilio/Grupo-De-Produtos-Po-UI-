import { Directive, EventEmitter, Input, Output } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "../../services/po-chart-maths.service";
export class PoChartBarBaseComponent {
    mathsService;
    categories;
    barClick = new EventEmitter();
    barHover = new EventEmitter();
    seriesPathsCoordinates;
    seriesGreaterLength;
    _containerSize = {};
    _range = {};
    _series = [];
    set range(value) {
        if (value instanceof Object && !(value instanceof Array)) {
            this._range = value;
            this.calculateSeriesPathsCoordinates(this.containerSize, this._series, this._range);
        }
    }
    get range() {
        return this._range;
    }
    set containerSize(value) {
        this._containerSize = value;
        this.calculateSeriesPathsCoordinates(this._containerSize, this.series, this.range);
    }
    get containerSize() {
        return this._containerSize;
    }
    set series(seriesList) {
        const seriesDataArrayFilter = seriesList.filter(serie => Array.isArray(serie.data));
        if (seriesDataArrayFilter.length) {
            this._series = seriesDataArrayFilter;
            this.seriesGreaterLength = this.mathsService.seriesGreaterLength(this.series);
            this.calculateSeriesPathsCoordinates(this.containerSize, seriesDataArrayFilter, this.range);
        }
        else {
            this._series = [];
        }
    }
    get series() {
        return this._series;
    }
    constructor(mathsService) {
        this.mathsService = mathsService;
    }
    onSerieBarClick(selectedItem) {
        this.barClick.emit(selectedItem);
    }
    onSerieBarHover(selectedItem) {
        this.barHover.emit(selectedItem);
    }
    trackBy(index) {
        return index;
    }
    calculateSeriesPathsCoordinates(containerSize, series, range) {
        this.seriesPathsCoordinates = series.map((serie, seriesIndex) => {
            if (Array.isArray(serie.data)) {
                let pathCoordinates = [];
                serie.data.forEach((data, serieDataIndex) => {
                    if (this.mathsService.verifyIfFloatOrInteger(data)) {
                        const coordinates = this.barCoordinates(seriesIndex, serieDataIndex, containerSize, range, data);
                        const category = this.serieCategory(serieDataIndex, this.categories);
                        const label = serie['label'];
                        const color = serie['color'];
                        const tooltip = serie['tooltip'];
                        const tooltipLabel = this.getTooltipLabel(data, label, tooltip);
                        pathCoordinates = [...pathCoordinates, { category, color, label, tooltipLabel, data, coordinates }];
                    }
                });
                return pathCoordinates;
            }
        });
    }
    getTooltipLabel(data, label, tooltipLabel) {
        const dataLabel = label ? `${label}: ` : '';
        const dataValue = data.toString();
        return tooltipLabel || `${dataLabel}${dataValue}`;
    }
    serieCategory(index, categories = []) {
        return categories[index] ?? undefined;
    }
    static ɵfac = function PoChartBarBaseComponent_Factory(t) { return new (t || PoChartBarBaseComponent)(i0.ɵɵdirectiveInject(i1.PoChartMathsService)); };
    static ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: PoChartBarBaseComponent, inputs: { categories: [i0.ɵɵInputFlags.None, "p-categories", "categories"], range: [i0.ɵɵInputFlags.None, "p-range", "range"], containerSize: [i0.ɵɵInputFlags.None, "p-container-size", "containerSize"], series: [i0.ɵɵInputFlags.None, "p-series", "series"] }, outputs: { barClick: "p-bar-click", barHover: "p-bar-hover" } });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoChartBarBaseComponent, [{
        type: Directive
    }], () => [{ type: i1.PoChartMathsService }], { categories: [{
            type: Input,
            args: ['p-categories']
        }], barClick: [{
            type: Output,
            args: ['p-bar-click']
        }], barHover: [{
            type: Output,
            args: ['p-bar-hover']
        }], range: [{
            type: Input,
            args: ['p-range']
        }], containerSize: [{
            type: Input,
            args: ['p-container-size']
        }], series: [{
            type: Input,
            args: ['p-series']
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tY2hhcnQtYmFyLWJhc2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdWkvc3JjL2xpYi9jb21wb25lbnRzL3BvLWNoYXJ0L3BvLWNoYXJ0LWNvbnRhaW5lci9wby1jaGFydC1iYXIvcG8tY2hhcnQtYmFyLWJhc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7OztBQVV2RSxNQUFNLE9BQWdCLHVCQUF1QjtJQXFEckI7SUFwREMsVUFBVSxDQUFnQjtJQUUxQixRQUFRLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztJQUVuQyxRQUFRLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztJQUUxRCxzQkFBc0IsQ0FBc0M7SUFFbEQsbUJBQW1CLENBQVM7SUFFOUIsY0FBYyxHQUF5QixFQUFFLENBQUM7SUFDMUMsTUFBTSxHQUF3QixFQUFFLENBQUM7SUFDakMsT0FBTyxHQUF3QixFQUFFLENBQUM7SUFFMUMsSUFBc0IsS0FBSyxDQUFDLEtBQTBCO1FBQ3BELElBQUksS0FBSyxZQUFZLE1BQU0sSUFBSSxDQUFDLENBQUMsS0FBSyxZQUFZLEtBQUssQ0FBQyxFQUFFO1lBQ3hELElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1lBRXBCLElBQUksQ0FBQywrQkFBK0IsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ3JGO0lBQ0gsQ0FBQztJQUVELElBQUksS0FBSztRQUNQLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUNyQixDQUFDO0lBRUQsSUFBK0IsYUFBYSxDQUFDLEtBQTJCO1FBQ3RFLElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFD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LENBQUM7Z0JBRUgsT0FBTyxlQUFlLENBQUM7YUFDeEI7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFTyxlQUFlLENBQUMsSUFBWSxFQUFFLEtBQWEsRUFBRSxZQUFvQjtRQUN2RSxNQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUM1QyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFFbEMsT0FBTyxZQUFZLElBQUksR0FBRyxTQUFTLEdBQUcsU0FBUyxFQUFFLENBQUM7SUFDcEQsQ0FBQztJQUVPLGFBQWEsQ0FBQyxLQUFhLEVBQUUsYUFBNEIsRUFBRTtRQUNqRSxPQUFPLFVBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxTQUFTLENBQUM7SUFDeEMsQ0FBQztpRkF4R21CLHVCQUF1Qjs2REFBdkIsdUJBQXVCOztpRkFBdkIsdUJBQXVCO2NBRDVDLFNBQVM7b0RBRWUsVUFBVTtrQkFBaEMsS0FBSzttQkFBQyxjQUFjO1lBRUUsUUFBUTtrQkFBOUIsTUFBTTttQkFBQyxhQUFhO1lBRUUsUUFBUTtrQkFBOUIsTUFBTTttQkFBQyxhQUFhO1lBVUMsS0FBSztrQkFBMUIsS0FBSzttQkFBQyxTQUFTO1lBWWUsYUFBYTtrQkFBM0MsS0FBSzttQkFBQyxrQkFBa0I7WUFVRixNQUFNO2tCQUE1QixLQUFLO21CQUFDLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBQb0NoYXJ0TWF0aHNTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcG8tY2hhcnQtbWF0aHMuc2VydmljZSc7XG5cbmltcG9ydCB7IFBvQ2hhcnRDb250YWluZXJTaXplIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy9wby1jaGFydC1jb250YWluZXItc2l6ZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9DaGFydE1pbk1heFZhbHVlcyB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvcG8tY2hhcnQtbWluLW1heC12YWx1ZXMuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvQ2hhcnRCYXJDb29yZGluYXRlcyB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvcG8tY2hhcnQtYmFyLWNvb3JkaW5hdGVzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQb0NoYXJ0U2VyaWUgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL3BvLWNoYXJ0LXNlcmllLmludGVyZmFjZSc7XG5cbkBEaXJlY3RpdmUoKVxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFBvQ2hhcnRCYXJCYXNlQ29tcG9uZW50IHtcbiAgQElucHV0KCdwLWNhdGVnb3JpZXMnKSBjYXRlZ29yaWVzOiBBcnJheTxzdHJpbmc+O1xuXG4gIEBPdXRwdXQoJ3AtYmFyLWNsaWNrJykgYmFyQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBAT3V0cHV0KCdwLWJhci1ob3ZlcicpIGJhckhvdmVyID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgc2VyaWVzUGF0aHNDb29yZGluYXRlczogQXJyYXk8QXJyYXk8UG9DaGFydEJhckNvb3JkaW5hdGVzPj47XG5cbiAgcHJvdGVjdGVkIHNlcmllc0dyZWF0ZXJMZW5ndGg6IG51bWJlcjtcblxuICBwcml2YXRlIF9jb250YWluZXJTaXplOiBQb0NoYXJ0Q29udGFpbmVyU2l6ZSA9IHt9O1xuICBwcml2YXRlIF9yYW5nZTogUG9DaGFydE1pbk1heFZhbHVlcyA9IHt9O1xuICBwcml2YXRlIF9zZXJpZXM6IEFycmF5PFBvQ2hhcnRTZXJpZT4gPSBbXTtcblxuICBASW5wdXQoJ3AtcmFuZ2UnKSBzZXQgcmFuZ2UodmFsdWU6IFBvQ2hhcnRNaW5NYXhWYWx1ZXMpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QgJiYgISh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgdGhpcy5fcmFuZ2UgPSB2YWx1ZTtcblxuICAgICAgdGhpcy5jYWxjdWxhdGVTZXJpZXNQYXRoc0Nvb3JkaW5hdGVzKHRoaXMuY29udGFpbmVyU2l6ZSwgdGhpcy5fc2VyaWVzLCB0aGlzLl9yYW5nZSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHJhbmdlKCkge1xuICAgIHJldHVybiB0aGlzLl9yYW5nZTtcbiAgfVxuXG4gIEBJbnB1dCgncC1jb250YWluZXItc2l6ZScpIHNldCBjb250YWluZXJTaXplKHZhbHVlOiBQb0NoYXJ0Q29udGFpbmVyU2l6ZSkge1xuICAgIHRoaXMuX2NvbnRhaW5lclNpemUgPSB2YWx1ZTtcblxuICAgIHRoaXMuY2FsY3VsYXRlU2VyaWVzUGF0aHNDb29yZGluYXRlcyh0aGlzLl9jb250YWluZXJTaXplLCB0aGlzLnNlcmllcywgdGhpcy5yYW5nZSk7XG4gIH1cblxuICBnZXQgY29udGFpbmVyU2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fY29udGFpbmVyU2l6ZTtcbiAgfVxuXG4gIEBJbnB1dCgncC1zZXJpZXMnKSBzZXQgc2VyaWVzKHNlcmllc0xpc3Q6IEFycmF5PFBvQ2hhcnRTZXJpZT4pIHtcbiAgICBjb25zdCBzZXJpZXNEYXRhQXJyYXlGaWx0ZXIgPSBzZXJpZXNMaXN0LmZpbHRlcihzZXJpZSA9PiBBcnJheS5pc0FycmF5KHNlcmllLmRhdGEpKTtcblxuICAgIGlmIChzZXJpZXNEYXRhQXJyYXlGaWx0ZXIubGVuZ3RoKSB7XG4gICAgICB0aGlzLl9zZXJpZXMgPSBzZXJpZXNEYXRhQXJyYXlGaWx0ZXI7XG4gICAgICB0aGlzLnNlcmllc0dyZWF0ZXJMZW5ndGggPSB0aGlzLm1hdGhzU2VydmljZS5zZXJpZXNHcmVhdGVyTGVuZ3RoKHRoaXMuc2VyaWVzKTtcbiAgICAgIHRoaXMuY2FsY3VsYXRlU2VyaWVzUGF0aHNDb29yZGluYXRlcyh0aGlzLmNvbnRhaW5lclNpemUsIHNlcmllc0RhdGFBcnJheUZpbHRlciwgdGhpcy5yYW5nZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NlcmllcyA9IFtdO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzZXJpZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3NlcmllcztcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBtYXRoc1NlcnZpY2U6IFBvQ2hhcnRNYXRoc1NlcnZpY2UpIHt9XG5cbiAgb25TZXJpZUJhckNsaWNrKHNlbGVjdGVkSXRlbTogYW55KSB7XG4gICAgdGhpcy5iYXJDbGljay5lbWl0KHNlbGVjdGVkSXRlbSk7XG4gIH1cblxuICBvblNlcmllQmFySG92ZXIoc2VsZWN0ZWRJdGVtOiBhbnkpIHtcbiAgICB0aGlzLmJhckhvdmVyLmVtaXQoc2VsZWN0ZWRJdGVtKTtcbiAgfVxuXG4gIHRyYWNrQnkoaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXg7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZVNlcmllc1BhdGhzQ29vcmRpbmF0ZXMoXG4gICAgY29udGFpbmVyU2l6ZTogUG9DaGFydENvbnRhaW5lclNpemUsXG4gICAgc2VyaWVzOiBBcnJheTxQb0NoYXJ0U2VyaWU+LFxuICAgIHJhbmdlOiBQb0NoYXJ0TWluTWF4VmFsdWVzXG4gICkge1xuICAgIHRoaXMuc2VyaWVzUGF0aHNDb29yZGluYXRlcyA9IHNlcmllcy5tYXAoKHNlcmllOiBQb0NoYXJ0U2VyaWUsIHNlcmllc0luZGV4KSA9PiB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShzZXJpZS5kYXRhKSkge1xuICAgICAgICBsZXQgcGF0aENvb3JkaW5hdGVzOiBBcnJheTxQb0NoYXJ0QmFyQ29vcmRpbmF0ZXM+ID0gW107XG5cbiAgICAgICAgc2VyaWUuZGF0YS5mb3JFYWNoKChkYXRhLCBzZXJpZURhdGFJbmRleCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLm1hdGhzU2VydmljZS52ZXJpZnlJZkZsb2F0T3JJbnRlZ2VyKGRhdGEpKSB7XG4gICAgICAgICAgICBjb25zdCBjb29yZGluYXRlcyA9IHRoaXMuYmFyQ29vcmRpbmF0ZXMoc2VyaWVzSW5kZXgsIHNlcmllRGF0YUluZGV4LCBjb250YWluZXJTaXplLCByYW5nZSwgZGF0YSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gdGhpcy5zZXJpZUNhdGVnb3J5KHNlcmllRGF0YUluZGV4LCB0aGlzLmNhdGVnb3JpZXMpO1xuICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBzZXJpZVsnbGFiZWwnXTtcbiAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gc2VyaWVbJ2NvbG9yJ107XG4gICAgICAgICAgICBjb25zdCB0b29sdGlwID0gc2VyaWVbJ3Rvb2x0aXAnXTtcbiAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBMYWJlbCA9IHRoaXMuZ2V0VG9vbHRpcExhYmVsKGRhdGEsIGxhYmVsLCB0b29sdGlwKTtcblxuICAgICAgICAgICAgcGF0aENvb3JkaW5hdGVzID0gWy4uLnBhdGhDb29yZGluYXRlcywgeyBjYXRlZ29yeSwgY29sb3IsIGxhYmVsLCB0b29sdGlwTGFiZWwsIGRhdGEsIGNvb3JkaW5hdGVzIH1dO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHBhdGhDb29yZGluYXRlcztcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VG9vbHRpcExhYmVsKGRhdGE6IG51bWJlciwgbGFiZWw6IHN0cmluZywgdG9vbHRpcExhYmVsOiBzdHJpbmcpIHtcbiAgICBjb25zdCBkYXRhTGFiZWwgPSBsYWJlbCA/IGAke2xhYmVsfTogYCA6ICcnO1xuICAgIGNvbnN0IGRhdGFWYWx1ZSA9IGRhdGEudG9TdHJpbmcoKTtcblxuICAgIHJldHVybiB0b29sdGlwTGFiZWwgfHwgYCR7ZGF0YUxhYmVsfSR7ZGF0YVZhbHVlfWA7XG4gIH1cblxuICBwcml2YXRlIHNlcmllQ2F0ZWdvcnkoaW5kZXg6IG51bWJlciwgY2F0ZWdvcmllczogQXJyYXk8c3RyaW5nPiA9IFtdKSB7XG4gICAgcmV0dXJuIGNhdGVnb3JpZXNbaW5kZXhdID8/IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHByb3RlY3RlZCBhYnN0cmFjdCBiYXJDb29yZGluYXRlcyhcbiAgICBzZXJpZXNJbmRleDogbnVtYmVyLFxuICAgIHNlcmllRGF0YUluZGV4OiBudW1iZXIsXG4gICAgY29udGFpbmVyU2l6ZTogUG9DaGFydENvbnRhaW5lclNpemUsXG4gICAgcmFuZ2U6IFBvQ2hhcnRNaW5NYXhWYWx1ZXMsXG4gICAgc2VyaWVWYWx1ZTogbnVtYmVyXG4gICk7XG59XG4iXX0=