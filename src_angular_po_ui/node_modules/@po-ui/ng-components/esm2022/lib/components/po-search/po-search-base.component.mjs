import { poLocaleDefault } from '../../services/po-language/po-language.constant';
import { Directive, EventEmitter, Input, Output } from '@angular/core';
import { convertToBoolean } from '../../utils/util';
import { poSearchLiteralsDefault } from './literals/po-search-literals-default';
import { PoSearchFilterMode } from './enum/po-search-filter-mode.enum';
import * as i0 from "@angular/core";
import * as i1 from "../../services/po-language/po-language.service";
/**
 * @description
 *
 * O componente search, também conhecido como barra de pesquisa, é utilizado para ajudar os usuários a localizar um determinado conteúdo
 *
 * Normalmente localizado no canto superior direito, junto com o ícone de lupa, uma vez que este ícone é amplamente reconhecido.
 *
 * Portanto, é de extrema importância que, ao utilizar este componente, as pessoas responsáveis por seu desenvolvimento considerem os seguintes critérios.
 *
 * #### Boas práticas
 *
 * Foram estruturados os padrões de usabilidade para auxiliar na utilização do componente e garantir uma boa experiência aos usuários. Por isso, é muito importante que ao utilizar este componente, as pessoas que o projetarem devem levar em consideração os seguintes critérios:
 * - Utilize labels para apresentar resultados que estão sendo exibidos e apresente os resultados mais relevantes primeiro.
 * - Exiba uma mensagem clara quando não forem encontrados resultados para busca e sempre que possível ofereça outras sugestões de busca.
 * - Mantenha o texto original no campo de input, que facilita a ação do usuário caso queira fazer uma nova busca com alguma modificação na pesquisa.
 * - Caso seja possível detectar um erro de digitação, mostre os resultados para a palavra "corrigida", isso evita a frustração de não obter resultados e não força o usuário a realizar uma nova busca.
 * - Quando apropriado, destaque os termos da busca nos resultados.
 * - A entrada do campo de pesquisa deve caber em uma linha. Não use entradas de pesquisa de várias linhas.
 * - Recomenda-se ter apenas uma pesquisa por página. Se você precisar de várias pesquisas, rotule-as claramente para indicar sua finalidade.
 * - Se possível, forneça sugestões de pesquisa, seja em um helptext ou sugestão de pesquisa que é um autocomplete. Isso ajuda os usuários a encontrar o que estão procurando, especialmente se os itens pesquisáveis forem complexos.
 *
 * #### Acessibilidade tratada no componente
 *
 *  Algumas diretrizes de acessibilidade já são tratadas no componente, internamente, e não podem ser alteradas pelo proprietário do conteúdo. São elas:
 *
 * - Permitir a interação via teclado (2.1.1: Keyboard (A));
 * - Alteração entre os estados precisa ser indicada por mais de um elemento além da cor (1.4.1: Use of Color);
 *
 * #### Tokens customizáveis
 *
 * É possível alterar o estilo do componente usando os seguintes tokens (CSS):
 *
 * > Para maiores informações, acesse o guia [Personalizando o Tema Padrão com Tokens CSS](https://po-ui.io/guides/theme-customization).
 *
 * | Propriedade                             | Descrição                                            | Valor Padrão                                      |
 * |----------------------------------------|-------------------------------------------------------|---------------------------------------------------|
 * | **Default Values**                     |                                                       |                                                   |
 * | `--font-family`                        | Família tipográfica usada                             | `var(--font-family-theme)`                        |
 * | `--font-size`                          | Tamanho da fonte                                      | `var(--font-size-default)`                        |
 * | `--text-color-placeholder`             | Cor do texto no placeholder                           | `var(--color-neutral-light-30)`                   |
 * | `--color`                              | Cor principal do search                               | `var(--color-neutral-dark-70)`                    |
 * | `--border-radius`                      | Contém o valor do raio dos cantos do elemento&nbsp;   | `var(--border-radius-md)`                         |
 * | `--background`                         | Cor de background                                     | `var(--color-neutral-light-05)`                   |
 * | `--text-color`                         | Cor do texto                                          | `var(--color-neutral-dark-90)`                    |
 * | `--color-clear`                        | Cor principal do icone close                          | `var(--color-action-default)`                     |
 * | **Icon**                               |                                                       |                                                   |
 * | `--color-icon-read`                    | Cor principal do icone de leitura                     | `var(--color-neutral-dark-70)`                    |
 * | `--color-icon`                         | Cor principal do icone                                | `var(--color-action-default)`                     |
 * | **Hover**                              |                                                       |                                                   |
 * | `--color-hover`                        | Cor principal no estado hover                         | `var(--color-action-hover)`                       |
 * | `--background-hover`                   | Cor de background no estado hover                     | `var(--color-brand-01-lightest)`                  |
 * | **Focused**                            |                                                       |                                                   |
 * | `--color-focused`                      | Cor principal no estado de focus                      | `var(--color-action-default)`                     |
 * | `--outline-color-focused`              | Cor do outline do estado de focus                     | `var(--color-action-focus)`                       |
 * | **Disabled**                           |                                                       |                                                   |
 * | `--color-disabled`                     | Cor principal no estado disabled                      | `var(--color-action-disabled)`                    |
 * | `--background-color-disabled`          | Cor de background no estado disabled                  | `var(--color-neutral-light-20)`                   |
 *
 */
export class PoSearchBaseComponent {
    _literals;
    _ariaLabel;
    language;
    _filterSelect;
    /**
     * @optional
     *
     * @description
     *
     * Desabilita o po-search e não permite que o usuário interaja com o mesmo.
     *
     * @default `false`
     */
    disabled;
    /**
     * @optional
     *
     * @description
     *
     * Lista de itens que serão utilizados para pesquisa
     */
    items = [];
    /**
     * @optional
     *
     * @description
     *
     * Define um aria-label para o po-search.
     *
     * > Devido o componente não possuir uma label assim como outros campos de texto, o `aria-label` é utilizado para acessibilidade.
     */
    set ariaLabel(value) {
        this._ariaLabel = value;
        if (value !== this.literals.search) {
            this._ariaLabel = `${this._ariaLabel} ${this.literals.search}`;
        }
    }
    get ariaLabel() {
        return this._ariaLabel;
    }
    /**
     * @description
     *
     * Deve ser informado o nome da propriedade do objeto que será utilizado para a conversão dos itens apresentados na lista do componente (p-items), esta propriedade será responsável pelo texto de apresentação de cada item da lista.
     */
    filterKeys = [];
    /**
     * @optional
     *
     * @description
     *
     * Deve ser informado o nome da propriedade do objeto que será utilizado para a conversão dos itens apresentados na lista do componente (p-items), esta propriedade será responsável pelo texto de apresentação de cada item da lista.
     */
    icon;
    /**
     * @optional
     *
     * @description
     *
     * Determina a forma de realizar a pesquisa no componente
     *
     * Valores aceitos:
     * - `action`: Realiza a busca a cada caractere digitado.
     * - `trigger`: Realiza a busca ao pressionar `enter` ou clicar no ícone de busca.
     *
     * @default `action`
     */
    type = 'action';
    /**
     * @optional
     *
     * @description
     *
     * Objeto com as literais usadas no `po-search`.
     *
     * Para utilizar basta passar a literal que deseja customizar:
     *
     * ```
     *  const customLiterals: PoSearchLiterals = {
     *    search: 'Pesquisar',
     *    clean: 'Limpar',
     *  };
     * ```
     *
     * E para carregar a literal customizada, basta apenas passar o objeto para o componente.
     *
     * ```
     * <po-search
     *   [p-literals]="customLiterals">
     * </po-search>
     * ```
     *
     * > O objeto padrão de literais será traduzido de acordo com o idioma do
     * [`PoI18nService`](/documentation/po-i18n) ou do browser.
     */
    set literals(value) {
        if (value instanceof Object && !(value instanceof Array)) {
            this._literals = {
                ...poSearchLiteralsDefault[poLocaleDefault],
                ...poSearchLiteralsDefault[this.language],
                ...value
            };
        }
        else {
            this._literals = poSearchLiteralsDefault[this.language];
        }
    }
    get literals() {
        return this._literals || poSearchLiteralsDefault[this.language];
    }
    /**
     * @optional
     *
     * @description
     *
     * Define o modo de pesquisa utilizado no campo de busca, quando habilitado. Valores definidos no enum: PoSearchFilterMode
     *
     * @default `startsWith`
     */
    filterType = PoSearchFilterMode.startsWith;
    /**
     * @optional
     *
     * @description
     *
     * Exibe uma lista (auto-complete) com as opções definidas no `p-filter-keys` enquanto realiza uma busca,
     * respeitando o `p-filter-type` como modo de pesquisa.
     *
     * @default `false`
     */
    showListbox = false;
    /**
     * @description
     *
     * Define os tipos de filtros (p-filter-keys) a serem aplicados na busca ou lista do componente (p-items).
     * Automaticamente adiciona a opção 'Todos', com um mapeamento de todas as opções passadas.
     *
     * > O uso desta propriedade torna a propriedade 'p-filter-keys' inválida.
     *
     * Exemplo de uso:
     * ```typescript
     * const filterSelect = [
     *   { label: 'personal', value: ['name', 'email', 'nickname'] },
     *   { label: 'address', value: ['country', 'state', 'city', 'street'] },
     *   { label: 'family', value: ['father', 'mother', 'dependents'] }
     * ];
     * ```
     */
    set filterSelect(values) {
        if (!Array.isArray(values) || values.length === 0 || values.every(value => Object.keys(value).length === 0)) {
            this._filterSelect = undefined;
            return;
        }
        const _values = this.ensureFilterSelectOption(values);
        const allValues = _values.flatMap(e => e.value);
        const uniqueValues = [...new Set(allValues)];
        const filterOptionAll = {
            label: this.literals.all,
            value: uniqueValues
        };
        this._filterSelect = [filterOptionAll, ..._values];
    }
    get filterSelect() {
        return this._filterSelect;
    }
    /**
     * @optional
     *
     * @description
     *
     * Evento disparado ao alterar valor do model.
     */
    changeModel = new EventEmitter();
    /**
     * @optional
     *
     * @description
     *
     * Pode ser informada uma função que será disparada quando houver alterações no input.
     */
    filteredItemsChange = new EventEmitter();
    /**
     * @optional
     *
     * @description
     *
     * Pode ser informada uma função que será disparada quando houver alterações nos filtros.
     */
    filter = new EventEmitter();
    /**
     * @optional
     *
     * @description
     *
     * Pode ser informada uma função que será disparada quando houver click no listbox.
     */
    listboxOnClick = new EventEmitter();
    constructor(languageService) {
        this.language = languageService.getShortLanguage();
    }
    ensureFilterSelectOption(values) {
        const _values = Array.isArray(values) ? values : Array.of(values);
        return _values.map(value => (typeof value === 'object' ? value : { label: value, value }));
    }
    static ɵfac = function PoSearchBaseComponent_Factory(t) { return new (t || PoSearchBaseComponent)(i0.ɵɵdirectiveInject(i1.PoLanguageService)); };
    static ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: PoSearchBaseComponent, inputs: { disabled: [i0.ɵɵInputFlags.HasDecoratorInputTransform, "p-disabled", "disabled", convertToBoolean], items: [i0.ɵɵInputFlags.None, "p-items", "items"], ariaLabel: [i0.ɵɵInputFlags.None, "p-aria-label", "ariaLabel"], filterKeys: [i0.ɵɵInputFlags.None, "p-filter-keys", "filterKeys"], icon: [i0.ɵɵInputFlags.None, "p-icon", "icon"], type: [i0.ɵɵInputFlags.None, "p-search-type", "type"], literals: [i0.ɵɵInputFlags.None, "p-literals", "literals"], filterType: [i0.ɵɵInputFlags.None, "p-filter-type", "filterType"], showListbox: [i0.ɵɵInputFlags.HasDecoratorInputTransform, "p-show-listbox", "showListbox", convertToBoolean], filterSelect: [i0.ɵɵInputFlags.None, "p-filter-select", "filterSelect"] }, outputs: { changeModel: "p-change-model", filteredItemsChange: "p-filtered-items-change", filter: "p-filter", listboxOnClick: "p-listbox-onclick" }, features: [i0.ɵɵInputTransformsFeature] });
}
(() => { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoSearchBaseComponent, [{
        type: Directive
    }], () => [{ type: i1.PoLanguageService }], { disabled: [{
            type: Input,
            args: [{ alias: 'p-disabled', transform: convertToBoolean }]
        }], items: [{
            type: Input,
            args: ['p-items']
        }], ariaLabel: [{
            type: Input,
            args: ['p-aria-label']
        }], filterKeys: [{
            type: Input,
            args: ['p-filter-keys']
        }], icon: [{
            type: Input,
            args: ['p-icon']
        }], type: [{
            type: Input,
            args: ['p-search-type']
        }], literals: [{
            type: Input,
            args: ['p-literals']
        }], filterType: [{
            type: Input,
            args: ['p-filter-type']
        }], showListbox: [{
            type: Input,
            args: [{ alias: 'p-show-listbox', transform: convertToBoolean }]
        }], filterSelect: [{
            type: Input,
            args: ['p-filter-select']
        }], changeModel: [{
            type: Output,
            args: ['p-change-model']
        }], filteredItemsChange: [{
            type: Output,
            args: ['p-filtered-items-change']
        }], filter: [{
            type: Output,
            args: ['p-filter']
        }], listboxOnClick: [{
            type: Output,
            args: ['p-listbox-onclick']
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tc2VhcmNoLWJhc2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdWkvc3JjL2xpYi9jb21wb25lbnRzL3BvLXNlYXJjaC9wby1zZWFyY2gtYmFzZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGlEQUFpRCxDQUFDO0FBRWxGLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQWUsTUFBTSxlQUFlLENBQUM7QUFDcEYsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFcEQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDaEYsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sbUNBQW1DLENBQUM7OztBQUt2RTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQTBERztBQUVILE1BQU0sT0FBTyxxQkFBcUI7SUFDeEIsU0FBUyxDQUFvQjtJQUM3QixVQUFVLENBQVU7SUFDcEIsUUFBUSxDQUFTO0lBQ2pCLGFBQWEsQ0FBK0I7SUFFcEQ7Ozs7Ozs7O09BUUc7SUFDMEQsUUFBUSxDQUFXO0lBRWhGOzs7Ozs7T0FNRztJQUNlLEtBQUssR0FBZSxFQUFFLENBQUM7SUFFekM7Ozs7Ozs7O09BUUc7SUFDSCxJQUEyQixTQUFTLENBQUMsS0FBYTtRQUNoRCxJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztRQUV4QixJQUFJLEtBQUssS0FBSyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRTtZQUNsQyxJQUFJLENBQUMsVUFBVSxHQUFHLEdBQUcsSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDO1NBQ2hFO0lBQ0gs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InNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBvTGFuZ3VhZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvcG8tbGFuZ3VhZ2UvcG8tbGFuZ3VhZ2Uuc2VydmljZSc7XG5pbXBvcnQgeyBwb0xvY2FsZURlZmF1bHQgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9wby1sYW5ndWFnZS9wby1sYW5ndWFnZS5jb25zdGFudCc7XG5cbmltcG9ydCB7IERpcmVjdGl2ZSwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT3V0cHV0LCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgY29udmVydFRvQm9vbGVhbiB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWwnO1xuaW1wb3J0IHsgUG9TZWFyY2hMaXRlcmFscyB9IGZyb20gJy4vbGl0ZXJhbHMvcG8tc2VhcmNoLWxpdGVyYWxzJztcbmltcG9ydCB7IHBvU2VhcmNoTGl0ZXJhbHNEZWZhdWx0IH0gZnJvbSAnLi9saXRlcmFscy9wby1zZWFyY2gtbGl0ZXJhbHMtZGVmYXVsdCc7XG5pbXBvcnQgeyBQb1NlYXJjaEZpbHRlck1vZGUgfSBmcm9tICcuL2VudW0vcG8tc2VhcmNoLWZpbHRlci1tb2RlLmVudW0nO1xuaW1wb3J0IHsgUG9TZWFyY2hPcHRpb24gfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tc2VhcmNoLW9wdGlvbi5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUG9TZWFyY2hGaWx0ZXJTZWxlY3QgfSBmcm9tICcuL2ludGVyZmFjZXMvcG8tc2VhcmNoLWZpbHRlci1zZWxlY3QuaW50ZXJmYWNlJztcblxuZXhwb3J0IHR5cGUgc2VhcmNoTW9kZSA9ICdhY3Rpb24nIHwgJ3RyaWdnZXInO1xuLyoqXG4gKiBAZGVzY3JpcHRpb25cbiAqXG4gKiBPIGNvbXBvbmVudGUgc2VhcmNoLCB0YW1iw6ltIGNvbmhlY2lkbyBjb21vIGJhcnJhIGRlIHBlc3F1aXNhLCDDqSB1dGlsaXphZG8gcGFyYSBhanVkYXIgb3MgdXN1w6FyaW9zIGEgbG9jYWxpemFyIHVtIGRldGVybWluYWRvIGNvbnRlw7pkb1xuICpcbiAqIE5vcm1hbG1lbnRlIGxvY2FsaXphZG8gbm8gY2FudG8gc3VwZXJpb3IgZGlyZWl0bywganVudG8gY29tIG8gw61jb25lIGRlIGx1cGEsIHVtYSB2ZXogcXVlIGVzdGUgw61jb25lIMOpIGFtcGxhbWVudGUgcmVjb25oZWNpZG8uXG4gKlxuICogUG9ydGFudG8sIMOpIGRlIGV4dHJlbWEgaW1wb3J0w6JuY2lhIHF1ZSwgYW8gdXRpbGl6YXIgZXN0ZSBjb21wb25lbnRlLCBhcyBwZXNzb2FzIHJlc3BvbnPDoXZlaXMgcG9yIHNldSBkZXNlbnZvbHZpbWVudG8gY29uc2lkZXJlbSBvcyBzZWd1aW50ZXMgY3JpdMOpcmlvcy5cbiAqXG4gKiAjIyMjIEJvYXMgcHLDoXRpY2FzXG4gKlxuICogRm9yYW0gZXN0cnV0dXJhZG9zIG9zIHBhZHLDtWVzIGRlIHVzYWJpbGlkYWRlIHBhcmEgYXV4aWxpYXIgbmEgdXRpbGl6YcOnw6NvIGRvIGNvbXBvbmVudGUgZSBnYXJhbnRpciB1bWEgYm9hIGV4cGVyacOqbmNpYSBhb3MgdXN1w6FyaW9zLiBQb3IgaXNzbywgw6kgbXVpdG8gaW1wb3J0YW50ZSBxdWUgYW8gdXRpbGl6YXIgZXN0ZSBjb21wb25lbnRlLCBhcyBwZXNzb2FzIHF1ZSBvIHByb2pldGFyZW0gZGV2ZW0gbGV2YXIgZW0gY29uc2lkZXJhw6fDo28gb3Mgc2VndWludGVzIGNyaXTDqXJpb3M6XG4gKiAtIFV0aWxpemUgbGFiZWxzIHBhcmEgYXByZXNlbnRhciByZXN1bHRhZG9zIHF1ZSBlc3TDo28gc2VuZG8gZXhpYmlkb3MgZSBhcHJlc2VudGUgb3MgcmVzdWx0YWRvcyBtYWlzIHJlbGV2YW50ZXMgcHJpbWVpcm8uXG4gKiAtIEV4aWJhIHVtYSBtZW5zYWdlbSBjbGFyYSBxdWFuZG8gbsOjbyBmb3JlbSBlbmNvbnRyYWRvcyByZXN1bHRhZG9zIHBhcmEgYnVzY2EgZSBzZW1wcmUgcXVlIHBvc3PDrXZlbCBvZmVyZcOnYSBvdXRyYXMgc3VnZXN0w7VlcyBkZSBidXNjYS5cbiAqIC0gTWFudGVuaGEgbyB0ZXh0byBvcmlnaW5hbCBubyBjYW1wbyBkZSBpbnB1dCwgcXVlIGZhY2lsaXRhIGEgYcOnw6NvIGRvIHVzdcOhcmlvIGNhc28gcXVlaXJhIGZhemVyIHVtYSBub3ZhIGJ1c2NhIGNvbSBhbGd1bWEgbW9kaWZpY2HDp8OjbyBuYSBwZXNxdWlzYS5cbiAqIC0gQ2FzbyBzZWphIHBvc3PDrXZlbCBkZXRlY3RhciB1bSBlcnJvIGRlIGRpZ2l0YcOnw6NvLCBtb3N0cmUgb3MgcmVzdWx0YWRvcyBwYXJhIGEgcGFsYXZyYSBcImNvcnJpZ2lkYVwiLCBpc3NvIGV2aXRhIGEgZnJ1c3RyYcOnw6NvIGRlIG7Do28gb2J0ZXIgcmVzdWx0YWRvcyBlIG7Do28gZm9yw6dhIG8gdXN1w6FyaW8gYSByZWFsaXphciB1bWEgbm92YSBidXNjYS5cbiAqIC0gUXVhbmRvIGFwcm9wcmlhZG8sIGRlc3RhcXVlIG9zIHRlcm1vcyBkYSBidXNjYSBub3MgcmVzdWx0YWRvcy5cbiAqIC0gQSBlbnRyYWRhIGRvIGNhbXBvIGRlIHBlc3F1aXNhIGRldmUgY2FiZXIgZW0gdW1hIGxpbmhhLiBOw6NvIHVzZSBlbnRyYWRhcyBkZSBwZXNxdWlzYSBkZSB2w6FyaWFzIGxpbmhhcy5cbiAqIC0gUmVjb21lbmRhLXNlIHRlciBhcGVuYXMgdW1hIHBlc3F1aXNhIHBvciBww6FnaW5hLiBTZSB2b2PDqiBwcmVjaXNhciBkZSB2w6FyaWFzIHBlc3F1aXNhcywgcm90dWxlLWFzIGNsYXJhbWVudGUgcGFyYSBpbmRpY2FyIHN1YSBmaW5hbGlkYWRlLlxuICogLSBTZSBwb3Nzw612ZWwsIGZvcm5lw6dhIHN1Z2VzdMO1ZXMgZGUgcGVzcXVpc2EsIHNlamEgZW0gdW0gaGVscHRleHQgb3Ugc3VnZXN0w6NvIGRlIHBlc3F1aXNhIHF1ZSDDqSB1bSBhdXRvY29tcGxldGUuIElzc28gYWp1ZGEgb3MgdXN1w6FyaW9zIGEgZW5jb250cmFyIG8gcXVlIGVzdMOjbyBwcm9jdXJhbmRvLCBlc3BlY2lhbG1lbnRlIHNlIG9zIGl0ZW5zIHBlc3F1aXPDoXZlaXMgZm9yZW0gY29tcGxleG9zLlxuICpcbiAqICMjIyMgQWNlc3NpYmlsaWRhZGUgdHJhdGFkYSBubyBjb21wb25lbnRlXG4gKlxuICogIEFsZ3VtYXMgZGlyZXRyaXplcyBkZSBhY2Vzc2liaWxpZGFkZSBqw6Egc8OjbyB0cmF0YWRhcyBubyBjb21wb25lbnRlLCBpbnRlcm5hbWVudGUsIGUgbsOjbyBwb2RlbSBzZXIgYWx0ZXJhZGFzIHBlbG8gcHJvcHJpZXTDoXJpbyBkbyBjb250ZcO6ZG8uIFPDo28gZWxhczpcbiAqXG4gKiAtIFBlcm1pdGlyIGEgaW50ZXJhw6fDo28gdmlhIHRlY2xhZG8gKDIuMS4xOiBLZXlib2FyZCAoQSkpO1xuICogLSBBbHRlcmHDp8OjbyBlbnRyZSBvcyBlc3RhZG9zIHByZWNpc2Egc2VyIGluZGljYWRhIHBvciBtYWlzIGRlIHVtIGVsZW1lbnRvIGFsw6ltIGRhIGNvciAoMS40LjE6IFVzZSBvZiBDb2xvcik7XG4gKlxuICogIyMjIyBUb2tlbnMgY3VzdG9taXrDoXZlaXNcbiAqXG4gKiDDiSBwb3Nzw612ZWwgYWx0ZXJhciBvIGVzdGlsbyBkbyBjb21wb25lbnRlIHVzYW5kbyBvcyBzZWd1aW50ZXMgdG9rZW5zIChDU1MpOlxuICpcbiAqID4gUGFyYSBtYWlvcmVzIGluZm9ybWHDp8O1ZXMsIGFjZXNzZSBvIGd1aWEgW1BlcnNvbmFsaXphbmRvIG8gVGVtYSBQYWRyw6NvIGNvbSBUb2tlbnMgQ1NTXShodHRwczovL3BvLXVpLmlvL2d1aWRlcy90aGVtZS1jdXN0b21pemF0aW9uKS5cbiAqXG4gKiB8IFByb3ByaWVkYWRlICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IERlc2NyacOnw6NvICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFZhbG9yIFBhZHLDo28gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxuICogfCAqKkRlZmF1bHQgVmFsdWVzKiogICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IGAtLWZvbnQtZmFtaWx5YCAgICAgICAgICAgICAgICAgICAgICAgIHwgRmFtw61saWEgdGlwb2dyw6FmaWNhIHVzYWRhICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGB2YXIoLS1mb250LWZhbWlseS10aGVtZSlgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCBgLS1mb250LXNpemVgICAgICAgICAgICAgICAgICAgICAgICAgICB8IFRhbWFuaG8gZGEgZm9udGUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYHZhcigtLWZvbnQtc2l6ZS1kZWZhdWx0KWAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IGAtLXRleHQtY29sb3ItcGxhY2Vob2xkZXJgICAgICAgICAgICAgIHwgQ29yIGRvIHRleHRvIG5vIHBsYWNlaG9sZGVyICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgdmFyKC0tY29sb3ItbmV1dHJhbC1saWdodC0zMClgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgYC0tY29sb3JgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBDb3IgcHJpbmNpcGFsIGRvIHNlYXJjaCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGB2YXIoLS1jb2xvci1uZXV0cmFsLWRhcmstNzApYCAgICAgICAgICAgICAgICAgICAgfFxuICogfCBgLS1ib3JkZXItcmFkaXVzYCAgICAgICAgICAgICAgICAgICAgICB8IENvbnTDqW0gbyB2YWxvciBkbyByYWlvIGRvcyBjYW50b3MgZG8gZWxlbWVudG8mbmJzcDsgICB8IGB2YXIoLS1ib3JkZXItcmFkaXVzLW1kKWAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCBgLS1iYWNrZ3JvdW5kYCAgICAgICAgICAgICAgICAgICAgICAgICB8IENvciBkZSBiYWNrZ3JvdW5kICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYHZhcigtLWNvbG9yLW5ldXRyYWwtbGlnaHQtMDUpYCAgICAgICAgICAgICAgICAgICB8XG4gKiB8IGAtLXRleHQtY29sb3JgICAgICAgICAgICAgICAgICAgICAgICAgIHwgQ29yIGRvIHRleHRvICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgdmFyKC0tY29sb3ItbmV1dHJhbC1kYXJrLTkwKWAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgYC0tY29sb3ItY2xlYXJgICAgICAgICAgICAgICAgICAgICAgICAgfCBDb3IgcHJpbmNpcGFsIGRvIGljb25lIGNsb3NlICAgICAgICAgICAgICAgICAgICAgICAgICB8IGB2YXIoLS1jb2xvci1hY3Rpb24tZGVmYXVsdClgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCAqKkljb24qKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IGAtLWNvbG9yLWljb24tcmVhZGAgICAgICAgICAgICAgICAgICAgIHwgQ29yIHByaW5jaXBhbCBkbyBpY29uZSBkZSBsZWl0dXJhICAgICAgICAgICAgICAgICAgICAgfCBgdmFyKC0tY29sb3ItbmV1dHJhbC1kYXJrLTcwKWAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgYC0tY29sb3ItaWNvbmAgICAgICAgICAgICAgICAgICAgICAgICAgfCBDb3IgcHJpbmNpcGFsIGRvIGljb25lICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGB2YXIoLS1jb2xvci1hY3Rpb24tZGVmYXVsdClgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCAqKkhvdmVyKiogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IGAtLWNvbG9yLWhvdmVyYCAgICAgICAgICAgICAgICAgICAgICAgIHwgQ29yIHByaW5jaXBhbCBubyBlc3RhZG8gaG92ZXIgICAgICAgICAgICAgICAgICAgICAgICAgfCBgdmFyKC0tY29sb3ItYWN0aW9uLWhvdmVyKWAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgYC0tYmFja2dyb3VuZC1ob3ZlcmAgICAgICAgICAgICAgICAgICAgfCBDb3IgZGUgYmFja2dyb3VuZCBubyBlc3RhZG8gaG92ZXIgICAgICAgICAgICAgICAgICAgICB8IGB2YXIoLS1jb2xvci1icmFuZC0wMS1saWdodGVzdClgICAgICAgICAgICAgICAgICAgfFxuICogfCAqKkZvY3VzZWQqKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IGAtLWNvbG9yLWZvY3VzZWRgICAgICAgICAgICAgICAgICAgICAgIHwgQ29yIHByaW5jaXBhbCBubyBlc3RhZG8gZGUgZm9jdXMgICAgICAgICAgICAgICAgICAgICAgfCBgdmFyKC0tY29sb3ItYWN0aW9uLWRlZmF1bHQpYCAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgYC0tb3V0bGluZS1jb2xvci1mb2N1c2VkYCAgICAgICAgICAgICAgfCBDb3IgZG8gb3V0bGluZSBkbyBlc3RhZG8gZGUgZm9jdXMgICAgICAgICAgICAgICAgICAgICB8IGB2YXIoLS1jb2xvci1hY3Rpb24tZm9jdXMpYCAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCAqKkRpc2FibGVkKiogICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IGAtLWNvbG9yLWRpc2FibGVkYCAgICAgICAgICAgICAgICAgICAgIHwgQ29yIHByaW5jaXBhbCBubyBlc3RhZG8gZGlzYWJsZWQgICAgICAgICAgICAgICAgICAgICAgfCBgdmFyKC0tY29sb3ItYWN0aW9uLWRpc2FibGVkKWAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgYC0tYmFja2dyb3VuZC1jb2xvci1kaXNhYmxlZGAgICAgICAgICAgfCBDb3IgZGUgYmFja2dyb3VuZCBubyBlc3RhZG8gZGlzYWJsZWQgICAgICAgICAgICAgICAgICB8IGB2YXIoLS1jb2xvci1uZXV0cmFsLWxpZ2h0LTIwKWAgICAgICAgICAgICAgICAgICAgfFxuICpcbiAqL1xuQERpcmVjdGl2ZSgpXG5leHBvcnQgY2xhc3MgUG9TZWFyY2hCYXNlQ29tcG9uZW50IHtcbiAgcHJpdmF0ZSBfbGl0ZXJhbHM/OiBQb1NlYXJjaExpdGVyYWxzO1xuICBwcml2YXRlIF9hcmlhTGFiZWw/OiBzdHJpbmc7XG4gIHByaXZhdGUgbGFuZ3VhZ2U6IHN0cmluZztcbiAgcHJpdmF0ZSBfZmlsdGVyU2VsZWN0PzogQXJyYXk8UG9TZWFyY2hGaWx0ZXJTZWxlY3Q+O1xuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIERlc2FiaWxpdGEgbyBwby1zZWFyY2ggZSBuw6NvIHBlcm1pdGUgcXVlIG8gdXN1w6FyaW8gaW50ZXJhamEgY29tIG8gbWVzbW8uXG4gICAqXG4gICAqIEBkZWZhdWx0IGBmYWxzZWBcbiAgICovXG4gIEBJbnB1dCh7IGFsaWFzOiAncC1kaXNhYmxlZCcsIHRyYW5zZm9ybTogY29udmVydFRvQm9vbGVhbiB9KSBkaXNhYmxlZD86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogTGlzdGEgZGUgaXRlbnMgcXVlIHNlcsOjbyB1dGlsaXphZG9zIHBhcmEgcGVzcXVpc2FcbiAgICovXG4gIEBJbnB1dCgncC1pdGVtcycpIGl0ZW1zOiBBcnJheTxhbnk+ID0gW107XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRGVmaW5lIHVtIGFyaWEtbGFiZWwgcGFyYSBvIHBvLXNlYXJjaC5cbiAgICpcbiAgICogPiBEZXZpZG8gbyBjb21wb25lbnRlIG7Do28gcG9zc3VpciB1bWEgbGFiZWwgYXNzaW0gY29tbyBvdXRyb3MgY2FtcG9zIGRlIHRleHRvLCBvIGBhcmlhLWxhYmVsYCDDqSB1dGlsaXphZG8gcGFyYSBhY2Vzc2liaWxpZGFkZS5cbiAgICovXG4gIEBJbnB1dCgncC1hcmlhLWxhYmVsJykgc2V0IGFyaWFMYWJlbCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fYXJpYUxhYmVsID0gdmFsdWU7XG5cbiAgICBpZiAodmFsdWUgIT09IHRoaXMubGl0ZXJhbHMuc2VhcmNoKSB7XG4gICAgICB0aGlzLl9hcmlhTGFiZWwgPSBgJHt0aGlzLl9hcmlhTGFiZWx9ICR7dGhpcy5saXRlcmFscy5zZWFyY2h9YDtcbiAgICB9XG4gIH1cblxuICBnZXQgYXJpYUxhYmVsKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2FyaWFMYWJlbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRGV2ZSBzZXIgaW5mb3JtYWRvIG8gbm9tZSBkYSBwcm9wcmllZGFkZSBkbyBvYmpldG8gcXVlIHNlcsOhIHV0aWxpemFkbyBwYXJhIGEgY29udmVyc8OjbyBkb3MgaXRlbnMgYXByZXNlbnRhZG9zIG5hIGxpc3RhIGRvIGNvbXBvbmVudGUgKHAtaXRlbXMpLCBlc3RhIHByb3ByaWVkYWRlIHNlcsOhIHJlc3BvbnPDoXZlbCBwZWxvIHRleHRvIGRlIGFwcmVzZW50YcOnw6NvIGRlIGNhZGEgaXRlbSBkYSBsaXN0YS5cbiAgICovXG4gIEBJbnB1dCgncC1maWx0ZXIta2V5cycpIGZpbHRlcktleXM6IEFycmF5PGFueT4gPSBbXTtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBEZXZlIHNlciBpbmZvcm1hZG8gbyBub21lIGRhIHByb3ByaWVkYWRlIGRvIG9iamV0byBxdWUgc2Vyw6EgdXRpbGl6YWRvIHBhcmEgYSBjb252ZXJzw6NvIGRvcyBpdGVucyBhcHJlc2VudGFkb3MgbmEgbGlzdGEgZG8gY29tcG9uZW50ZSAocC1pdGVtcyksIGVzdGEgcHJvcHJpZWRhZGUgc2Vyw6EgcmVzcG9uc8OhdmVsIHBlbG8gdGV4dG8gZGUgYXByZXNlbnRhw6fDo28gZGUgY2FkYSBpdGVtIGRhIGxpc3RhLlxuICAgKi9cbiAgQElucHV0KCdwLWljb24nKSBpY29uOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjx2b2lkPjtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBEZXRlcm1pbmEgYSBmb3JtYSBkZSByZWFsaXphciBhIHBlc3F1aXNhIG5vIGNvbXBvbmVudGVcbiAgICpcbiAgICogVmFsb3JlcyBhY2VpdG9zOlxuICAgKiAtIGBhY3Rpb25gOiBSZWFsaXphIGEgYnVzY2EgYSBjYWRhIGNhcmFjdGVyZSBkaWdpdGFkby5cbiAgICogLSBgdHJpZ2dlcmA6IFJlYWxpemEgYSBidXNjYSBhbyBwcmVzc2lvbmFyIGBlbnRlcmAgb3UgY2xpY2FyIG5vIMOtY29uZSBkZSBidXNjYS5cbiAgICpcbiAgICogQGRlZmF1bHQgYGFjdGlvbmBcbiAgICovXG4gIEBJbnB1dCgncC1zZWFyY2gtdHlwZScpIHR5cGU6IHNlYXJjaE1vZGUgPSAnYWN0aW9uJztcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBPYmpldG8gY29tIGFzIGxpdGVyYWlzIHVzYWRhcyBubyBgcG8tc2VhcmNoYC5cbiAgICpcbiAgICogUGFyYSB1dGlsaXphciBiYXN0YSBwYXNzYXIgYSBsaXRlcmFsIHF1ZSBkZXNlamEgY3VzdG9taXphcjpcbiAgICpcbiAgICogYGBgXG4gICAqICBjb25zdCBjdXN0b21MaXRlcmFsczogUG9TZWFyY2hMaXRlcmFscyA9IHtcbiAgICogICAgc2VhcmNoOiAnUGVzcXVpc2FyJyxcbiAgICogICAgY2xlYW46ICdMaW1wYXInLFxuICAgKiAgfTtcbiAgICogYGBgXG4gICAqXG4gICAqIEUgcGFyYSBjYXJyZWdhciBhIGxpdGVyYWwgY3VzdG9taXphZGEsIGJhc3RhIGFwZW5hcyBwYXNzYXIgbyBvYmpldG8gcGFyYSBvIGNvbXBvbmVudGUuXG4gICAqXG4gICAqIGBgYFxuICAgKiA8cG8tc2VhcmNoXG4gICAqICAgW3AtbGl0ZXJhbHNdPVwiY3VzdG9tTGl0ZXJhbHNcIj5cbiAgICogPC9wby1zZWFyY2g+XG4gICAqIGBgYFxuICAgKlxuICAgKiA+IE8gb2JqZXRvIHBhZHLDo28gZGUgbGl0ZXJhaXMgc2Vyw6EgdHJhZHV6aWRvIGRlIGFjb3JkbyBjb20gbyBpZGlvbWEgZG9cbiAgICogW2BQb0kxOG5TZXJ2aWNlYF0oL2RvY3VtZW50YXRpb24vcG8taTE4bikgb3UgZG8gYnJvd3Nlci5cbiAgICovXG4gIEBJbnB1dCgncC1saXRlcmFscycpIHNldCBsaXRlcmFscyh2YWx1ZTogUG9TZWFyY2hMaXRlcmFscykge1xuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCAmJiAhKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICB0aGlzLl9saXRlcmFscyA9IHtcbiAgICAgICAgLi4ucG9TZWFyY2hMaXRlcmFsc0RlZmF1bHRbcG9Mb2NhbGVEZWZhdWx0XSxcbiAgICAgICAgLi4ucG9TZWFyY2hMaXRlcmFsc0RlZmF1bHRbdGhpcy5sYW5ndWFnZV0sXG4gICAgICAgIC4uLnZhbHVlXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saXRlcmFscyA9IHBvU2VhcmNoTGl0ZXJhbHNEZWZhdWx0W3RoaXMubGFuZ3VhZ2VdO1xuICAgIH1cbiAgfVxuXG4gIGdldCBsaXRlcmFscygpIHtcbiAgICByZXR1cm4gdGhpcy5fbGl0ZXJhbHMgfHwgcG9TZWFyY2hMaXRlcmFsc0RlZmF1bHRbdGhpcy5sYW5ndWFnZV07XG4gIH1cblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBEZWZpbmUgbyBtb2RvIGRlIHBlc3F1aXNhIHV0aWxpemFkbyBubyBjYW1wbyBkZSBidXNjYSwgcXVhbmRvIGhhYmlsaXRhZG8uIFZhbG9yZXMgZGVmaW5pZG9zIG5vIGVudW06IFBvU2VhcmNoRmlsdGVyTW9kZVxuICAgKlxuICAgKiBAZGVmYXVsdCBgc3RhcnRzV2l0aGBcbiAgICovXG4gIEBJbnB1dCgncC1maWx0ZXItdHlwZScpIGZpbHRlclR5cGU6IFBvU2VhcmNoRmlsdGVyTW9kZSA9IFBvU2VhcmNoRmlsdGVyTW9kZS5zdGFydHNXaXRoO1xuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIEV4aWJlIHVtYSBsaXN0YSAoYXV0by1jb21wbGV0ZSkgY29tIGFzIG9ww6fDtWVzIGRlZmluaWRhcyBubyBgcC1maWx0ZXIta2V5c2AgZW5xdWFudG8gcmVhbGl6YSB1bWEgYnVzY2EsXG4gICAqIHJlc3BlaXRhbmRvIG8gYHAtZmlsdGVyLXR5cGVgIGNvbW8gbW9kbyBkZSBwZXNxdWlzYS5cbiAgICpcbiAgICogQGRlZmF1bHQgYGZhbHNlYFxuICAgKi9cbiAgQElucHV0KHsgYWxpYXM6ICdwLXNob3ctbGlzdGJveCcsIHRyYW5zZm9ybTogY29udmVydFRvQm9vbGVhbiB9KSBzaG93TGlzdGJveD86IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIERlZmluZSBvcyB0aXBvcyBkZSBmaWx0cm9zIChwLWZpbHRlci1rZXlzKSBhIHNlcmVtIGFwbGljYWRvcyBuYSBidXNjYSBvdSBsaXN0YSBkbyBjb21wb25lbnRlIChwLWl0ZW1zKS5cbiAgICogQXV0b21hdGljYW1lbnRlIGFkaWNpb25hIGEgb3DDp8OjbyAnVG9kb3MnLCBjb20gdW0gbWFwZWFtZW50byBkZSB0b2RhcyBhcyBvcMOnw7VlcyBwYXNzYWRhcy5cbiAgICpcbiAgICogPiBPIHVzbyBkZXN0YSBwcm9wcmllZGFkZSB0b3JuYSBhIHByb3ByaWVkYWRlICdwLWZpbHRlci1rZXlzJyBpbnbDoWxpZGEuXG4gICAqXG4gICAqIEV4ZW1wbG8gZGUgdXNvOlxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IGZpbHRlclNlbGVjdCA9IFtcbiAgICogICB7IGxhYmVsOiAncGVyc29uYWwnLCB2YWx1ZTogWyduYW1lJywgJ2VtYWlsJywgJ25pY2tuYW1lJ10gfSxcbiAgICogICB7IGxhYmVsOiAnYWRkcmVzcycsIHZhbHVlOiBbJ2NvdW50cnknLCAnc3RhdGUnLCAnY2l0eScsICdzdHJlZXQnXSB9LFxuICAgKiAgIHsgbGFiZWw6ICdmYW1pbHknLCB2YWx1ZTogWydmYXRoZXInLCAnbW90aGVyJywgJ2RlcGVuZGVudHMnXSB9XG4gICAqIF07XG4gICAqIGBgYFxuICAgKi9cbiAgQElucHV0KCdwLWZpbHRlci1zZWxlY3QnKSBzZXQgZmlsdGVyU2VsZWN0KHZhbHVlczogQXJyYXk8UG9TZWFyY2hGaWx0ZXJTZWxlY3Q+KSB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlcykgfHwgdmFsdWVzLmxlbmd0aCA9PT0gMCB8fCB2YWx1ZXMuZXZlcnkodmFsdWUgPT4gT2JqZWN0LmtleXModmFsdWUpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgIHRoaXMuX2ZpbHRlclNlbGVjdCA9IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgX3ZhbHVlczogQXJyYXk8UG9TZWFyY2hGaWx0ZXJTZWxlY3Q+ID0gdGhpcy5lbnN1cmVGaWx0ZXJTZWxlY3RPcHRpb24odmFsdWVzKTtcblxuICAgIGNvbnN0IGFsbFZhbHVlcyA9IF92YWx1ZXMuZmxhdE1hcChlID0+IGUudmFsdWUpO1xuICAgIGNvbnN0IHVuaXF1ZVZhbHVlcyA9IFsuLi5uZXcgU2V0KGFsbFZhbHVlcyldO1xuXG4gICAgY29uc3QgZmlsdGVyT3B0aW9uQWxsOiBQb1NlYXJjaEZpbHRlclNlbGVjdCA9IHtcbiAgICAgIGxhYmVsOiB0aGlzLmxpdGVyYWxzLmFsbCxcbiAgICAgIHZhbHVlOiB1bmlxdWVWYWx1ZXNcbiAgICB9O1xuXG4gICAgdGhpcy5fZmlsdGVyU2VsZWN0ID0gW2ZpbHRlck9wdGlvbkFsbCwgLi4uX3ZhbHVlc107XG4gIH1cblxuICBnZXQgZmlsdGVyU2VsZWN0KCkge1xuICAgIHJldHVybiB0aGlzLl9maWx0ZXJTZWxlY3Q7XG4gIH1cblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBFdmVudG8gZGlzcGFyYWRvIGFvIGFsdGVyYXIgdmFsb3IgZG8gbW9kZWwuXG4gICAqL1xuICBAT3V0cHV0KCdwLWNoYW5nZS1tb2RlbCcpIGNoYW5nZU1vZGVsOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBQb2RlIHNlciBpbmZvcm1hZGEgdW1hIGZ1bsOnw6NvIHF1ZSBzZXLDoSBkaXNwYXJhZGEgcXVhbmRvIGhvdXZlciBhbHRlcmHDp8O1ZXMgbm8gaW5wdXQuXG4gICAqL1xuICBAT3V0cHV0KCdwLWZpbHRlcmVkLWl0ZW1zLWNoYW5nZScpIGZpbHRlcmVkSXRlbXNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPEFycmF5PGFueT4+KCk7XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogUG9kZSBzZXIgaW5mb3JtYWRhIHVtYSBmdW7Dp8OjbyBxdWUgc2Vyw6EgZGlzcGFyYWRhIHF1YW5kbyBob3V2ZXIgYWx0ZXJhw6fDtWVzIG5vcyBmaWx0cm9zLlxuICAgKi9cbiAgQE91dHB1dCgncC1maWx0ZXInKSBmaWx0ZXI6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogUG9kZSBzZXIgaW5mb3JtYWRhIHVtYSBmdW7Dp8OjbyBxdWUgc2Vyw6EgZGlzcGFyYWRhIHF1YW5kbyBob3V2ZXIgY2xpY2sgbm8gbGlzdGJveC5cbiAgICovXG4gIEBPdXRwdXQoJ3AtbGlzdGJveC1vbmNsaWNrJykgbGlzdGJveE9uQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBjb25zdHJ1Y3RvcihsYW5ndWFnZVNlcnZpY2U6IFBvTGFuZ3VhZ2VTZXJ2aWNlKSB7XG4gICAgdGhpcy5sYW5ndWFnZSA9IGxhbmd1YWdlU2VydmljZS5nZXRTaG9ydExhbmd1YWdlKCk7XG4gIH1cblxuICBlbnN1cmVGaWx0ZXJTZWxlY3RPcHRpb24odmFsdWVzOiBhbnkpIHtcbiAgICBjb25zdCBfdmFsdWVzID0gQXJyYXkuaXNBcnJheSh2YWx1ZXMpID8gdmFsdWVzIDogQXJyYXkub2YodmFsdWVzKTtcbiAgICByZXR1cm4gX3ZhbHVlcy5tYXAodmFsdWUgPT4gKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgPyB2YWx1ZSA6IHsgbGFiZWw6IHZhbHVlLCB2YWx1ZSB9KSk7XG4gIH1cbn1cbiJdfQ==